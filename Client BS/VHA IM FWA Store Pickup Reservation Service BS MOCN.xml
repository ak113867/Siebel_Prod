<?xml version="1.0" encoding="UTF-8"?><?Siebel-Property-Set EscapeNames="true"?><Business_spcService
 Comments="SBABU created for moconsq"
 State_spcManagement_spcType="Stateful"
 Cache="N"
 Server_spcEnabled="N"
 Display_spcName="VHA Store Pickup Reservation Service_Test"
 Inactive="N"
 Hidden="N"
 Class="CSSService"
 Name="VHA IM FWA Store Pickup Reservation Service BS MOCN"
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Display_spcName="CoverageCheck"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="CoverageCheck"
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Display_spcName="GetAddressId"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="GetAddressId"
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Display_spcName="GetDigitalRequestShop"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="GetDigitalRequestShop"
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Display_spcName="InsertAddr"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="InsertAddr"
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Display_spcName="NewPSMA"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="NewPSMA"
></Business_spcService_spcMethod
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function DebugLog(strTransactionName, Inputs, Outputs)_newline{_newline try{_newline //VHA Kamali:25/05/2022 - updated for Ring and Collect  _newline  var psInputs;_newline  var psOutputs;_newline  var sService;_newline  var strInboundXML;_newline  var strOutboundXML;_newline_newline  strInboundXML = convertPropSetToXMLString(Inputs);_newline  strInboundXML = ToString(strInboundXML);_newline  strInboundXML = strInboundXML.substring(28,strInboundXML.lastIndexOf(&quot;&gt;&quot;)+1);_newline  _newline  strOutboundXML = convertPropSetToXMLString(Outputs);_newline  strOutboundXML = ToString(strOutboundXML);_newline  strOutboundXML = strOutboundXML.substring(28,strOutboundXML.lastIndexOf(&quot;&gt;&quot;)+1);_newline_newline  sService = TheApplication().GetService(&quot;VF Error Handling Service&quot;);_newline  psInputs = TheApplication().NewPropertySet();_newline  psOutputs = TheApplication().NewPropertySet();  _newline  _newline  psInputs.SetProperty(&quot;SourceName&quot;, strTransactionName);_newline  psInputs.SetProperty(&quot;FunctionName&quot;, strTransactionName);_newline  psInputs.SetProperty(&quot;Inbound XML&quot;, strInboundXML);_newline  psInputs.SetProperty(&quot;Outbound XML&quot;, strOutboundXML);_newline  sService.InvokeMethod(&quot;DebugLog&quot;, psInputs, psOutputs);  _newline }_newline catch(e){_newline  if (defined(e.errText)) {_newline   var strError = e.errText + &quot;\r\n&quot; + e.toString(); _newline  }_newline  else {_newline   var strError = e.toString(); _newline  }_newline  throw (strError); _newline }_newline finally {_newline  strInboundXML = null;_newline  strOutboundXML = null;_newline  psInputs = null;_newline  psOutputs = null;_newline  sService = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="DebugLog"
 Sequence="2"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function Service_usPreInvokeMethod (MethodName, Inputs, Outputs)_newline{_newline if(MethodName == &quot;GetReservationfromOrder&quot;)_newline {_newline  mGetReservationfromOrder(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;GetDigitalRequestShop&quot;)_newline {_newline mGetDigitalRequestShop(Inputs, Outputs) _newline}_newline if(MethodName == &quot;GetReservationStoreCodefromOrder&quot;)_newline {_newline  mGetReservationStoreCodefromOrder(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;GetReservationStatusfromOrder&quot;)_newline {_newline  mGetReservationStatusfromOrder(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;ManageReservation&quot;)_newline {_newline  mManageReservation(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;GetCorrelationId&quot;)_newline {_newline  mGetCorrelationId(Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;ValidateReservation&quot;)_newline {_newline  mValidateReservation(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;CoverageCheck&quot;)_newline {_newline  mCoverageCheck(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;InsertAddr&quot;)_newline {_newline  mInsertAddr(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;GetAddressId&quot;)_newline {_newline  mGetAddressId(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline if(MethodName == &quot;NewPSMA&quot;)_newline {_newline  mNewPSMA(Inputs,Outputs);_newline  return (CancelOperation);_newline }_newline return (ContinueOperation);_newline}"
 Program_spcLanguage="JS"
 Name="Service_usPreInvokeMethod"
 Sequence="10"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function convertPropSetToXMLString(propertySet) {_newline    try {_newline  var psToXMLDOC = TheApplication().NewPropertySet();_newline  var psXMLDOCToStringInput = TheApplication().NewPropertySet();_newline  var psXMLDOCToStringOutput = TheApplication().NewPropertySet();_newline       _newline  //Convert PropertySet to XMLDOC_newline  var sService = TheApplication().GetService(&quot;XML Converter&quot;);_newline  sService.InvokeMethod(&quot;PropSetToXML&quot;, propertySet,psToXMLDOC);_newline  sService = null;_newline  _newline  //Convert XMLDOC to XMLString_newline  psXMLDOCToStringInput.SetProperty(&quot;ConversionMode&quot;, &quot;EncodingToString&quot;);_newline  psXMLDOCToStringInput.SetProperty(&quot;SourceEncoding&quot;, &quot;UTF-8&quot;);_newline  psXMLDOCToStringInput.SetValue(psToXMLDOC);_newline  sService = TheApplication().GetService(&quot;Transcode Service&quot;);_newline  sService.InvokeMethod(&quot;Convert&quot;, psXMLDOCToStringInput,psXMLDOCToStringOutput);_newline  sService = null;_newline  _newline    } catch (e) {_newline        throw (e);_newline    } finally {_newline  psToXMLDOC = null;_newline  psXMLDOCToStringInput = null; _newline  sService = null;_newline    }_newline return psXMLDOCToStringOutput;_newline}"
 Program_spcLanguage="JS"
 Name="convertPropSetToXMLString"
 Sequence="1"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCoverageCheck(Inputs, Outputs) _newline{_newline_newline try_newline {_newline var source = Inputs.GetProperty(&quot;source&quot;);_newline var source_usvalue = Inputs.GetProperty(&quot;source_usvalue&quot;);_newline var customer = Inputs.GetProperty(&quot;customer&quot;);_newline var category = Inputs.GetProperty(&quot;category&quot;);_newline var role = Inputs.GetProperty(&quot;role&quot;);_newline var longitude = Inputs.GetProperty(&quot;longitude&quot;);_newline var latitude = Inputs.GetProperty(&quot;latitude&quot;);_newline var gnafid = Inputs.GetProperty(&quot;GNAFId&quot;);_newline var fwasqid = &quot;&quot;, fwaNetwork = &quot;&quot;;_newline var fwaSqId4G = TheApplication().GetProfileAttr(&quot;fwaSqId4G&quot;);_newline var fwaSqId5G = TheApplication().GetProfileAttr(&quot;fwaSqId5G&quot;);_newline var MCONADDRLOV = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usMCONADDR_usSWITCH&quot;,&quot;MCON_usADD_usSWITCH&quot;);   _newline    var MCONSWITCHTOFWA = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usMCON_usSWITCHTOFWAAPI&quot;,&quot;VHA_usMCON_usSWITCHTOFWA&quot;); _newline var j = &quot;&quot;,k = &quot;&quot;;_newline if (fwaSqId5G != &quot;&quot; &amp;&amp; fwaSqId5G != null)_newline {_newline  fwasqid = fwaSqId5G;_newline  fwaNetwork = &quot;5G&quot;;_newline }_newline else if (fwaSqId4G != &quot;&quot; &amp;&amp; fwaSqId4G != null)_newline {_newline  fwasqid = fwaSqId4G;_newline  fwaNetwork = &quot;4G&quot;;_newline }_newline else _newline {_newline                fwasqid = &quot;&quot;;_newline  fwaNetwork = &quot;&quot;;_newline          }_newline //var fwasqid = Inputs.GetProperty(&quot;fwasqid&quot;);_newline //var fwaNetwork = Inputs.GetProperty(&quot;fwaNetwork&quot;);_newline var SessionId = Inputs.GetProperty(&quot;SessionId&quot;);_newline var AddrId = Inputs.GetProperty(&quot;AddrId&quot;);_newline var sResId,sResStatus,sReservStat,sAccId,sDebug=&quot;N&quot;,sTrace=&quot;N&quot;,sHour=&quot;00&quot;,sErrorMsg=&quot;&quot;;_newline var sourcevalue = latitude+&quot;,&quot;+longitude;_newline TheApplication().SetProfileAttr(&quot;URL1&quot;,&quot;&quot;);_newline var psInputs = TheApplication().NewPropertySet();_newline var psOutputs = TheApplication().NewPropertySet();_newline var psOut = TheApplication().NewPropertySet();_newline var child = TheApplication().NewPropertySet();_newline var child1 = TheApplication().NewPropertySet();_newline var queryParams = TheApplication().NewPropertySet();_newline var psRequestBody = TheApplication().NewPropertySet();_newline var headerParams = TheApplication().NewPropertySet();_newline var jsOut = TheApplication().NewPropertySet();_newline var jsOutChild = TheApplication().NewPropertySet();_newline_newline var sBS = TheApplication().GetService(&quot;VHA Get Session Token Service&quot;);_newline if(MCONSWITCHTOFWA ==&quot;Y&quot;)_newline  sBS.InvokeMethod(&quot;GetSessionToken&quot;,psInputs,psOutputs);_newline else _newline psInputs.SetProperty(&quot;Transaction Name&quot;,&quot;VFRESTDigitalRequest&quot;);_newline psInputs.SetProperty(&quot;Transaction Name&quot;,&quot;VFRESTDigitalRequest&quot;);_newline sBS.InvokeMethod(&quot;GetConfigList&quot;,psInputs,psOut);_newline sDebug = psOut.GetProperty(&quot;Flag 01&quot;);_newline sTrace = psOut.GetProperty(&quot;Flag 02&quot;);_newline //mGetCorrelationId(Outputs); _newline headerParams.SetProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);_newline headerParams.SetProperty(&quot;apikey&quot;,psOut.GetProperty(&quot;String 16&quot;));_newline headerParams.SetType(&quot;HeaderParams&quot;); _newline psInputs.Reset();_newline psInputs.AddChild(headerParams);_newline sBS = TheApplication().GetService(&quot;VHA Siebel Rest API Adapter&quot;);_newline var sSalesChannel = TheApplication().GetProfileAttr(&quot;VHA User Type&quot;);_newline if (sSalesChannel  == &quot;Retail&quot;)_newline  sSalesChannel  = &quot;retail&quot;;_newline if (sSalesChannel  == &quot;Care&quot;)_newline  sSalesChannel  = &quot;care&quot;;_newline if (sSalesChannel  == &quot;&quot;)_newline  sSalesChannel  = &quot;care&quot;;_newline_newline if(MCONSWITCHTOFWA ==&quot;N&quot;)_newline {_newline  queryParams.SetProperty(&quot;source&quot;, &quot;geo&quot;);_newline  queryParams.SetProperty(&quot;source_usvalue&quot;, sourcevalue );_newline  queryParams.SetProperty(&quot;customer&quot;, sSalesChannel );_newline  queryParams.SetProperty(&quot;category&quot;, &quot;wireless&quot;);_newline  queryParams.SetProperty(&quot;bestsite&quot;, &quot;wireless&quot;);_newline }  _newline else_newline {_newline  queryParams.SetType(&quot;QueryParams&quot;);   _newline  queryParams.SetProperty(&quot;customer&quot;, &quot;digital&quot;);_newline  queryParams.SetProperty(&quot;fwaSqId&quot;, fwasqid );_newline // queryParams.SetProperty(&quot;tech&quot;, fwaNetwork);_newline  queryParams.SetProperty(&quot;tech&quot;, &quot;both&quot;);_newline }_newline psInputs.AddChild(queryParams); _newline psInputs.SetProperty(&quot;ClientIdentifier&quot;, psOut.GetProperty(&quot;String 6&quot;));_newline psInputs.SetProperty(&quot;ClientId&quot;, psOut.GetProperty(&quot;String 7&quot;));_newline //psInputs.SetProperty(&quot;Host&quot;, &quot;https://api.test.tpgt-apigee.aws.vodafone.com.au&quot;);_newline psInputs.SetProperty(&quot;Host&quot;, psOut.GetProperty(&quot;String 17&quot;));_newline psInputs.SetProperty(&quot;ClientSecret&quot;, psOut.GetProperty(&quot;String 16&quot;));_newline //psInputs.SetProperty(&quot;ResourcePath&quot;, &quot;/mapt/v1/api/prequal/basic?&quot;); _newline psInputs.SetProperty(&quot;ResourcePath&quot;, psOut.GetProperty(&quot;String 18&quot;));   _newline sBS.InvokeMethod(&quot;Get&quot;, psInputs, psOutputs);_newline var sCode = psOutputs.GetProperty(&quot;HTTP_usSTATUS_usCODE&quot;);_newline var sqtimestamp  = psOutputs.GetChild(1).GetProperty(&quot;sqTimestamp&quot;);_newline TheApplication().SetProfileAttr(&quot;sqTimestamp&quot;,sqtimestamp);_newline //var sErrorMsg  = psOutputs.GetProperty(&quot;message&quot;);_newline psOutputs.SetProperty(&quot;sCode&quot;,sCode);_newline psOutputs.SetProperty(&quot;sMsg&quot;,sErrorMsg);_newline Outputs.AddChild(psOutputs);_newline if (sCode != &quot;200&quot;)_newline {_newline if (sCode == &quot;204&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, &apos;please contact IT support quoting the following error: &apos;Coverage Check error code 204:  Coverage not found for given geo codes.&apos;&quot;;_newline if (sCode == &quot;400&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again.If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 400: Bad request.&apos;&quot;;_newline if (sCode == &quot;401&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, &apos;please contact IT support quoting the following error: Coverage Check error code 401: Authentication information is missing or invalid&apos;&quot;;_newline if (sCode == &quot;403&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, &apos;please contact IT support quoting the following error: &apos;Coverage Check error code 403: Forbidden.&apos;&quot;;_newline if (sCode == &quot;404&quot;)_newline  sErrorMsg = &quot;The requested address could not be found; a coverage check couldn&apos;t be processed. Please correct the address and try again. If the address is &apos;Valid&apos; in Siebel, please contact IT support quoting the address and the following error : &apos;Coverage Check error code 404: Address not found&apos;&quot;;_newline if (sCode == &quot;405&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 405: Validation exception&apos;&quot;;_newline if (sCode == &quot;500&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 500: Internal server error&apos;&quot;;_newline if (sCode == &quot;502&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 502: internal server error&apos;&quot;;_newline if (sCode == &quot;503&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 503: Service unavailable&apos;&quot;;_newline if (sCode == &quot;504&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 504: Gateway timeout&apos;&quot;;_newline else_newline  sErrorMsg == &quot;Authentication information is missing or invalid&quot;;_newline }_newline if (sErrorMsg != &quot;&quot; &amp;&amp; sErrorMsg != null)_newline  TheApplication().RaiseErrorText(sErrorMsg);_newline_newline var URL1 = psOutputs.GetChild(1).GetProperty(&quot;uiUrl&quot;);_newline TheApplication().SetProfileAttr(&quot;URL_usService&quot;,URL1);     _newline var bo = TheApplication().GetBusObject(&quot;VF Coverage Check&quot;);_newline var bc = bo.GetBusComp(&quot;VF Coverage Check Band&quot;);_newline var bc1 = bo.GetBusComp(&quot;VF Coverage Check&quot;);_newline bc1.ClearToQuery();_newline bc1.NewRecord(NewAfter); _newline bc1.SetFieldValue(&quot;Longitude&quot;, longitude);_newline bc1.SetFieldValue(&quot;Latitude&quot;,latitude);_newline bc1.SetFieldValue(&quot;NBN Address Id&quot;,AddrId);_newline bc1.SetFieldValue(&quot;Asset Id&quot;,SessionId);_newline bc1.SetFieldValue(&quot;State&quot;,sCode);_newline bc1.SetFieldValue(&quot;Coverage Checked&quot;,&quot;Y&quot;);_newline bc1.SetFieldValue(&quot;Map URL&quot;,URL1);_newline jsOut.SetProperty(&quot;CovChkId&quot;,bc1.GetFieldValue(&quot;Id&quot;));_newline TheApplication().SetProfileAttr(&quot;CoverageChkId&quot;,bc1.GetFieldValue(&quot;Id&quot;));_newline jsOut.SetProperty(&quot;SessionId&quot;, SessionId);  _newline bc1.WriteRecord();   _newline_newline  if(sCode == &quot;200&quot;)_newline  { _newline if(MCONSWITCHTOFWA == &quot;N&quot;)_newline {_newline  j = 5;_newline  k = 8;_newline }_newline else _newline {_newline  j = 0;_newline  k = 2;_newline }_newline for (var i=j ; i&lt;k ; i++)//   for (var i=5 ; i&lt;8 ; i++)_newline   {_newline   var sSKUChild = psOutputs.GetChild(1).GetChild(i).GetType();  _newline   //throw(sSKUChild); _newline   var strPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetFirstProperty();_newline   var strPropValue = &quot;&quot;;_newline   if(sSKUChild == &quot;fwaStatus&quot;)_newline   {_newline    while (strPropName != &quot;&quot;)_newline    {_newline     var jsOutChild = TheApplication().NewPropertySet();_newline     strPropValue = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetProperty(strPropName);_newline     sSKUChild = psOutputs.GetChild(1).GetChild(i).GetType();        _newline     var sCId = bc.ParentBusComp().GetFieldValue(&quot;Id&quot;);_newline     TheApplication().SetProfileAttr(&quot;pCoverageId&quot;,sCId);    _newline     bc.ClearToQuery();_newline     bc.NewRecord(NewAfter);_newline     bc.SetFieldValue(&quot;Coverage Id&quot;, sCId);_newline     bc.SetFieldValue(&quot;Coverage Type&quot;, strPropName);_newline     bc.SetFieldValue(&quot;Planned Note&quot;,strPropValue); _newline     bc.SetFieldValue(&quot;Site&quot;,sSKUChild);_newline     bc.SetFieldValue(&quot;Cell Id&quot;,AddrId); _newline     if (sSKUChild == &quot;fwaStatus&quot; &amp;&amp; (strPropName == &quot;is3G&quot; || strPropName == &quot;is4G&quot; ||  strPropName == &quot;is4Gsa&quot; || strPropName == &quot;is4Gnsa&quot; ||  strPropName == &quot;is5G&quot; || strPropName == &quot;is5Gsa&quot; || strPropName == &quot;is5Gnsa&quot;))_newline     {     _newline      jsOutChild.SetProperty(&quot;PropValue&quot;, strPropValue);_newline      jsOutChild.SetProperty(&quot;PropName&quot;, strPropName);_newline      if (sSKUChild == &quot;fwaStatus&quot;)_newline       sSKUChild = &quot;4G/5G Home Internet&quot;;_newline      if (sSKUChild == &quot;mobileStatus&quot;)_newline       sSKUChild = &quot;Mobile Coverage&quot;;     _newline      jsOutChild.SetProperty(&quot;Site&quot;,sSKUChild);_newline      jsOut.AddChild(jsOutChild); _newline     }_newline  _newline     else if (sSKUChild == &quot;uiUrl1&quot;)_newline     {_newline      jsOutChild.SetProperty(&quot;PropValue&quot;, strPropValue);_newline      jsOutChild.SetProperty(&quot;PropName&quot;, strPropName);     _newline      jsOutChild.SetProperty(&quot;Site&quot;,sSKUChild);_newline      jsOut.AddChild(jsOutChild);               _newline     }     _newline     strPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetNextProperty();_newline     //j++;        _newline    }_newline   }_newline   if(sSKUChild == &quot;fwaBestSite&quot;)_newline   { _newlineTheApplication().SetProfileAttr(&quot;Test1&quot;,psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChildCount() );_newline    for (var j=0 ; j&lt;psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChildCount() ; j++)_newline    {_newline     var sFWAChild = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetType();_newline     var FWAPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetChild(0).GetFirstProperty();_newlineTheApplication().SetProfileAttr(&quot;Test2&quot;,FWAPropName );_newline     var FWAPropValue = &quot;&quot;;_newline     while (FWAPropName != &quot;&quot;)_newline     {_newline     var jsOutChild = TheApplication().NewPropertySet();_newline     FWAPropValue = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetChild(0).GetProperty(FWAPropName);_newline     sFWAChild = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetType();        _newline     var sCId = bc.ParentBusComp().GetFieldValue(&quot;Id&quot;);_newline     TheApplication().SetProfileAttr(&quot;pCoverageId&quot;,sCId);    _newline   bc.ActivateField(&quot;Coverage Id&quot;);_newline  bc.ActivateField(&quot;Coverage Type&quot;);_newline  bc.ActivateField(&quot;Planned Note&quot;);_newline  bc.ActivateField(&quot;Site&quot;);_newline  bc.ActivateField(&quot;Cell Id&quot;);_newline_newline     bc.ClearToQuery();_newline     bc.NewRecord(NewAfter);_newline     bc.SetFieldValue(&quot;Coverage Id&quot;, sCId);_newline     bc.SetFieldValue(&quot;Coverage Type&quot;, FWAPropName);_newline     bc.SetFieldValue(&quot;Planned Note&quot;,FWAPropValue); _newline     bc.SetFieldValue(&quot;Site&quot;,sFWAChild);_newline     bc.SetFieldValue(&quot;Cell Id&quot;,AddrId);_newline    bc.WriteRecord();_newline     FWAPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetChild(0).GetNextProperty();_newline     }_newline    }_newline    bc.SetFieldValue(&quot;Coverage Id&quot;, sCId);_newline    bc.SetFieldValue(&quot;Coverage Type&quot;, &quot;sqtimestamp&quot;);_newline    bc.SetFieldValue(&quot;Planned Note&quot;,sqtimestamp); _newline    bc.SetFieldValue(&quot;Site&quot;,sFWAChild);_newline    bc.SetFieldValue(&quot;Cell Id&quot;,AddrId);_newline   }_newline   }  _newline   bc.WriteRecord();_newline  }_newline  Outputs.AddChild(jsOut);_newline  Outputs.SetProperty(&quot;CId&quot;,sCId);_newline  if(sDebug==&quot;Y&quot; || sTrace ==&quot;Y&quot; )_newline  {_newline  DebugLog(&quot;VFRESTDigitalRequest&quot;, psInputs, psOutputs);_newline  } _newline }_newline catch(e)_newline {_newline  mHandleException(e,&quot;VFRESTDigitalRequest&quot;,psInputs,psOutputs);_newline  throw(e);_newline }_newline finally_newline {_newline psInputs=null;_newline psOutputs=null;_newline child=null;_newline child1=null;_newline queryParams=null;_newline psRequestBody=null;_newline headerParams=null;_newline sBS=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mCoverageCheck"
 Sequence="3"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetAddressId(Inputs,Outputs)_newline{_newline var sPriAddrId, sDPID;_newline var sCustId = Inputs.GetProperty(&quot;CustId&quot;);_newline TheApplication().SetProfileAttr(&quot;DPID&quot;,&quot;&quot;);_newline //var sCustId = &quot;2-1PRA01I6&quot;;_newline var sBC = TheApplication().GetBusObject(&quot;Account&quot;).GetBusComp(&quot;Account&quot;);_newline var sBCAddr = TheApplication().GetBusObject(&quot;Account&quot;).GetBusComp(&quot;CUT Address&quot;);_newline with (sBC){_newline SetViewMode(AllView);_newline ActivateField(&quot;Primary Address Id&quot;); _newline ClearToQuery();_newline SetSearchSpec(&quot;Id&quot;,sCustId);_newline ExecuteQuery();  _newline if(FirstRecord())_newline {_newline  sPriAddrId = GetFieldValue(&quot;Primary Address Id&quot;);   _newline  with(sBCAddr)_newline  {_newline  SetViewMode(AllView);  _newline  ActivateField(&quot;DPID&quot;);_newline  ClearToQuery();_newline  SetSearchSpec(&quot;Id&quot;,sPriAddrId);_newline  ExecuteQuery();    _newline  if(FirstRecord())_newline  {_newline   sDPID = GetFieldValue(&quot;DPID&quot;);_newline   Outputs.SetProperty(&quot;AddrItemId&quot;, sDPID);_newline//Address row_usid, lat,long_newline_newline   TheApplication().SetProfileAttr(&quot;DPID&quot;,sDPID);    _newline  }_newlineelse_newline{_newline   Outputs.SetProperty(&quot;AddrItemId&quot;, &quot;&quot;);_newline}_newline  }_newline }_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mGetAddressId"
 Sequence="4"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//Your public declarations go here...  _newlinefunction mGetCorrelationId(Outputs)_newline{_newlinetry{_newline var psInputs = TheApplication().NewPropertySet();_newline var dDate = new Date();_newline var sFullYear = ToString(dDate.getFullYear());_newline var sMonth = ToString(dDate.getMonth() + 1);_newline var sDay = ToString(dDate.getDate()); _newline var sHours = ToString(dDate.getHours()); _newline var sMinutes = ToString(dDate.getMinutes()); _newline var sSeconds = ToString(dDate.getSeconds()); _newline if(sMonth.length == 1)_newline  sMonth = &quot;0&quot; + sMonth;_newline if(sDay.length == 1)_newline  sDay = &quot;0&quot; + sDay;_newline if(sHours.length == 1)_newline  sHours = &quot;0&quot; + sHours;_newline if(sMinutes.length == 1)_newline  sMinutes = &quot;0&quot; + sMinutes;_newline if(sSeconds.length == 1)_newline  sSeconds = &quot;0&quot; + sSeconds;_newline _newline var sBS = TheApplication().GetService(&quot;VF Date Time Utilities&quot;);_newline psInputs.SetProperty(&quot;CurrDateTime&quot;,sMonth+&quot;/&quot;+sDay+&quot;/&quot;+sFullYear+&quot; &quot;+sHours+&quot;:&quot;+sMinutes+&quot;:&quot;+sSeconds);_newline sBS.InvokeMethod(&quot;GenerateCorrelationId&quot;, psInputs, Outputs);_newline}_newlinecatch(e){_newline}_newlinefinally{_newlinepsInputs=null;_newlinesBS =null;_newline}_newline}_newline"
 Program_spcLanguage="JS"
 Name="mGetCorrelationId"
 Sequence="5"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetDigitalRequestShop(Inputs, Outputs) _newline{_newline_newline try_newline {_newline var source = Inputs.GetProperty(&quot;source&quot;);_newline var source_usvalue = Inputs.GetProperty(&quot;source_usvalue&quot;);_newline var customer = Inputs.GetProperty(&quot;customer&quot;);_newline var category = Inputs.GetProperty(&quot;category&quot;);_newline var role = Inputs.GetProperty(&quot;role&quot;);_newline var longitude = Inputs.GetProperty(&quot;longitude&quot;);_newline var latitude = Inputs.GetProperty(&quot;latitude&quot;);_newline var gnafid = Inputs.GetProperty(&quot;GNAFId&quot;);_newline var fwasqid = &quot;&quot;, fwaNetwork = &quot;&quot;;_newline var fwaSqId4G = TheApplication().GetProfileAttr(&quot;fwaSqId4G&quot;);_newline var fwaSqId5G = TheApplication().GetProfileAttr(&quot;fwaSqId5G&quot;);_newline var MCONADDRLOV = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usMCONADDR_usSWITCH&quot;,&quot;MCON_usADD_usSWITCH&quot;);   _newline    var MCONSWITCHTOFWA = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usMCON_usSWITCHTOFWAAPI&quot;,&quot;VHA_usMCON_usSWITCHTOFWA&quot;); _newline var j = &quot;&quot;,k = &quot;&quot;;_newline if (fwaSqId5G != &quot;&quot; &amp;&amp; fwaSqId5G != null)_newline {_newline  fwasqid = fwaSqId5G;_newline  fwaNetwork = &quot;5G&quot;;_newline }_newline else if (fwaSqId4G != &quot;&quot; &amp;&amp; fwaSqId4G != null)_newline {_newline  fwasqid = fwaSqId4G;_newline  fwaNetwork = &quot;4G&quot;;_newline }_newline else _newline {_newline                fwasqid = &quot;&quot;;_newline  fwaNetwork = &quot;&quot;;_newline          }_newline //var fwasqid = Inputs.GetProperty(&quot;fwasqid&quot;);_newline //var fwaNetwork = Inputs.GetProperty(&quot;fwaNetwork&quot;);_newline var SessionId = Inputs.GetProperty(&quot;SessionId&quot;);_newline var AddrId = Inputs.GetProperty(&quot;AddrId&quot;);_newline var sResId,sResStatus,sReservStat,sAccId,sDebug=&quot;N&quot;,sTrace=&quot;N&quot;,sHour=&quot;00&quot;,sErrorMsg=&quot;&quot;;_newline var sourcevalue = latitude+&quot;,&quot;+longitude;_newline TheApplication().SetProfileAttr(&quot;URL1&quot;,&quot;&quot;);_newline var psInputs = TheApplication().NewPropertySet();_newline var psOutputs = TheApplication().NewPropertySet();_newline var psOut = TheApplication().NewPropertySet();_newline var child = TheApplication().NewPropertySet();_newline var child1 = TheApplication().NewPropertySet();_newline var queryParams = TheApplication().NewPropertySet();_newline var psRequestBody = TheApplication().NewPropertySet();_newline var headerParams = TheApplication().NewPropertySet();_newline var jsOut = TheApplication().NewPropertySet();_newline var jsOutChild = TheApplication().NewPropertySet();_newline_newline var sBS = TheApplication().GetService(&quot;VHA Get Session Token Service&quot;);_newline if(MCONSWITCHTOFWA ==&quot;Y&quot;)_newline  sBS.InvokeMethod(&quot;GetSessionToken&quot;,psInputs,psOutputs);_newline else _newline psInputs.SetProperty(&quot;Transaction Name&quot;,&quot;VFRESTDigitalRequest&quot;);_newline psInputs.SetProperty(&quot;Transaction Name&quot;,&quot;VFRESTDigitalRequest&quot;);_newline sBS.InvokeMethod(&quot;GetConfigList&quot;,psInputs,psOut);_newline sDebug = psOut.GetProperty(&quot;Flag 01&quot;);_newline sTrace = psOut.GetProperty(&quot;Flag 02&quot;);_newline //mGetCorrelationId(Outputs); _newline headerParams.SetProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);_newline headerParams.SetProperty(&quot;apikey&quot;,psOut.GetProperty(&quot;String 16&quot;));_newline headerParams.SetType(&quot;HeaderParams&quot;); _newline psInputs.Reset();_newline psInputs.AddChild(headerParams);_newline sBS = TheApplication().GetService(&quot;VHA Siebel Rest API Adapter&quot;);_newline var sSalesChannel = TheApplication().GetProfileAttr(&quot;VHA User Type&quot;);_newline if (sSalesChannel  == &quot;Retail&quot;)_newline  sSalesChannel  = &quot;retail&quot;;_newline if (sSalesChannel  == &quot;Care&quot;)_newline  sSalesChannel  = &quot;care&quot;;_newline if (sSalesChannel  == &quot;&quot;)_newline  sSalesChannel  = &quot;care&quot;;_newline_newline if(MCONSWITCHTOFWA ==&quot;N&quot;)_newline {_newline  queryParams.SetProperty(&quot;source&quot;, &quot;geo&quot;);_newline  queryParams.SetProperty(&quot;source_usvalue&quot;, sourcevalue );_newline  queryParams.SetProperty(&quot;customer&quot;, sSalesChannel );_newline  queryParams.SetProperty(&quot;category&quot;, &quot;wireless&quot;);_newline  queryParams.SetProperty(&quot;bestsite&quot;, &quot;wireless&quot;);_newline }  _newline else_newline {_newline  queryParams.SetType(&quot;QueryParams&quot;);   _newline  queryParams.SetProperty(&quot;customer&quot;, &quot;digital&quot;);_newline  queryParams.SetProperty(&quot;fwaSqId&quot;, fwasqid );_newline // queryParams.SetProperty(&quot;tech&quot;, fwaNetwork);_newline  queryParams.SetProperty(&quot;tech&quot;, &quot;both&quot;);_newline }_newline psInputs.AddChild(queryParams); _newline psInputs.SetProperty(&quot;ClientIdentifier&quot;, psOut.GetProperty(&quot;String 6&quot;));_newline psInputs.SetProperty(&quot;ClientId&quot;, psOut.GetProperty(&quot;String 7&quot;));_newline //psInputs.SetProperty(&quot;Host&quot;, &quot;https://api.test.tpgt-apigee.aws.vodafone.com.au&quot;);_newline psInputs.SetProperty(&quot;Host&quot;, psOut.GetProperty(&quot;String 17&quot;));_newline psInputs.SetProperty(&quot;ClientSecret&quot;, psOut.GetProperty(&quot;String 16&quot;));_newline //psInputs.SetProperty(&quot;ResourcePath&quot;, &quot;/mapt/v1/api/prequal/basic?&quot;); _newline psInputs.SetProperty(&quot;ResourcePath&quot;, psOut.GetProperty(&quot;String 18&quot;));   _newline sBS.InvokeMethod(&quot;Get&quot;, psInputs, psOutputs);_newline var sCode = psOutputs.GetProperty(&quot;HTTP_usSTATUS_usCODE&quot;);_newline var sqtimestamp  = psOutputs.GetChild(1).GetProperty(&quot;sqTimestamp&quot;);_newline TheApplication().SetProfileAttr(&quot;sqTimestamp&quot;,sqtimestamp);_newline //var sErrorMsg  = psOutputs.GetProperty(&quot;message&quot;);_newline psOutputs.SetProperty(&quot;sCode&quot;,sCode);_newline psOutputs.SetProperty(&quot;sMsg&quot;,sErrorMsg);_newline Outputs.AddChild(psOutputs);_newline if (sCode != &quot;200&quot;)_newline {_newline if (sCode == &quot;204&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, &apos;please contact IT support quoting the following error: &apos;Coverage Check error code 204:  Coverage not found for given geo codes.&apos;&quot;;_newline if (sCode == &quot;400&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again.If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 400: Bad request.&apos;&quot;;_newline if (sCode == &quot;401&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, &apos;please contact IT support quoting the following error: Coverage Check error code 401: Authentication information is missing or invalid&apos;&quot;;_newline if (sCode == &quot;403&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, &apos;please contact IT support quoting the following error: &apos;Coverage Check error code 403: Forbidden.&apos;&quot;;_newline if (sCode == &quot;404&quot;)_newline  sErrorMsg = &quot;The requested address could not be found; a coverage check couldn&apos;t be processed. Please correct the address and try again. If the address is &apos;Valid&apos; in Siebel, please contact IT support quoting the address and the following error : &apos;Coverage Check error code 404: Address not found&apos;&quot;;_newline if (sCode == &quot;405&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 405: Validation exception&apos;&quot;;_newline if (sCode == &quot;500&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 500: Internal server error&apos;&quot;;_newline if (sCode == &quot;502&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 502: internal server error&apos;&quot;;_newline if (sCode == &quot;503&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 503: Service unavailable&apos;&quot;;_newline if (sCode == &quot;504&quot;)_newline  sErrorMsg = &quot;The coverage check has encountered an error. Please try again. If the problem persists, please contact IT support quoting the following error: &apos;Coverage Check error code 504: Gateway timeout&apos;&quot;;_newline else_newline  sErrorMsg == &quot;Authentication information is missing or invalid&quot;;_newline }_newline if (sErrorMsg != &quot;&quot; &amp;&amp; sErrorMsg != null)_newline  TheApplication().RaiseErrorText(sErrorMsg);_newline_newline var URL1 = psOutputs.GetChild(1).GetProperty(&quot;uiUrl&quot;);_newline TheApplication().SetProfileAttr(&quot;URL_usService&quot;,URL1);     _newline var bo = TheApplication().GetBusObject(&quot;VF Coverage Check&quot;);_newline var bc = bo.GetBusComp(&quot;VF Coverage Check Band&quot;);_newline var bc1 = bo.GetBusComp(&quot;VF Coverage Check&quot;);_newline bc1.ClearToQuery();_newline bc1.NewRecord(NewAfter); _newline bc1.SetFieldValue(&quot;Longitude&quot;, longitude);_newline bc1.SetFieldValue(&quot;Latitude&quot;,latitude);_newline bc1.SetFieldValue(&quot;NBN Address Id&quot;,AddrId);_newline bc1.SetFieldValue(&quot;Asset Id&quot;,SessionId);_newline bc1.SetFieldValue(&quot;State&quot;,sCode);_newline bc1.SetFieldValue(&quot;Coverage Checked&quot;,&quot;Y&quot;);_newline bc1.SetFieldValue(&quot;Map URL&quot;,URL1);_newline jsOut.SetProperty(&quot;CovChkId&quot;,bc1.GetFieldValue(&quot;Id&quot;));_newline TheApplication().SetProfileAttr(&quot;CoverageChkId&quot;,bc1.GetFieldValue(&quot;Id&quot;));_newline jsOut.SetProperty(&quot;SessionId&quot;, SessionId);  _newline bc1.WriteRecord();   _newline_newline  if(sCode == &quot;200&quot;)_newline  { _newline if(MCONSWITCHTOFWA == &quot;N&quot;)_newline {_newline  j = 5;_newline  k = 8;_newline }_newline else _newline {_newline  j = 0;_newline  k = 2;_newline }_newline for (var i=j ; i&lt;k ; i++)//   for (var i=5 ; i&lt;8 ; i++)_newline   {_newline   var sSKUChild = psOutputs.GetChild(1).GetChild(i).GetType();  _newline   //throw(sSKUChild); _newline   var strPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetFirstProperty();_newline   var strPropValue = &quot;&quot;;_newline   if(sSKUChild == &quot;fwaStatus&quot;)_newline   {_newline    while (strPropName != &quot;&quot;)_newline    {_newline     var jsOutChild = TheApplication().NewPropertySet();_newline     strPropValue = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetProperty(strPropName);_newline     sSKUChild = psOutputs.GetChild(1).GetChild(i).GetType();        _newline     var sCId = bc.ParentBusComp().GetFieldValue(&quot;Id&quot;);_newline     TheApplication().SetProfileAttr(&quot;pCoverageId&quot;,sCId);    _newline     bc.ClearToQuery();_newline     bc.NewRecord(NewAfter);_newline     bc.SetFieldValue(&quot;Coverage Id&quot;, sCId);_newline     bc.SetFieldValue(&quot;Coverage Type&quot;, strPropName);_newline     bc.SetFieldValue(&quot;Planned Note&quot;,strPropValue); _newline     bc.SetFieldValue(&quot;Site&quot;,sSKUChild);_newline     bc.SetFieldValue(&quot;Cell Id&quot;,AddrId); _newline     if (sSKUChild == &quot;fwaStatus&quot; &amp;&amp; (strPropName == &quot;is3G&quot; || strPropName == &quot;is4G&quot; ||  strPropName == &quot;is4Gsa&quot; || strPropName == &quot;is4Gnsa&quot; ||  strPropName == &quot;is5G&quot; || strPropName == &quot;is5Gsa&quot; || strPropName == &quot;is5Gnsa&quot;))_newline     {     _newline      jsOutChild.SetProperty(&quot;PropValue&quot;, strPropValue);_newline      jsOutChild.SetProperty(&quot;PropName&quot;, strPropName);_newline      if (sSKUChild == &quot;fwaStatus&quot;)_newline       sSKUChild = &quot;4G/5G Home Internet&quot;;_newline      if (sSKUChild == &quot;mobileStatus&quot;)_newline       sSKUChild = &quot;Mobile Coverage&quot;;     _newline      jsOutChild.SetProperty(&quot;Site&quot;,sSKUChild);_newline      jsOut.AddChild(jsOutChild); _newline     }_newline  _newline     else if (sSKUChild == &quot;uiUrl1&quot;)_newline     {_newline      jsOutChild.SetProperty(&quot;PropValue&quot;, strPropValue);_newline      jsOutChild.SetProperty(&quot;PropName&quot;, strPropName);     _newline      jsOutChild.SetProperty(&quot;Site&quot;,sSKUChild);_newline      jsOut.AddChild(jsOutChild);               _newline     }     _newline     strPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetNextProperty();_newline     //j++;        _newline    }_newline   }_newline   if(sSKUChild == &quot;fwaBestSite&quot;)_newline   { _newlineTheApplication().SetProfileAttr(&quot;Test1&quot;,psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChildCount() );_newline    for (var j=0 ; j&lt;psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChildCount() ; j++)_newline    {_newline     var sFWAChild = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetType();_newline     var FWAPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetChild(0).GetFirstProperty();_newlineTheApplication().SetProfileAttr(&quot;Test2&quot;,FWAPropName );_newline     var FWAPropValue = &quot;&quot;;_newline     while (FWAPropName != &quot;&quot;)_newline     {_newline     var jsOutChild = TheApplication().NewPropertySet();_newline     FWAPropValue = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetChild(0).GetProperty(FWAPropName);_newline     sFWAChild = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetType();        _newline     var sCId = bc.ParentBusComp().GetFieldValue(&quot;Id&quot;);_newline     TheApplication().SetProfileAttr(&quot;pCoverageId&quot;,sCId);    _newline   bc.ActivateField(&quot;Coverage Id&quot;);_newline  bc.ActivateField(&quot;Coverage Type&quot;);_newline  bc.ActivateField(&quot;Planned Note&quot;);_newline  bc.ActivateField(&quot;Site&quot;);_newline  bc.ActivateField(&quot;Cell Id&quot;);_newline_newline     bc.ClearToQuery();_newline     bc.NewRecord(NewAfter);_newline     bc.SetFieldValue(&quot;Coverage Id&quot;, sCId);_newline     bc.SetFieldValue(&quot;Coverage Type&quot;, FWAPropName);_newline     bc.SetFieldValue(&quot;Planned Note&quot;,FWAPropValue); _newline     bc.SetFieldValue(&quot;Site&quot;,sFWAChild);_newline     bc.SetFieldValue(&quot;Cell Id&quot;,AddrId);_newline    bc.WriteRecord();_newline     FWAPropName = psOutputs.GetChild(1).GetChild(i).GetChild(0).GetChild(j).GetChild(0).GetNextProperty();_newline     }_newline    }_newline    bc.SetFieldValue(&quot;Coverage Id&quot;, sCId);_newline    bc.SetFieldValue(&quot;Coverage Type&quot;, &quot;sqtimestamp&quot;);_newline    bc.SetFieldValue(&quot;Planned Note&quot;,sqtimestamp); _newline    bc.SetFieldValue(&quot;Site&quot;,sFWAChild);_newline    bc.SetFieldValue(&quot;Cell Id&quot;,AddrId);_newline   }_newline   }  _newline   bc.WriteRecord();_newline  }_newline  Outputs.AddChild(jsOut);_newline  Outputs.SetProperty(&quot;CId&quot;,sCId);_newline  if(sDebug==&quot;Y&quot; || sTrace ==&quot;Y&quot; )_newline  {_newline  DebugLog(&quot;VFRESTDigitalRequest&quot;, psInputs, psOutputs);_newline  } _newline }_newline catch(e)_newline {_newline  mHandleException(e,&quot;VFRESTDigitalRequest&quot;,psInputs,psOutputs);_newline  throw(e);_newline }_newline finally_newline {_newline psInputs=null;_newline psOutputs=null;_newline child=null;_newline child1=null;_newline queryParams=null;_newline psRequestBody=null;_newline headerParams=null;_newline sBS=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mGetDigitalRequestShop"
 Sequence="6"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mHandleException(strInternalError, strTransactionName, Inputs, Outputs)_newline{ _newline try {_newline //VHA Kamali:25/05/2022 - updated for Ring and Collect_newline  var psInputs;_newline  var psOutputs;_newline  var bsLogError;_newline  var strError;_newline  var strInboundXML;_newline  var strOutboundXML;_newline  _newline  var sStatus = &quot;&quot;;_newline  var sCode = &quot;&quot;;_newline  var sTitle = &quot;&quot;;_newline _newline  //Convert Inbound Property Set to Inbound XML String_newline  strInboundXML = convertPropSetToXMLString(Inputs);_newline  strInboundXML = ToString(strInboundXML);_newline  strInboundXML = strInboundXML.substring(28,strInboundXML.lastIndexOf(&quot;&gt;&quot;)+1);_newline  _newline  strError = ToString(strInternalError);_newline  if(strError.substring(0,16) == &quot;SiebelValidation&quot;){_newline   strError = strError.substring(18);_newline   sStatus = &quot;400&quot;;_newline   sCode = &quot;1058&quot;;_newline   sTitle = &quot;Validation Error&quot;;_newline  }else {_newline   sStatus = &quot;500&quot;;_newline   sCode = &quot;99999&quot;;_newline   sTitle = &quot;Exception&quot;;_newline  }_newline   _newline  //Convert Outbound Property Set to Outbound XML String_newline  strOutboundXML = convertPropSetToXMLString(Outputs);_newline  strOutboundXML = ToString(strOutboundXML);_newline  strOutboundXML = strOutboundXML.substring(28,strOutboundXML.lastIndexOf(&quot;&gt;&quot;)+1);_newline  _newline  //Log the error_newline  bsLogError = TheApplication().GetService(&quot;VF Error Handling Service&quot;);_newline  psInputs = TheApplication().NewPropertySet();_newline  psOutputs = TheApplication().NewPropertySet();  _newline  _newline  psInputs.SetProperty(&quot;SourceName&quot;, strTransactionName);_newline  psInputs.SetProperty(&quot;FunctionName&quot;, strTransactionName);  _newline  psInputs.SetProperty(&quot;Inbound XML&quot;, strInboundXML);_newline  psInputs.SetProperty(&quot;Outbound XML&quot;, strOutboundXML);_newline  psInputs.SetProperty(&quot;Error Message&quot;, strError);_newline  psInputs.SetProperty(&quot;Display Error Message&quot;, strError);_newline  psInputs.SetProperty(&quot;Error Code&quot;, sCode);_newline  bsLogError.InvokeMethod(&quot;Handle&amp;LogWorkflowException&quot;, psInputs, psOutputs);  _newline }_newline catch(e){_newline  if (defined(e.errText))_newline  {_newline   var strError = e.errText + &quot;\r\n&quot; + e.toString(); _newline  }_newline  else_newline  {_newline   var strError = e.toString(); _newline  }_newline  throw (strError); _newline }_newline finally { _newline  strInboundXML =&quot;&quot;;_newline  strOutboundXML =&quot;&quot;;_newline  psInputs = null;_newline  psOutputs = null;_newline  bsLogError = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mHandleException"
 Sequence="7"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mInsertAddr (Inputs,Outputs)_newline{_newline try_newline {_newline  var sbo = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline  var sbc = sbo.GetBusComp(&quot;VF Capture Customer Details TBC&quot;);_newline_newline  var sSessionId = Inputs.GetProperty(&quot;SessionId&quot;);_newline  var sAddrFormat = Inputs.GetProperty(&quot;formatAddr&quot;);_newline  var sStreetLocId = Inputs.GetProperty(&quot;streetLocId&quot;);_newline  var sStreetName = Inputs.GetProperty(&quot;streetName&quot;);_newline  var sStreetNum2 = Inputs.GetProperty(&quot;streetNum2&quot;);_newline  var sStreetTypeDesc = Inputs.GetProperty(&quot;streetTypeDesc&quot;);_newline  var sStreetType = Inputs.GetProperty(&quot;streetType&quot;);_newline  var sStreetNum1 = Inputs.GetProperty(&quot;streetNum1&quot;);_newline  var sCity = Inputs.GetProperty(&quot;City AU&quot;);_newline  var sState = Inputs.GetProperty(&quot;StateTerritory&quot;);_newline  var sPostCode = Inputs.GetProperty(&quot;postCode&quot;);_newline  var sLocName= Inputs.GetProperty(&quot;LocName&quot;);_newline  var sLocId = Inputs.GetProperty(&quot;LocId&quot;);_newline  var sJurisdictionId = Inputs.GetProperty(&quot;jurisdictionId&quot;);_newline  var sGeoFeature = Inputs.GetProperty(&quot;geoFeature&quot;);_newline  _newline  var street = (sStreetNum1 == &quot;&quot;) ? &quot;&quot;: ((sStreetNum2 != &quot;&quot;) ? sStreetNum1 + &quot;-&quot; + sStreetNum2 : sStreetNum1);_newline  _newline  with (sbc)_newline  {_newline_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline   ActivateField(&quot;Address Street Type&quot;);_newline   ActivateField(&quot;Postal Code&quot;);_newline   ActivateField(&quot;Street Address 2&quot;);_newline   ActivateField(&quot;Street Address&quot;);_newline   ActivateField(&quot;City&quot;);_newline   ActivateField(&quot;State&quot;);_newline   SetSearchSpec(&quot;Id&quot;,sSessionId);_newline   ExecuteQuery(ForwardOnly);_newline   if(FirstRecord())_newline   {_newline    SetFieldValue(&quot;Address Street Type&quot;,sStreetTypeDesc);_newline    SetFieldValue(&quot;Street Address 2&quot;,street);_newline    SetFieldValue(&quot;Street Address&quot;,sStreetType);_newline    var bcOrdPick =  sbc.GetPicklistBusComp(&quot;Postal Code&quot;);      _newline    with (bcOrdPick)_newline    {_newline     ClearToQuery();_newline     SetViewMode(AllView);    _newline     ActivateField(&quot;Zip Code&quot;);_newline     ActivateField(&quot;Suburb&quot;); _newline     SetSearchSpec(&quot;Zip Code&quot;,sPostCode);_newline     SetSearchSpec(&quot;Suburb&quot;,sLocName);_newline     ExecuteQuery(ForwardOnly); _newline     var isRecord = FirstRecord(); _newline     if(isRecord)_newline     {      _newline      Pick();      _newline     }                         _newline    }_newline    WriteRecord();_newline    TheApplication().SetProfileAttr(&quot;Inst&quot;,&quot;Sucess&quot;);_newline   }_newline  _newline   TheApplication().SetProfileAttr(&quot;Inst1&quot;,&quot;Fail&quot;);_newline     _newline  }_newline }_newline catch(e)_newline {_newline throw(e);_newline }_newline finally_newline {_newline }_newline_newline}_newline"
 Program_spcLanguage="JS"
 Name="mInsertAddr"
 Sequence="8"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-1ZOB5ZJ"
 Parent_spcName="VHA IM FWA Store Pickup Reservation Service BS MOCN"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mNewPSMA(Inputs, Outputs) _newline{_newlinetry{_newline var source = Inputs.GetProperty(&quot;source&quot;);_newline var source_usvalue = Inputs.GetProperty(&quot;source_usvalue&quot;);_newline var customer = Inputs.GetProperty(&quot;customer&quot;);_newline var category = Inputs.GetProperty(&quot;category&quot;);_newline var role = Inputs.GetProperty(&quot;role&quot;);_newline var longitude = Inputs.GetProperty(&quot;longitude&quot;);_newline var latitude = Inputs.GetProperty(&quot;latitude&quot;);_newlinevar sAddress =  Inputs.GetProperty(&quot;Address&quot;);_newline var SessionId = Inputs.GetProperty(&quot;SessionId&quot;);_newline var AddrId = Inputs.GetProperty(&quot;AddrId&quot;);_newline var sResId,sResStatus,sReservStat,sAccId,sDebug=&quot;N&quot;,sTrace=&quot;N&quot;,sHour=&quot;00&quot;,sErrorMsg=&quot;&quot;;_newline var sourcevalue = latitude+&quot;,&quot;+longitude;_newline TheApplication().SetProfileAttr(&quot;URL1&quot;,&quot;&quot;);_newline var psInputs = TheApplication().NewPropertySet();_newline    var psOutputs = TheApplication().NewPropertySet();_newline var psOut = TheApplication().NewPropertySet();_newline var child = TheApplication().NewPropertySet();_newline var child1 = TheApplication().NewPropertySet();_newline var queryParams = TheApplication().NewPropertySet();_newline var psRequestBody = TheApplication().NewPropertySet();_newline var headerParams = TheApplication().NewPropertySet();_newline  var jsOut = TheApplication().NewPropertySet();_newline var jsOutChild = TheApplication().NewPropertySet();_newline _newline var sBS = TheApplication().GetService(&quot;VHA Get Session Token Service&quot;);_newline  _newline sBS.InvokeMethod(&quot;GetSessionToken&quot;,psInputs,psOutputs);_newline _newline psInputs.SetProperty(&quot;Transaction Name&quot;,&quot;VFRESTNewPSMASubmitCoverageCheck&quot;);_newline sBS.InvokeMethod(&quot;GetConfigList&quot;,psInputs,psOut);_newline_newline sDebug = psOut.GetProperty(&quot;Flag 01&quot;);_newline sTrace = psOut.GetProperty(&quot;Flag 02&quot;);_newline_newline mGetCorrelationId(Outputs); _newline// headerParams.SetProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);_newlineheaderParams.SetProperty(&quot;x-api-key&quot;,&quot;tq9AnsGj4FPpR71mfTGXMMFFoH2MKl9p9GAtw24CHnf5Jhz9&quot;);_newline    headerParams.SetType(&quot;HeaderParams&quot;); _newline psInputs.Reset();_newline    psInputs.AddChild(headerParams);_newline_newline    sBS = TheApplication().GetService(&quot;VHA Siebel Rest API Adapter&quot;);_newline     _newline queryParams.SetType(&quot;QueryParams&quot;);    _newlinequeryParams.SetProperty(&quot;address&quot;, sAddress);_newline //queryParams.SetProperty(&quot;address&quot;, &quot;Level  111 Unit MELBOURNE LAVENDER BAY NSW 2060&quot;);_newline//queryParams.SetProperty(&quot;address&quot;,&quot; 54 AV ROSSGOLE NSW 2640&quot;);_newlinequeryParams.SetProperty(&quot;maxResults&quot;, &quot;5&quot;);_newline psInputs.AddChild(queryParams); _newline_newline  //  psInputs.SetProperty(&quot;ClientIdentifier&quot;, psOut.GetProperty(&quot;String 6&quot;));_newline  //  psInputs.SetProperty(&quot;ClientId&quot;, psOut.GetProperty(&quot;String 7&quot;));_newline    psInputs.SetProperty(&quot;Host&quot;, &quot;https://api.test.tpgt-apigee.aws.vodafone.com.au&quot;);_newline//    psInputs.SetProperty(&quot;ClientSecret&quot;, &quot;tq9AnsGj4FPpR71mfTGXMMFFoH2MKl9p9GAtw24CHnf5Jhz9&quot;);_newline    psInputs.SetProperty(&quot;ResourcePath&quot;, &quot;/addresses/v1/geocoder?&quot;); _newline _newline sBS.InvokeMethod(&quot;Get&quot;, psInputs, psOutputs);_newline  _newline var sCode = psOutputs.GetProperty(&quot;HTTP_usSTATUS_usCODE&quot;);_newline //var sErrorMsg  = psOutputs.GetProperty(&quot;message&quot;);_newline psOutputs.SetProperty(&quot;sCode&quot;,sCode);_newline psOutputs.SetProperty(&quot;sMsg&quot;,sErrorMsg);_newline Outputs.AddChild(psOutputs);_newline_newlinevar addressList = new Array();_newline_newlineTheApplication().SetProfileAttr(&quot;Count&quot;,psOutputs.GetChild(1).GetChild(0).GetChildCount());_newline for(var i=0;i&lt;psOutputs.GetChild(1).GetChild(0).GetChildCount(); i++)_newline {_newline  TheApplication().SetProfileAttr(&quot;ct&quot;,i);_newline  var mAddrProp = psOutputs.GetChild(1).GetChild(0).GetChild(i).GetChild(0).GetChild(0).GetFirstProperty();_newline_newline  var mAddrPropVal = &quot;&quot;;_newline  var Out = TheApplication().NewPropertySet();_newline  var sAddr = new Object;_newline  while(mAddrProp != &quot;&quot;)_newline  {_newline      if(mAddrProp == &quot;addressId&quot; )_newline   {_newline    mAddrPropVal = psOutputs.GetChild(1).GetChild(0).GetChild(i).GetChild(0).GetChild(0).GetProperty(mAddrProp);_newline_newline          //sAddr.id = mAddrPropVal;_newline    Out.SetProperty(&quot;Id&quot;,mAddrPropVal);_newline   }_newline   if(mAddrProp == &quot;formattedAddress&quot;)_newline   {_newline    mAddrPropVal = psOutputs.GetChild(1).GetChild(0).GetChild(i).GetChild(0).GetChild(0).GetProperty(mAddrProp);_newline_newline    //sAddr.value= mAddrPropVal;_newline    Out.SetProperty(&quot;Addr&quot;,mAddrPropVal);_newline   }_newline   _newline   mAddrProp = psOutputs.GetChild(1).GetChild(0).GetChild(i).GetChild(0).GetChild(0).GetNextProperty();_newline//throw(mAddrProp);_newline  }_newline_newline  //addressList.push(sAddr);_newline  Outputs.AddChild(Out);_newline_newline }_newline  _newline if(sDebug==&quot;Y&quot; || sTrace ==&quot;Y&quot;)_newline {_newline  DebugLog(&quot;VFRESTSubmitCoverageCheck&quot;, psInputs, psOutputs);_newline } _newline}_newlinecatch(e)_newline{_newline mHandleException(e,&quot;VFRESTSubmitCoverageCheck&quot;,psInputs,psOutputs);_newline throw(e);_newline}_newlinefinally_newline{_newline psInputs=null;_newline psOutputs=null;_newline child=null;_newline child1=null;_newline queryParams=null;_newline psRequestBody=null;_newline headerParams=null;_newline sBS=null;_newline}_newline}"
 Program_spcLanguage="JS"
 Name="mNewPSMA"
 Sequence="9"
></Business_spcService_spcScript
></Business_spcService
>
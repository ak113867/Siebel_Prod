<?xml version="1.0" encoding="UTF-8"?><?Siebel-Property-Set EscapeNames="true"?><Business_spcService
 Comments="SATHISHG- Active CBS Version - 15-07-2025-Online Fibre Upg Fix Added"
 State_spcManagement_spcType="Stateful"
 Cache="N"
 Server_spcEnabled="N"
 Display_spcName="VHA Fibre Upgrade Processing Ext Service"
 Inactive="N"
 Hidden="N"
 Class="CSSService"
 Name="VHA Fibre Upgrade Processing Ext Service_CBS"
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="AddPropFibreOrdManageService"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="AddPropFibreOrdManageService"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118286"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="AddPropFibreOrdManageService"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="AddPropInterimOrder"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="AddPropInterimOrder"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118288"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="AddPropInterimOrder"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="AutoAllocateSIM"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="AutoAllocateSIM"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211828A"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="AutoAllocateSIM"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211828A"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="AutoAllocateSIM"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="CLUpdateCVCId"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="CLUpdateCVCId"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211828D"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="CLUpdateCVCId"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211828D"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="CLUpdateCVCId"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="CreateACSProvInfo"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="CreateACSProvInfo"
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="CreateInterimOrdDetails"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="CreateInterimOrdDetails"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857P"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="CreateInterimOrdDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="FCCreateFibConDetails"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="FCCreateFibConDetails"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857R"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Output"
 Display_spcName="FibreServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="FCCreateFibConDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="FibreServiceOrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857R"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="FCCreateFibConDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857R"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="FCCreateFibConDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="FCNBNAttributesUpd"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="FCNBNAttributesUpd"
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="GetAssetCVCOrdUpd"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="GetAssetCVCOrdUpd"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857W"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="Order Id"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="GetAssetCVCOrdUpd"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="Order Id"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857W"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="RootAssetId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="GetAssetCVCOrdUpd"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="RootAssetId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211857W"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="GetAssetCVCOrdUpd"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="GetInterimPropId"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="GetInterimPropId"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118580"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="PropSiebelPrdType"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="GetInterimPropId"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="PropSiebelPrdType"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="GetLinkFCOrderDetails"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="GetLinkFCOrderDetails"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118582"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="NBNFCChildOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="GetLinkFCOrderDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="NBNFCChildOrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118582"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="NBNFCParentOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="GetLinkFCOrderDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="NBNFCParentOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="UpdateCVCId"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="UpdateCVCId"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118585"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="UpdateCVCId"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118585"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="UpdateCVCId"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="UpdateNBNAttributes"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="UpdateNBNAttributes"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118588"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="UpdateNBNAttributes"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-2118588"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="UpdateNBNAttributes"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="UpsertNBNAttributes"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="UpsertNBNAttributes"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211858B"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="UpsertNBNAttributes"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211858B"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="ServiceOrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="UpsertNBNAttributes"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="ServiceOrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="3-2118285"
 Display_spcName="VerifyInterimOrdDetails"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="VerifyInterimOrdDetails"
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211858E"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Output"
 Display_spcName="FCSelectedPropId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="VerifyInterimOrdDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="FCSelectedPropId"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211858E"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Output"
 Display_spcName="FCSelectedRatePlan"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="VerifyInterimOrdDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="FCSelectedRatePlan"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211858E"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Output"
 Display_spcName="NBNFTTPInterim"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="VerifyInterimOrdDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="NBNFTTPInterim"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Data_spcType="String"
 Comments=""
 Preferred_spcSequence=""
 Parent_spcId="3-211858E"
 GParent_spcId="3-2118285"
 Pick_spcApplet=""
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="OrderId"
 GParent_spcInactive="N"
 Inactive="N"
 Parent_spcName="VerifyInterimOrdDetails"
 Parent_spcInactive="N"
 Hidden="N"
 Picklist=""
 Name="OrderId"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function QueryACSLOV(Inputs, Outputs)_newline{_newline try_newline {      _newline  var Type = &quot;VHA_usNBN_usACS_usATTR&quot;;_newline  var sSKUCode =Inputs.GetProperty(&quot;SKUCode&quot;);_newline  _newline  var sProdClass = &quot;&quot;;_newline  var sModemOUI = &quot;&quot;;  _newline  _newline  var boLOV = TheApplication().GetBusObject(&quot;List Of Values&quot;);_newline  var  bcLOV = boLOV.GetBusComp(&quot;List Of Values&quot;);_newline  if (sSKUCode == &quot;&quot; || sSKUCode == null)_newline  {_newline   var sDefaultModemOUI = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ModemOUIDefault&quot;);_newline   var sDefaultProductClass = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ProductClassDefault&quot;);_newline   Outputs.SetProperty(&quot;sModemOUI&quot;,sDefaultModemOUI);_newline   Outputs.SetProperty(&quot;sProdClass&quot;,sDefaultProductClass);_newline  }_newline  if (sSKUCode != &quot;&quot; &amp;&amp; sSKUCode != null)_newline  {_newline  with(bcLOV)_newline  {_newline  ClearToQuery();_newline  SetViewMode(AllView);_newline  ActivateField(&quot;Type&quot;);_newline  ActivateField(&quot;Value&quot;); _newline  ActivateField(&quot;Name&quot;);_newline  ActivateField(&quot;Sub Type&quot;);_newline  SetSearchSpec(&quot;Type&quot;,Type); _newline  SetSearchSpec(&quot;Name&quot;,sSKUCode); _newline  ExecuteQuery(ForwardOnly)_newline   if(FirstRecord())_newline   {_newline    sProdClass = GetFieldValue(&quot;Value&quot;);_newline    sModemOUI = GetFieldValue(&quot;Sub Type&quot;);_newline    Outputs.SetProperty(&quot;sModemOUI&quot;,sModemOUI);_newline    Outputs.SetProperty(&quot;sProdClass&quot;,sProdClass);_newline   }_newline   else_newline   {_newline   var sDefaultModemOUI = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ModemOUIDefault&quot;);_newline   var sDefaultProductClass = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ProductClassDefault&quot;);_newline   Outputs.SetProperty(&quot;sModemOUI&quot;,sDefaultModemOUI);_newline   Outputs.SetProperty(&quot;sProdClass&quot;,sDefaultProductClass);_newline   _newline   }_newline  }//with bcLOV _newline }_newline }_newline _newline_newline catch (e)_newline {_newline  throw (e);_newline }_newline_newline finally_newline {_newline  bcLOV = null;_newline  boLOV = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="QueryACSLOV"
 Sequence="40"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function Service_usPreInvokeMethod (MethodName, Inputs, Outputs)_newline{_newlinetry_newline{_newline _newline switch(MethodName)_newline  { _newline case &quot;mAddPropFibreConOrder&quot;:    _newline //mAddPropFibreConOrder(Inputs,Outputs);_newline break;_newline_newline case &quot;AddPropInterimOrder&quot;:    _newline mAddPropInterimOrder(Inputs,Outputs);_newline break;_newline_newline case &quot;AddPropFibreOrdManageService&quot;:    _newline mAddPropFibreOrderManageService(Inputs,Outputs);_newline break;_newline_newline case &quot;GetInterimPropId&quot;:    _newline mGetInterimPropId(Inputs,Outputs);_newline break;_newline_newline case &quot;AutoAllocateSIM&quot;:    _newline mAutoAllocateSIM(Inputs,Outputs);_newline break;_newline_newline case &quot;UpdateCVCId&quot;:    _newline mUpdateCVCId(Inputs,Outputs);_newline break;_newline_newline case &quot;CreateInterimOrdDetails&quot;:    _newline mCreateInterimOrdDetails(Inputs,Outputs);_newline break;_newline_newline case &quot;VerifyInterimOrdDetails&quot;:    _newline mVerifyInterimOrdDetails(Inputs,Outputs);_newline break;_newline_newline case &quot;GetLinkFCOrderDetails&quot;:    _newline mGetLinkFCOrderDetails(Inputs,Outputs);_newline break;_newline_newline case &quot;UpsertNBNAttributes&quot;:    _newline mUpsertNBNAttributes(Inputs,Outputs);_newline break;_newline_newline case &quot;FCCreateFibConDetails&quot;:    _newline mFCCreateFibConDetails(Inputs,Outputs);_newline break;_newline_newline case &quot;GetAssetCVCOrdUpd&quot;:    _newline mGetAssetCVCOrdUpd(Inputs,Outputs);_newline break;_newline_newline case &quot;CLUpdateCVCId&quot;:    _newline mCLUpdateCVCId(Inputs,Outputs);_newline break;_newline_newline case &quot;UpdateNBNAttributes&quot;:    _newline mUpdateNBNAttributes(Inputs,Outputs);_newline break;_newline_newlinecase &quot;FCNBNAttributesUpd&quot;:    _newlinemFCNBNAttributesUpd(Inputs,Outputs);_newline break;_newline_newlinecase &quot;CreateACSProvInfo&quot;:    _newlinemCreateACSProvisioningInfo(Inputs,Outputs);_newline break;_newline_newline _newline                       _newline   default:_newline    throw (&quot;Unknown MethodName = &quot; + MethodName);_newline  }_newlinereturn (CancelOperation);_newline}_newlinecatch(e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newline_newline_newline}_newline_newline return (ContinueOperation);_newline}"
 Program_spcLanguage="JS"
 Name="Service_usPreInvokeMethod"
 Sequence="41"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function UpdateBWProfile(Inputs,Outputs)_newline{_newlinetry_newline{_newline  var sOrderId,sRootOrderItemId,sAccessTech,Speed, sActiveFlg,sOrgName,psInput2,psOutput2=&quot;&quot;;_newline  var svc1=&quot;&quot;;_newline  _newline  sOrgName= &quot;Vodafone AU&quot;;_newline  //Speed = &quot;1000/50&quot;;_newline  sAccessTech=&quot;Fibre&quot;;_newline  sActiveFlg = &quot;Y&quot;;_newline  _newline  sOrderId = Inputs.GetProperty(&quot;FibOrderId&quot;);_newline  sRootOrderItemId = Inputs.GetProperty(&quot;FibSerOrdId&quot;);_newline  _newline  if (sOrderId  != &quot;&quot; &amp;&amp; sRootOrderItemId != &quot;&quot;)_newline  {_newline   psInput2 = TheApplication().NewPropertySet();_newline   psOutput2 = TheApplication().NewPropertySet();_newline   svc1 = TheApplication().GetService(&quot;VHA FBB BS&quot;);_newline   psInput2.SetProperty(&quot;OrderId&quot;,sOrderId);_newline   psInput2.SetProperty(&quot;ServiceOrderId&quot;,sRootOrderItemId);_newline   svc1.InvokeMethod(&quot;GetSpeedOLILevel&quot;, psInput2, psOutput2);_newline   Speed = psOutput2.GetProperty(&quot;NBNSpeed&quot;);_newline  _newline  var searchspec = &quot;[Order Entry - Orders.Id] = &apos;&quot; + sOrderId + &quot;&apos;&quot; + &quot; AND &quot; + &quot;([Order Entry - Line Items.Root Order Item Id] = &apos;&quot; + sRootOrderItemId + &quot;&apos;&quot; + &quot; AND&quot; + &quot; [Order Entry - Line Items.Service Type] = &apos;Fixed NBN&apos;&quot; + &quot; OR&quot; + &quot; [Order Entry - Line Items.Product Sub Type Code] = &apos;Service Specification&apos;)&quot; + &quot; AND&quot; + &quot; ([VHA Configuration List.Type] = &apos;VHA_usFBB_usPROD_usATTR_usMAP&apos;&quot; + &quot; AND &quot; + &quot; [VHA Configuration List.Name] = &apos;&quot; + sAccessTech + &quot;&apos; &quot; + &quot; AND &quot; + &quot;[VHA Configuration List.Value] = &apos;&quot; + Speed + &quot;&apos; &quot; + &quot; AND &quot; + &quot;[VHA Configuration List.Active Flg] = &apos;&quot; + sActiveFlg + &quot;&apos; &quot; + &quot; AND &quot; + &quot;[VHA Configuration List.Organization Name] = &apos;&quot; + sOrgName + &quot;&apos;)&quot;;_newline  _newline  _newline  var svc = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline  var psInput = TheApplication().NewPropertySet();_newline  var psOutput = TheApplication().NewPropertySet();_newline  psInput.SetProperty(&quot;MapName&quot;,&quot;VHA NBN Order Product Attribute Map&quot;);_newline  psInput.SetProperty(&quot;OutputIntObjectName&quot;,&quot;VHA NBN Order Upsert IO&quot;);_newline  psInput.SetProperty(&quot;OrderId&quot;,sOrderId);_newline  psInput.SetProperty(&quot;searchexpr&quot;,searchspec);_newline  psInput.SetProperty(&quot;RequestIOName&quot;,&quot;VHA NBN Order Upsert IO&quot;);_newline  psInput.SetProperty(&quot;ProcessName&quot;, &quot;VHA Insert Upsert Workflow&quot;);_newline  svc.InvokeMethod(&quot;RunProcess&quot;, psInput, psOutput);_newline  var strErrorMessage = psOutput.GetProperty(&quot;Error Message&quot;);_newline  if(strErrorMessage != &quot;&quot;)_newline  {_newline  TheApplication().RaiseErrorText(strErrorMessage);_newline  } _newline_newline }_newline_newline}_newlinecatch(e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newline_newline}_newline_newline_newline_newline}"
 Program_spcLanguage="JS"
 Name="UpdateBWProfile"
 Sequence="2"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function fnDeleteFibreOrder(Inputs, Outputs)_newline{_newline  try_newline  {_newline   var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline   var boOrder,bcOrder;_newline   if(sOrderId != &quot;&quot; &amp;&amp; sOrderId != null)_newline   {_newline_newline    boOrder = TheApplication().GetBusObject(&quot;VF Order Relationships&quot;);_newline    bcOrder = boOrder.GetBusComp(&quot;VF Order Header&quot;);    _newline    _newline    bcOrder.ClearToQuery();_newline    bcOrder.SetViewMode(AllView);_newline    bcOrder.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline    bcOrder.ExecuteQuery(ForwardOnly);_newline    _newline    if(bcOrder.FirstRecord())_newline    {_newline    bcOrder.DeleteRecord();_newline_newline    }_newline   }_newline  }_newline  catch (e)_newline  {_newline   throw(e);_newline  }_newline  finally_newline  {_newline   _newline   bcOrder = null;_newline   boOrder  = null;_newline  }_newline}"
 Program_spcLanguage="JS"
 Name="fnDeleteFibreOrder"
 Sequence="1"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function fnGetCVCId(Inputs, Outputs)_newline{_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;Order Item XA&quot;);_newline  var sOrderId =Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sServiceOrderId =Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline  var strOrderSubFunction =Inputs.GetProperty(&quot;OrderSubFunction&quot;);_newline  var sCVCId = &quot;&quot;;_newline  var sCount = &quot;&quot;;_newline  var sParentOrderStatus = &quot;&quot;;_newline  var sParentOrderId = &quot;&quot;;_newline  Inputs.SetProperty(&quot;CVCId&quot;,&quot;&quot;);_newline  Outputs.SetProperty(&quot;ParentOrderStatus&quot;,&quot;&quot;);_newline  Outputs.SetProperty(&quot;ParentOrderId&quot;,&quot;&quot;);_newline_newline  if(sOrderId != &quot;&quot; &amp;&amp; sServiceOrderId != &quot;&quot;)_newline  {_newline//throw(&quot;1a&quot;+sOrderId+&quot;:&quot;+sServiceOrderId + strOrderSubFunction);_newline   _newline   bcOrder.ActivateField(&quot;VF Parent Order Status&quot;);_newline   bcOrder.ActivateField(&quot;Parent Order Id&quot;);_newline   bcOrder.SetViewMode(AllView);_newline   bcOrderItem.ActivateField(&quot;VHA FBB Service Count&quot;);_newline   bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;,sServiceOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Service Type&quot;,&quot;NBN&quot;);_newline   bcOrderItem.SetSearchSpec(&quot;Product Sub Type Code&quot;,&quot;Service Specification&quot;);_newline   if(strOrderSubFunction == &quot;Change Location Connect&quot;)_newline   {_newline    bcOrderItem.SetSearchSpec(&quot;Action Code&quot;,&quot;&lt;&gt; Delete&quot;);_newline   }_newline   bcOrderItemXA.SetSearchSpec(&quot;Name&quot;,&quot;CVC Id&quot;);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if(bcOrder.FirstRecord())_newline   {_newline    sParentOrderStatus = bcOrder.GetFieldValue(&quot;VF Parent Order Status&quot;);_newline    sParentOrderId = bcOrder.GetFieldValue(&quot;Parent Order Id&quot;);_newline    Outputs.SetProperty(&quot;ParentOrderStatus&quot;,sParentOrderStatus);_newline    Outputs.SetProperty(&quot;ParentOrderId&quot;,sParentOrderId);_newline    if(bcOrderItem.FirstRecord() &amp;&amp; bcOrderItemXA.FirstRecord())_newline    {_newline     sCount = bcOrderItem.GetFieldValue(&quot;VHA FBB Service Count&quot;);_newline     sCVCId = bcOrderItemXA.GetFieldValue(&quot;Value&quot;);_newline//throw(sCVCId);_newline     if(sCVCId != &quot;&quot; &amp;&amp; sCount == &quot;&quot;)_newline     {_newline      Inputs.SetProperty(&quot;CVCId&quot;,sCVCId);_newline      bcOrderItem.SetFieldValue(&quot;VHA FBB Service Count&quot;,1);_newline      bcOrderItem.WriteRecord();_newline     }_newline    }_newline   }_newline  }_newline  Outputs.SetProperty(&quot;CVCID&quot;,sCVCId);_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  bcOrderItem = null;_newline  bcOrderItemXA = null;_newline  boOrder = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fnGetCVCId"
 Sequence="2"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function fnGetModemDetails(Inputs, Outputs)_newline{_newline//Sathish : 20/02/2022 created for NBN rationalization_newline try_newline {_newline var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline var sServiceOrderId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline var sSpecialSiebTpe = Inputs.GetProperty(&quot;InpSpecialSiebelType&quot;); //Ravindra:12/07/2024: Added for SMB Phase2_newline var sNBNOrderBO = TheApplication().GetBusObject(&quot;VHA NBN Order BO&quot;);_newline var sNBNOrderBC = sNBNOrderBO.GetBusComp(&quot;VHA NBN Order Details&quot;);_newline var sAccessTech,sAccessTechNew,sState, sCSA, sIMEI, sSKUCode = &quot;&quot;;_newline var sNBNOnly1 = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline var sNBNwithMBB1 = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;);_newline  _newline if(sOrderId!= null &amp;&amp; sServiceOrderId != &quot;&quot;)_newline {_newline _newline  with(sNBNOrderBC)_newline  {_newline  ClearToQuery();_newline  SetViewMode(AllView);_newline  ActivateField(&quot;Order Id&quot;);_newline  ActivateField(&quot;Service Order Id&quot;); _newline  ActivateField(&quot;Access Technology&quot;);_newline  ActivateField(&quot;Modem Serial Number&quot;);_newline  //ActivateField(&quot;CSA Id&quot;);_newline  ActivateField(&quot;NBN Address State&quot;);_newline  SetSearchSpec(&quot;Order Id&quot;,sOrderId);_newline  SetSearchSpec(&quot;Service Order Id&quot;,sServiceOrderId);    _newline  ExecuteQuery(ForwardOnly);_newline  if(FirstRecord())_newline  {_newline   sAccessTech = GetFieldValue(&quot;Access Technology&quot;);_newline   sState = GetFieldValue(&quot;NBN Address State&quot;);_newline   sIMEI = GetFieldValue(&quot;Modem Serial Number&quot;);_newline  _newline  _newline    _newline     var oOrderBO = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);_newline     var bcOrder1 = oOrderBO.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline     var bcOrderItems1 = oOrderBO.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline     var oIMEIListBC = oOrderBO.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline     var sSearchspec1 = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Id] = &apos;&quot; + sServiceOrderId + &quot;&apos; AND ([VF Siebel Product Type] = &apos;&quot; + sNBNOnly1 + &quot;&apos; OR [VF Siebel Product Type] = &apos;&quot; + sNBNwithMBB1 + &quot;&apos;)&quot;;_newline     var sSerialNum,sProductCode=&quot;&quot;;_newline     _newline     _newline     bcOrder1.SetViewMode(AllView);_newline     bcOrder1.ClearToQuery();_newline     bcOrder1.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline     bcOrderItems1.ActivateField(&quot;VF Siebel Product Type&quot;);_newline     oIMEIListBC.ActivateField(&quot;IMEI&quot;);_newline     oIMEIListBC.ActivateField(&quot;Product Code&quot;);_newline     bcOrderItems1.SetSearchExpr(sSearchspec1);_newline     oIMEIListBC.SetSearchSpec(&quot;Root Order Line Item&quot;, sServiceOrderId);_newline     bcOrder1.ExecuteQuery(ForwardOnly);_newline     //bcOrderItems1.ExecuteQuery(ForwardOnly);_newline     //oIMEIListBC.ExecuteQuery(ForwardOnly);_newline    _newline     if(bcOrderItems1.FirstRecord())_newline     {_newline     _newline      if(oIMEIListBC.FirstRecord())_newline      {_newline       sSerialNum = oIMEIListBC.GetFieldValue(&quot;IMEI&quot;);_newline       sSKUCode =   oIMEIListBC.GetFieldValue(&quot;Product Code&quot;);    _newline      }_newline     _newline     }_newline    _newline    _newline    _newline    _newline  _newline  }_newline  }_newline  //Below section to fetch modem SKU code for SMB Fibre Orders - SMB Phase 2: 12/07/2024_newline   if (sSKUCode == &quot;&quot; &amp;&amp; sSpecialSiebTpe == &quot;SMB&quot;)_newline   {_newline  Inputs.SetProperty(&quot;IMEI&quot;,sIMEI );_newline  Inputs.SetProperty(&quot;Order Id&quot;,sOrderId);    _newline  mQueryIMEIList(Inputs, Outputs);_newline  sSKUCode = Outputs.GetProperty(&quot;Product Code&quot;);_newline   }  _newline_newline_newline }_newline  _newline  Outputs.SetProperty(&quot;StateValue&quot;, sState);_newline  if(sIMEI != null &amp;&amp; sIMEI != &quot;&quot;)_newline  {_newline  Outputs.SetProperty(&quot;ModemNo&quot;, sIMEI);_newline  Outputs.SetProperty(&quot;ModemSKU&quot;, sSKUCode);_newline  }_newline_newline  else if(sSerialNum != null &amp;&amp; sSerialNum != &quot;&quot;)_newline  {_newline  Outputs.SetProperty(&quot;ModemNo&quot;, sSerialNum);_newline  Outputs.SetProperty(&quot;ModemSKU&quot;, sSKUCode);_newline  //Outputs.SetProperty(&quot;CSA&quot;, sCSA);_newline  }_newline  Outputs.SetProperty(&quot;NBNAcessTech1&quot;,sAccessTech);_newline _newline_newline }_newline _newline catch(e)_newline {_newline throw(e);_newline }_newline_newline finally_newline {_newline sNBNOrderBC = null;_newline sNBNOrderBO = null;_newline oIMEIListBC = null; _newline bcOrderItems1 = null;_newline bcOrder1 = null;_newline oOrderBO = null;_newline    _newline  _newline }_newline_newline_newline_newline_newline}_newline"
 Program_spcLanguage="JS"
 Name="fnGetModemDetails"
 Sequence="3"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function fnInterimGetCVCId(Inputs,Outputs)_newline{_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);  _newline  var bcOrder = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);  _newline  var bcOrderItem = boOrder.GetBusComp(&quot;VF Order Entry - Line Items Thin&quot;); _newline  _newline  var sOrderId = Inputs.GetProperty(&quot;IntOrderId&quot;);_newline  var sRootId = Inputs.GetProperty(&quot;IntServiceOrderId&quot;);_newlinevar sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline  var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;);_newlinevar sOrdChannel=&quot;&quot;;_newline_newline//throw(sOrderId);_newline  _newline  var sSearchspec,sRootItemId,sOrdersubFunction, sOrderSubTypeTBUI, sParentOrd, sOrderSubType,sCVCId;_newline  var sFCInterimOrdSubFn = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade //Interim&quot;);  _newline  var sEnableOLSFibreCVC = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VF_usCR_usENABLE_usFLAG&quot;,&quot;EnableOLSFibreCVC&quot;);_newline_newline  if(sRootId != &quot;&quot;)_newline  {_newline  sSearchspec = &quot;[Id] = &apos;&quot; + sRootId + &quot;&apos;&quot;;_newline  }_newline  else_newline  {_newline  sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL  AND [Action Code]=&apos;Add&apos; AND ([VF Siebel Product Type] = &apos;&quot; + sNBNOnly + &quot;&apos; OR [VF Siebel Product Type] = &apos;&quot; + sNBNwithMBB + &quot;&apos;)&quot;;_newline  }_newline_newline_newline  if(sOrderId != &quot;&quot;)_newline  {_newline   bcOrder.SetViewMode(AllView);_newlinebcOrder.ActivateField(&quot;VF Order Channel&quot;);_newlinebcOrderItem.ActivateField(&quot;VF Order Sub Function&quot;);_newlinebcOrderItem.ActivateField(&quot;VF Order Sub Type TBUI&quot;);_newlinebcOrderItem.ActivateField(&quot;VF Service Order Sub Type&quot;);_newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;, sOrderId);_newlinebcOrderItem.SetSearchSpec(&quot;Order Header Id&quot;, sOrderId);_newlinebcOrderItem.SetSearchSpec(&quot;Parent Order Item Id&quot;, &quot;&quot;);_newlinebcOrderItem.SetSearchSpec(&quot;Action Code&quot;, &quot;Add&quot;);_newline   _newline   bcOrder.ExecuteQuery(ForwardOnly);_newline_newline_newline_newline   if (bcOrder.FirstRecord())_newline   {_newlinesOrdChannel= bcOrder.GetFieldValue(&quot;VF Order Channel&quot;);_newline     if (bcOrderItem.FirstRecord())_newline     {_newline     sRootItemId = bcOrderItem.GetFieldValue(&quot;Id&quot;);_newline     sOrdersubFunction = bcOrderItem.GetFieldValue(&quot;VF Order Sub Function&quot;);_newline     sOrderSubTypeTBUI = bcOrderItem.GetFieldValue(&quot;VF Order Sub Type TBUI&quot;);_newline     sOrderSubType = bcOrderItem.GetFieldValue(&quot;VF Service Order Sub Type&quot;);_newline_newline_newline    if (sRootItemId != &quot;&quot; &amp;&amp;  sOrderSubType== &quot;Change Proposition&quot; &amp;&amp; sOrdChannel != &quot;VHA Online Store&quot;)_newline     {_newline     Inputs.SetProperty(&quot;ServiceOrderId&quot;,sRootItemId);_newline     Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newlineInputs.SetProperty(&quot;OrderSubFunction&quot;,sOrdersubFunction);_newline     fnGetCVCId(Inputs, Outputs);_newline     sCVCId = Outputs.GetProperty(&quot;CVCID&quot;);_newline_newline     //mUpdateCVCId(Inputs,Outputs);_newline     _newline     Outputs.SetProperty(&quot;CVC Id&quot;, sCVCId);_newline     }_newline     if (sRootItemId != &quot;&quot; &amp;&amp; sOrdChannel == &quot;VHA Online Store&quot; &amp;&amp; sEnableOLSFibreCVC == &quot;Y&quot; )_newline     {_newline_newline     Inputs.SetProperty(&quot;ServiceOrderId&quot;,sRootItemId);_newline     Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newlineInputs.SetProperty(&quot;OrderSubFunction&quot;,sOrdersubFunction);_newline_newline     fnGetCVCId(Inputs, Outputs);_newline     sCVCId = Outputs.GetProperty(&quot;CVCID&quot;);_newline     //mUpdateCVCId(Inputs,Outputs);_newline     _newline     Outputs.SetProperty(&quot;CVC Id&quot;, sCVCId);_newline     }_newline     _newline     _newline     }_newline    _newline   }_newline  }_newline }_newline catch (e)_newline {_newline  throw (e);_newline }_newline finally_newline {_newline  bcOrderItem = null;_newline  bcOrder = null;_newline  boOrder = null;_newline  _newline }_newline}"
 Program_spcLanguage="JS"
 Name="fnInterimGetCVCId"
 Sequence="4"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mAddPropFibreOrderManageService (Inputs, Outputs)_newline{//SATHISH 19/10/2023 this logic will Add line item to Fibre connect order_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);_newline_newline  var bcOrder1 = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);   _newline  var bcOrderline = boOrder.GetBusComp(&quot;VF Order Line Item - Light&quot;);_newline  _newline  var bsInvokeUpLI;_newline  var psInputOLI = TheApplication().NewPropertySet();_newline  var psOutputOLI = TheApplication().NewPropertySet();_newline  _newline  var oHead = Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sFibreProdId = Inputs.GetProperty(&quot;Product&quot;);_newline  var oType = Inputs.GetProperty(&quot;OrderType&quot;);_newline  var oAccountId = Inputs.GetProperty(&quot;AccountId&quot;);_newline  var FCInterimOrderFlag = Inputs.GetProperty(&quot;FCInterimOrderFlag&quot;);_newline  var FCConnectOrderFlag = Inputs.GetProperty(&quot;FCConnectOrderFlag&quot;);_newline_newline  var sFTTNCPlan = Inputs.GetProperty(&quot;FTTNCPlan&quot;);_newline  var sFibrePlan = Inputs.GetProperty(&quot;RatePlanSelected&quot;);_newline var sFTTNCPropId = Inputs.GetProperty(&quot;FTTNCPropId&quot;);_newline_newline  var sModemSerialNum = Inputs.GetProperty(&quot;ModemSerialNum&quot;);_newline  var sServicePin = Inputs.GetProperty(&quot;FTTNCServicePin&quot;);_newline  var sEsim= TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usSIM_usTYPE&quot;,&quot;eSIM&quot;);_newline  var sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline  var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;);_newline  var sFConOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Connect&quot;);_newline  var sFCInterimOrdSubFn = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Interim&quot;);_newline  _newline  var sFCChangeProp = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;FCChange Proposition&quot;);_newline  var sFCChangeTech = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;FCChange Technology&quot;);_newline  var sFCRPC = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Rate Plan Change&quot;);_newline  _newline  var sStockIndicator = &quot;In Stock&quot;;_newline  var oItem;_newline  var sAccessTechnology = &quot;&quot;;_newline  var oOrganization = &quot;&quot;; _newline  var bcOrderLI;_newline  var bcPick;_newline  var bcAllocateIMEI;_newline  var sRootOrderItemId=&quot;&quot;;_newline  var sSiebelProType=&quot;&quot;;_newline_newline  if (oHead != &quot;&quot; &amp;&amp; oHead != null)_newline  {_newline   bcOrder.ActivateField(&quot;Primary Organization&quot;);_newline   bcOrder.SetViewMode(AllView); _newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,oHead);_newline   bcOrder.ExecuteQuery(ForwardOnly); _newline   if (bcOrder.FirstRecord())_newline   {_newline    oOrganization = bcOrder.GetFieldValue(&quot;Primary Organization&quot;);_newline    bcOrderLI = boOrder.GetBusComp(&quot;Order Entry - Line Items&quot;);_newline    bcAllocateIMEI = boOrder.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline    with(bcOrderLI)_newline    {_newline     ActivateField(&quot;Service PIN&quot;);_newline     ActivateField(&quot;eSIM Download&quot;);_newline     ExecuteQuery();_newline     NewRecord(NewAfter);_newline     SetFieldValue(&quot;Product Id&quot;,sFibreProdId);_newline     SetFieldValue(&quot;Cfg Type&quot;,&quot;eConfigurator&quot;);_newline     SetFieldValue(&quot;Access Technology&quot;,&quot;Fibre&quot;);_newline     SetFieldValue(&quot;VF Port In TBUI&quot;, &quot;No&quot;);      _newline     SetFieldValue(&quot;VF Configuration Status&quot;, &quot;Customized&quot;);_newline     SetFieldValue(&quot;VF Service Order Sub Type&quot;, &quot;Connect&quot;);_newline     if (FCInterimOrderFlag == &quot;Y&quot;)_newline     { _newline     SetFieldValue(&quot;VF Order Sub Function&quot;, sFCInterimOrdSubFn);_newline     }_newline     else_newline     {_newline     SetFieldValue(&quot;VF Order Sub Function&quot;, sFConOrdSubFunction);_newline     }_newline_newline    if (sFTTNCPropId == sFibreProdId &amp;&amp; sFTTNCPropId != &quot;&quot;  &amp;&amp;  sFibreProdId != &quot;&quot; &amp;&amp; sFTTNCPlan == sFibrePlan)_newline     {_newline     SetFieldValue(&quot;VF Order Sub Type TBUI&quot;, sFCChangeTech);_newline   Outputs.SetProperty(&quot;FCOrderSubTypeTBUI&quot;,sFCChangeTech);_newline     }_newline     else if ((sFTTNCPropId != sFibreProdId || sFTTNCPlan != sFibrePlan)&amp;&amp; sFTTNCPropId != &quot;&quot;  &amp;&amp;  sFibreProdId != &quot;&quot; )_newline     {_newline     SetFieldValue(&quot;VF Order Sub Type TBUI&quot;, sFCChangeProp);_newline   Outputs.SetProperty(&quot;FCOrderSubTypeTBUI&quot;,sFCChangeProp);_newline     }_newline     else_newline     {_newline     SetFieldValue(&quot;VF Order Sub Type TBUI&quot;, &quot;Fibre Connect&quot;);_newline    Outputs.SetProperty(&quot;FCOrderSubTypeTBUI&quot;,&quot;Fibre Connect&quot;);_newline     }_newline     _newline     if (FCConnectOrderFlag == &quot;&quot; &amp;&amp; FCInterimOrderFlag == &quot;&quot;)_newline     {_newline     SetFieldValue(&quot;eSIM Download&quot;, &quot;QR Code&quot;);_newline     }_newline     SetFieldValue(&quot;Billing Account Id&quot;,oAccountId);_newline     //SetFieldValue(&quot;Service PIN&quot;,sServicePin);_newline     WriteRecord();_newline     oItem = GetFieldValue(&quot;Id&quot;);_newline_newline     ClearToQuery();_newline     ActivateField(&quot;VF Root Siebel Product Type&quot;);_newline     SetSearchSpec(&quot;Id&quot;,oItem);_newline     ExecuteQuery(ForwardOnly); _newline     if(FirstRecord())_newline     {_newline      sSiebelProType = GetFieldValue(&quot;VF Root Siebel Product Type&quot;);_newline      if (sSiebelProType == sNBNwithMBB)_newline      {_newline       SetFieldValue(&quot;VF ConnectionType&quot;,&quot;Plan and Device&quot;);_newline       if (FCConnectOrderFlag == &quot;&quot; &amp;&amp; FCInterimOrderFlag == &quot;&quot;)_newline       {_newline       SetFieldValue(&quot;Shipping&quot;, sEsim);_newline       }_newline       Outputs.SetProperty(&quot;SiebelProdType&quot;,sSiebelProType); _newline_newline      }_newline   if(sSiebelProType == sNBNOnly &amp;&amp; sModemSerialNum != &quot;&quot; &amp;&amp; sModemSerialNum != null)_newline   {_newline    SetFieldValue(&quot;VF ConnectionType&quot;,&quot;Plan and Device&quot;);_newline    SetFieldValue(&quot;Shipping&quot;, sEsim);_newline    Outputs.SetProperty(&quot;SiebelProdType&quot;,sSiebelProType); _newline   }_newline      else if (sSiebelProType == sNBNOnly &amp;&amp; (sModemSerialNum == &quot;&quot; || sModemSerialNum == null))_newline      {_newline       SetFieldValue(&quot;VF ConnectionType&quot;,&quot;SIM Only&quot;);_newline       if (FCConnectOrderFlag == &quot;&quot; &amp;&amp; FCInterimOrderFlag == &quot;&quot;)_newline       {_newline       SetFieldValue(&quot;Shipping&quot;, &quot;&quot;);_newline       SetFieldValue(&quot;eSIM Download&quot;, &quot;&quot;);_newline       }_newline       Outputs.SetProperty(&quot;SiebelProdType&quot;,sSiebelProType); _newline       _newline      }_newline_newline      if (sModemSerialNum != &quot;&quot; &amp;&amp; sModemSerialNum != null)_newline      {_newline       SetFieldValue(&quot;VF IMEI TBUI&quot;,sModemSerialNum); _newline      }_newline   _newline      _newline      WriteRecord();_newline      //InvokeMethod(&quot;RefreshBusComp&quot;);_newline     }_newline    }  _newline   }//if_newline   _newline    if (bcOrder1.FirstRecord())_newline    {_newline    with (bcOrderline)_newline    {_newline     ActivateField(&quot;VF Stock Indicator TBUI&quot;);_newline     ClearToQuery();_newline     SetSearchSpec(&quot;Id&quot;,oItem);_newline     ExecuteQuery(ForwardOnly); _newline_newline     if(FirstRecord())_newline     {_newline     SetFieldValue(&quot;VF Stock Indicator TBUI&quot;, sStockIndicator);_newline     WriteRecord();_newline     }_newline_newline    }_newline_newline    }_newline_newline   if(oItem != null) //Set the Default CP Via RCOIS_newline   {_newline    var oInp = TheApplication().NewPropertySet();_newline    var oOut = TheApplication().NewPropertySet();_newline    var  psTemp = TheApplication().NewPropertySet();_newline    var oIO = &quot;7.7 Order Entry Integration Object&quot;;_newline    var sCOIS = TheApplication().GetService(&quot;Remote Complex Object Instance Service&quot;);_newline_newline    var oProdtoAdd = &quot;&quot;;_newline    var gErrText;_newline    var gErrCode;_newline    var sCS = TheApplication().GetService(&quot;ISS Copy Service&quot;);_newline    oInp.SetProperty(&quot;ParentObjectId&quot;, oHead );     _newline    oInp.SetProperty(&quot;IntegrationObjectName&quot;, oIO); _newline    oInp.SetProperty(&quot;RootId&quot;, oItem);              _newline    oInp.SetProperty(&quot;SearchSpec&quot;, &quot;[Header.Id] = &apos;&quot; + oHead + &quot;&apos; AND [Line Item.Root Id] = &apos;&quot; + oItem + &quot;&apos;&quot;); _newline    sCS.InvokeMethod(&quot;LoadEAI&quot;,oInp,oOut);       _newline_newline    //LoadInstance Method:_newline    oInp.SetProperty(&quot;IntObjName&quot;, oIO);          _newline    oInp.SetProperty(&quot;ObjId&quot;,oHead);             _newline    oInp.SetProperty(&quot;RootId&quot;,oItem);            _newline    oInp.SetProperty(&quot;TriggerEvent&quot;,&quot;N&quot;);   _newline    oInp.SetProperty(&quot;ExternalScript&quot;,&quot;Y&quot;);    _newline    oInp.SetProperty(&quot;NewRecord&quot;, &quot;Y&quot;);   _newline    oInp.SetProperty(&quot;AutoSync&quot;,&quot;Y&quot;);    _newline    oInp.SetProperty(&quot;CreateSession&quot;, &quot;Y&quot;);   _newline    oInp.SetProperty(&quot;IsConfig&quot;, &quot;Y&quot;);   _newline    oInp.SetProperty(&quot;Links&quot;, &quot;N&quot;);     _newline    oInp.SetProperty(&quot;UnresolvedLinks&quot;, &quot;Y&quot;);  _newline    //oInp.SetProperty(&quot;Product Id&quot;, oProd);  _newline    sCOIS.InvokeMethod(&quot;LoadInstance&quot;,oInp,oOut);  _newline_newline    if(oOut.GetProperty(&quot;CreateSession&quot;)==&quot;Y&quot;)_newline    {_newline     oInp.SetProperty(&quot;AutoSync&quot;,&quot;Y&quot;);   _newline     sCOIS.InvokeMethod(&quot;CreateSession&quot;,oInp,oOut);_newline    }_newline_newline    //Sync_newline    oOut.SetProperty(&quot;IntObjName&quot;, oIO);         _newline    oOut.SetProperty(&quot;ObjId&quot;,oHead);     _newline    oOut.SetProperty(&quot;RootId&quot;,oItem); _newline    oOut.SetProperty(&quot;TriggerEvent&quot;,&quot;N&quot;); _newline    sCOIS.InvokeMethod(&quot;SyncInstance&quot;,oOut,oOut); _newline_newline    _newline    // UnloadInstance Method:_newline    oOut.SetProperty(&quot;IntObjName&quot;, oIO);         _newline    oOut.SetProperty(&quot;ObjId&quot;,oHead);           _newline    oOut.SetProperty(&quot;RootId&quot;,oItem);           _newline    sCOIS.InvokeMethod(&quot;UnloadInstance&quot;,oOut,oOut);     _newline    oInp.Reset();_newline    oOut.Reset();                               _newline   }_newline   Outputs.SetProperty(&quot;RootOrderId&quot;,oItem);   _newline_newline   _newline _newline   bsInvokeUpLI = TheApplication().GetService(&quot;VF OM New Order Creation&quot;); _newline   psInputOLI.SetProperty(&quot;OrderId&quot;,oHead);_newline   bsInvokeUpLI.InvokeMethod(&quot;UpdateLineNumber&quot;,psInputOLI,psOutputOLI);_newline  }_newline    }_newline catch(e)_newline {_newline  throw e;_newline }_newline finally_newline {_newline  bcPick = null;  _newline  sRootOrderItemId = null_newline  bcOrderLI = null;_newline  bcOrder = null;  _newlinebcOrderline = null;_newline  bsInvokeUpLI = null;  _newline  psInputOLI = null;_newline  psOutputOLI = null;_newline  oInp = null;_newline  oOut = null;_newline  psTemp = null;_newline  sCOIS = null;_newline  sCS = null;_newline  boOrder = null; _newline }_newline}_newline_newline"
 Program_spcLanguage="JS"
 Name="mAddPropFibreOrderManageService"
 Sequence="5"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mAddPropInterimOrder (Inputs, Outputs)_newline{//SATHISH 19/10/2023 this logic will Add line item to Interim order_newline try_newline {_newline var boOrder = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline var bcOrder = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);_newline_newline var bcOrder1 = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);   _newline var bcOrderline = boOrder.GetBusComp(&quot;VF Order Line Item - Light&quot;);_newline_newline var bsInvokeUpLI;_newline var psInputOLI = TheApplication().NewPropertySet();_newline var psOutputOLI = TheApplication().NewPropertySet();_newline  _newline var oHead = Inputs.GetProperty(&quot;OrderId&quot;);_newline var sFibreProdId = Inputs.GetProperty(&quot;Product&quot;);_newline var oType = Inputs.GetProperty(&quot;OrderType&quot;);_newline var oAccountId = Inputs.GetProperty(&quot;AccountId&quot;);_newline var FCInterimOrderFlag = Inputs.GetProperty(&quot;FCInterimOrderFlag&quot;);_newline var FCConnectOrderFlag = Inputs.GetProperty(&quot;FCConnectOrderFlag&quot;);_newline var FCChangeLocFlag = Inputs.GetProperty(&quot;FCChangeLocFlag&quot;);_newlinevar AccessTechnology = Inputs.GetProperty(&quot;AccessTechnology&quot;);  _newlinevar COLAcrossNWFlag = Inputs.GetProperty(&quot;COLAcrossNWFlag&quot;); _newline_newline var sFTTNCPlan = Inputs.GetProperty(&quot;FTTNCPlan&quot;);_newline var sFibrePlan = Inputs.GetProperty(&quot;RatePlanSelected&quot;);_newline var sFTTNCPropId = Inputs.GetProperty(&quot;FTTNCPropId&quot;);_newline //var sExistingCustomer = Inputs.GetProperty(&quot;FCExistingCustFlag&quot;);_newlinevar sInterimOrderId = Inputs.GetProperty(&quot;InterimOrderId&quot;); _newline_newline var sModemSerialNum,sOrderSubTypeTBUI,sConType = &quot;&quot;;_newline var sServicePin = Inputs.GetProperty(&quot;FTTNCServicePin&quot;);_newline var sEsim= TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usSIM_usTYPE&quot;,&quot;eSIM&quot;);_newline var sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;);_newline var sFConOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Connect&quot;);_newline var sFCInterimOrdSubFn = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Interim&quot;);_newlinevar sCOLAcrossNW = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Change Location Across NW&quot;);_newline var sOrderSubTypeTBUIInp = Inputs.GetProperty(&quot;OrderSubTypeTBUIInp&quot;);_newline var sOrderSubTypeTBUI = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,sOrderSubTypeTBUIInp);_newline _newline _newline  _newline  var sStockIndicator = &quot;In Stock&quot;;_newline  var oItem;_newline  var sAccessTechnology = &quot;&quot;;_newline  var oOrganization = &quot;&quot;; _newline  var bcOrderLI;_newline  var bcAllocateIMEI;_newline  var sSiebelProType=&quot;&quot;;_newline_newline  if (oHead != &quot;&quot; &amp;&amp; oHead != null)_newline  {_newline   bcOrder.ActivateField(&quot;Primary Organization&quot;);_newline   bcOrder.SetViewMode(AllView); _newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,oHead);_newline   bcOrder.ExecuteQuery(ForwardOnly); _newline   if (bcOrder.FirstRecord())_newline   {_newline    oOrganization = bcOrder.GetFieldValue(&quot;Primary Organization&quot;);_newline    bcOrderLI = boOrder.GetBusComp(&quot;Order Entry - Line Items&quot;);_newline    bcAllocateIMEI = boOrder.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline    with(bcOrderLI)_newline    {_newline     ActivateField(&quot;Service PIN&quot;);_newline     ActivateField(&quot;eSIM Download&quot;);_newline     ExecuteQuery();_newline     NewRecord(NewAfter);_newline     SetFieldValue(&quot;Product Id&quot;,sFibreProdId);_newline     SetFieldValue(&quot;Cfg Type&quot;,&quot;eConfigurator&quot;);_newline     SetFieldValue(&quot;Access Technology&quot;,&quot;Fibre To The Curb&quot;);_newline     SetFieldValue(&quot;VF Port In TBUI&quot;, &quot;No&quot;);      _newline    // SetFieldValue(&quot;VF Configuration Status&quot;, &quot;Customized&quot;);_newline     SetFieldValue(&quot;VF Service Order Sub Type&quot;, &quot;Connect&quot;);_newline     if (FCInterimOrderFlag == &quot;Y&quot;)_newline     { _newline     SetFieldValue(&quot;VF Order Sub Function&quot;, sFCInterimOrdSubFn);_newline   if (AccessTechnology != &quot;&quot;)_newline   {_newline   SetFieldValue(&quot;Access Technology&quot;,AccessTechnology);_newline   }_newline   else_newline   {_newline   SetFieldValue(&quot;Access Technology&quot;,&quot;Fibre To The Curb&quot;);   _newline   }_newline     }_newline  else if (FCConnectOrderFlag == &quot;Y&quot;)_newline     {_newline  SetFieldValue(&quot;VF Order Sub Function&quot;, sFConOrdSubFunction);_newline  SetFieldValue(&quot;Access Technology&quot;,&quot;Fibre&quot;);_newline_newline     }_newline else if (COLAcrossNWFlag == &quot;Y&quot;)_newline     {_newline  SetFieldValue(&quot;VF Order Sub Function&quot;, sCOLAcrossNW);_newline  SetFieldValue(&quot;Access Technology&quot;,&quot;Fibre&quot;);_newline_newline     }_newline  _newline  if (sOrderSubTypeTBUI != &quot;&quot;)_newline  {_newline   SetFieldValue(&quot;VF Order Sub Type TBUI&quot;, sOrderSubTypeTBUI);_newline }     _newline        _newline     _newline     SetFieldValue(&quot;Billing Account Id&quot;,oAccountId);_newline     //SetFieldValue(&quot;Service PIN&quot;,sServicePin);_newline     WriteRecord();_newline     oItem = GetFieldValue(&quot;Id&quot;);_newlineif (oItem != &quot;&quot; &amp;&amp; COLAcrossNWFlag == &quot;Y&quot;);_newline{_newlineInputs.SetProperty(&quot;Order Id&quot;,oHead);_newlinemUpdateStartDate(Inputs,Outputs);_newline}_newline_newline_newline  ClearToQuery();_newline  ActivateField(&quot;VF Root Siebel Product Type&quot;);_newline  ActivateField(&quot;VF Order Sub Type TBUI&quot;);_newline  ActivateField(&quot;VF ConnectionType&quot;);_newline  SetSearchSpec(&quot;Id&quot;,oItem);_newline  ExecuteQuery(ForwardOnly); _newline  _newline  if(FirstRecord())_newline  {_newline  sSiebelProType = GetFieldValue(&quot;VF Root Siebel Product Type&quot;);_newline  sOrderSubTypeTBUI = GetFieldValue(&quot;VF Order Sub Type TBUI&quot;);_newline_newline                _newline//throw sInterimOrderId;  _newline_newlineif(sInterimOrderId != &quot;&quot;)_newline{    _newlinevar psInput3 = TheApplication().NewPropertySet();_newline                var psOutput3 = TheApplication().NewPropertySet();_newline                var svc1 = TheApplication().GetService(&quot;VF OM New Resource Creation&quot;);_newline                psInput3.SetProperty(&quot;Order Id&quot;, sInterimOrderId);_newline                //psInput3.SetProperty(&quot;Root Line Item Id&quot;, oItem);_newline                svc1.InvokeMethod(&quot;GetIMEIAssociatedToOrder&quot;, psInput3, psOutput3);_newline                var sModemAllcoated =  psOutput3.GetProperty(&quot;IMEI&quot;);_newline//throw sModemAllcoated;_newline}_newline   _newline _newline_newline  if (sSiebelProType == sNBNwithMBB)_newline  {_newline  SetFieldValue(&quot;VF ConnectionType&quot;,&quot;Plan and Device&quot;);_newline  Outputs.SetProperty(&quot;SiebelProdType&quot;,sSiebelProType); _newline  Outputs.SetProperty(&quot;FCConnectionType&quot;,&quot;Plan and Device&quot;); _newline  _newline_newline  }_newline  if (sSiebelProType == sNBNOnly)_newline  {_newline  SetFieldValue(&quot;VF ConnectionType&quot;,&quot;SIM Only&quot;);_newline  Outputs.SetProperty(&quot;SiebelProdType&quot;,sSiebelProType); _newline  Outputs.SetProperty(&quot;FCConnectionType&quot;,&quot;SIM Only&quot;); _newline  _newline_newline  }_newlineif(sModemAllcoated != &quot;&quot;)_newline{_newlineOutputs.SetProperty(&quot;SiebelProdType&quot;,sNBNwithMBB); _newlineOutputs.SetProperty(&quot;FCConnectionType&quot;,&quot;Plan and Device&quot;); _newline_newline}_newline  if (sModemSerialNum != &quot;&quot; &amp;&amp; sModemSerialNum != null)_newline  {_newline  SetFieldValue(&quot;VF IMEI TBUI&quot;,sModemSerialNum); _newline  }_newline_newline  //SetFieldValue(&quot;VF Stock Indicator TBUI&quot;, sStockIndicator);_newline  WriteRecord();_newline  _newline_newline  }_newline   _newline  }_newline_newline }_newline_newline }_newline_newline if (oHead != &quot;&quot; &amp;&amp; oHead != null &amp;&amp; oItem != &quot;&quot;)_newline {_newline  bcOrder1.ActivateField(&quot;Primary Organization&quot;);_newline  bcOrder1.SetViewMode(AllView); _newline  bcOrder1.ClearToQuery();_newline  bcOrder1.SetSearchSpec(&quot;Id&quot;,oHead);_newline  bcOrder1.ExecuteQuery(ForwardOnly); _newline _newline  _newline  if (bcOrder1.FirstRecord())_newline  {_newline  with (bcOrderline)_newline  {_newline  ActivateField(&quot;VF Stock Indicator TBUI&quot;);_newline  ClearToQuery();_newline  SetSearchSpec(&quot;Id&quot;,oItem);_newline  ExecuteQuery(ForwardOnly); _newline  _newline  if(FirstRecord())_newline  {_newline  SetFieldValue(&quot;VF Stock Indicator TBUI&quot;, sStockIndicator);_newline  WriteRecord();  _newline _newline  }_newline _newline  }_newline _newline  }_newline  _newline _newline }_newline _newline if(oItem != null) //Set the Default CP Via RCOIS_newline   {_newline    var oInp = TheApplication().NewPropertySet();_newline    var oOut = TheApplication().NewPropertySet();_newline    var  psTemp = TheApplication().NewPropertySet();_newline    var oIO = &quot;7.7 Order Entry Integration Object&quot;;_newline    var sCOIS = TheApplication().GetService(&quot;Remote Complex Object Instance Service&quot;);_newline_newline    var oProdtoAdd = &quot;&quot;;_newline    var gErrText;_newline    var gErrCode;_newline    var sCS = TheApplication().GetService(&quot;ISS Copy Service&quot;);_newline    oInp.SetProperty(&quot;ParentObjectId&quot;, oHead );     _newline    oInp.SetProperty(&quot;IntegrationObjectName&quot;, oIO); _newline    oInp.SetProperty(&quot;RootId&quot;, oItem);              _newline    oInp.SetProperty(&quot;SearchSpec&quot;, &quot;[Header.Id] = &apos;&quot; + oHead + &quot;&apos; AND [Line Item.Root Id] = &apos;&quot; + oItem + &quot;&apos;&quot;); _newline   sCS.InvokeMethod(&quot;LoadEAI&quot;,oInp,oOut);       _newline_newline    //LoadInstance Method:_newline    oInp.SetProperty(&quot;IntObjName&quot;, oIO);          _newline    oInp.SetProperty(&quot;ObjId&quot;,oHead);             _newline    oInp.SetProperty(&quot;RootId&quot;,oItem);            _newline    oInp.SetProperty(&quot;TriggerEvent&quot;,&quot;N&quot;);   _newline    oInp.SetProperty(&quot;ExternalScript&quot;,&quot;Y&quot;);    _newline    oInp.SetProperty(&quot;NewRecord&quot;, &quot;Y&quot;);   _newline    oInp.SetProperty(&quot;AutoSync&quot;,&quot;Y&quot;);    _newline    oInp.SetProperty(&quot;CreateSession&quot;, &quot;Y&quot;);   _newline    oInp.SetProperty(&quot;IsConfig&quot;, &quot;Y&quot;);   _newline    oInp.SetProperty(&quot;Links&quot;, &quot;Y&quot;);     _newline    oInp.SetProperty(&quot;UnresolvedLinks&quot;, &quot;Y&quot;);  _newline    //oInp.SetProperty(&quot;Product Id&quot;, oProd);  _newline   sCOIS.InvokeMethod(&quot;LoadInstance&quot;,oInp,oOut);  _newline_newline    if(oOut.GetProperty(&quot;CreateSession&quot;)==&quot;Y&quot;)_newline    {_newline     oInp.SetProperty(&quot;AutoSync&quot;,&quot;Y&quot;);   _newline    sCOIS.InvokeMethod(&quot;CreateSession&quot;,oInp,oOut);_newline    }_newline_newline    //Sync_newline    oOut.SetProperty(&quot;IntObjName&quot;, oIO);         _newline    oOut.SetProperty(&quot;ObjId&quot;,oHead);     _newline    oOut.SetProperty(&quot;RootId&quot;,oItem); _newline    oOut.SetProperty(&quot;TriggerEvent&quot;,&quot;N&quot;); _newline    sCOIS.InvokeMethod(&quot;SyncInstance&quot;,oOut,oOut); _newline_newline//resolve conflict_newline    oOut.SetProperty(&quot;RootId&quot;, oItem);         _newline    oOut.SetProperty(&quot;ObjId&quot;,oHead);    _newline   // sCOIS.InvokeMethod(&quot;RemoveFailedRequests&quot;,oOut,oOut); _newline_newline    _newline    // UnloadInstance Method:_newline    oOut.SetProperty(&quot;IntObjName&quot;, oIO);         _newline    oOut.SetProperty(&quot;ObjId&quot;,oHead);           _newline    oOut.SetProperty(&quot;RootId&quot;,oItem);           _newline  //  sCOIS.InvokeMethod(&quot;UnloadInstance&quot;,oOut,oOut);     _newline    oInp.Reset();_newline    oOut.Reset();                               _newline   }_newline_newline Outputs.SetProperty(&quot;RootOrderId&quot;,oItem); _newline Outputs.SetProperty(&quot;FCOrderSubTypeTBUI&quot;,sOrderSubTypeTBUI);   _newline_newline   bsInvokeUpLI = TheApplication().GetService(&quot;VF OM New Order Creation&quot;); _newline   psInputOLI.SetProperty(&quot;OrderId&quot;,oHead);_newline   bsInvokeUpLI.InvokeMethod(&quot;UpdateLineNumber&quot;,psInputOLI,psOutputOLI);_newline  _newline    }_newline catch(e)_newline {_newline  throw e;_newline }_newline finally_newline {_newline  bcOrderLI = null;_newline  bcOrder = null;_newline  bcOrderline = null;_newline  bsInvokeUpLI = null;  _newline  psInputOLI = null;_newline  psOutputOLI = null;_newline  oInp = null;_newline  oOut = null;_newline  psTemp = null;_newline  sCOIS = null;_newline  sCS = null;_newline  boOrder = null; _newline_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mAddPropInterimOrder"
 Sequence="6"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mAutoAllocateSIM(Inputs,Outputs)_newline{_newline//Sathish - Created for Fibre Connect Drop 2._newlinetry{_newline _newline    var sorderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline    var sRootlineId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline    var sMSISDN = &quot;&quot;;_newline    _newline    var svc = TheApplication().GetService(&quot;VHA ATOM eSIM Processing Service&quot;);_newline    var input = TheApplication().NewPropertySet();_newline    var output = TheApplication().NewPropertySet();_newline    input.SetProperty(&quot;Seed&quot;, sRootlineId);_newline    svc.InvokeMethod(&quot;GenerateRandomCode&quot;, input, output);_newline    var sCCode = output.GetProperty(&quot;Code&quot;);_newline    _newline    _newline    //Generate Confirmation Code and set_newline    var psInputs,psOutputs,bsInvokeWorkflow,sConfirmationCode;_newline             psInputs = TheApplication().NewPropertySet();_newline    psOutputs = TheApplication().NewPropertySet();_newline    psInputs.SetProperty(&quot;ConfirmationCode&quot;,sCCode);_newline    psInputs.SetProperty(&quot;OrderId&quot;,sorderId);_newline    psInputs.SetProperty(&quot;SerOrderId&quot;,sRootlineId);_newline    mSetConfirmationCode(psInputs,psOutputs)_newline    sMSISDN = psOutputs.GetProperty(&quot;NewMSISDN&quot;);_newline    _newline    _newline    psInputs.SetProperty(&quot;ProcessName&quot;, &quot;VHA Manage eSIM Process&quot;);_newline    psInputs.SetProperty(&quot;Object Id&quot;, sRootlineId);_newline    psInputs.SetProperty(&quot;RequestId&quot;, sRootlineId);_newline    psInputs.SetProperty(&quot;Order Id&quot;, sorderId);_newline    psInputs.SetProperty(&quot;OrderSubType&quot;, &quot;Connect&quot;);_newline    psInputs.SetProperty(&quot;Confirmation Code&quot;,sConfirmationCode);_newline    psInputs.SetProperty(&quot;MSISDN&quot;,sMSISDN);_newline    psInputs.SetProperty(&quot;Action Code&quot;, &quot;Allocate&quot;);_newline    bsInvokeWorkflow = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline    bsInvokeWorkflow.InvokeMethod(&quot;RunProcess&quot;, psInputs, psOutputs); _newline_newline_newline}_newlinecatch(e)_newline{_newlinethrow(e); _newline}_newlinefinally_newline{_newline _newline}_newline}_newline"
 Program_spcLanguage="JS"
 Name="mAutoAllocateSIM"
 Sequence="7"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCLUpdateCVCId(Inputs,Outputs)_newline{_newline//Sathish - 27-02-24 Created for Fibre Connect_newline try_newline {_newline var sOrderId,sRootOrderItemId,sCVCId =&quot;&quot;;  _newline sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline sRootOrderItemId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline  var bcSiteQualification = boOrder.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline    _newline   if(sOrderId != &quot;&quot; )_newline   {_newline_newline bcOrder.SetViewMode(AllView);_newline bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline bcSiteQualification.ActivateField(&quot;Selected CVC&quot;);_newline bcOrder.ClearToQuery();_newline bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline // bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;,sRootOrderItemId);_newline bcOrderItem.SetSearchSpec(&quot;Action Code&quot;,&quot;&lt;&gt;Delete&quot;);_newline bcSiteQualification.SetSearchSpec(&quot;Order Header Id&quot;,sOrderId);_newline bcOrderItem.SetSearchSpec(&quot;Service Type&quot;,&quot;NBN&quot;);_newline bcOrderItem.SetSearchSpec(&quot;Product Sub Type Code&quot;,&quot;Service Specification&quot;);_newline bcOrderItemXA.SetSearchSpec(&quot;Name&quot;,&quot;CVC Id&quot;);_newline bcOrder.ExecuteQuery(ForwardOnly);_newline_newline    if (bcSiteQualification.FirstRecord())_newline    {_newline    sCVCId = bcSiteQualification.GetFieldValue(&quot;Selected CVC&quot;);_newline    }_newline    else_newline    {_newline    // sCVCId = &quot;CVC000000111111&quot;;_newline    }_newline_newline if(bcOrderItem.FirstRecord() &amp;&amp; bcOrderItemXA.FirstRecord() &amp;&amp; sCVCId!= &quot;&quot;)_newline { _newline_newline  if (bcOrderItemXA.GetFieldValue(&quot;Value&quot;) == &quot;&quot;)_newline  {_newline  bcOrderItemXA.SetFieldValue(&quot;Value&quot;,sCVCId);_newline  bcOrderItemXA.WriteRecord();_newline_newline  }_newline }_newline if(bcOrderItem.FirstRecord() &amp;&amp; bcOrderItemXA.FirstRecord() &amp;&amp; sCVCId== &quot;&quot;)_newline { _newline   _newline if (bcOrderItemXA.GetFieldValue(&quot;Value&quot;) == &quot;&quot;)_newline  {_newline  bcOrderItemXA.SetFieldValue(&quot;Value&quot;,&quot;CVC000000111111&quot;);_newline  bcOrderItemXA.WriteRecord();_newline_newline  }_newline }_newline_newline_newline_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  bcOrderItem = null;_newline  bcOrderItemXA = null;_newline  boOrder = null;_newline }_newline}_newline_newline"
 Program_spcLanguage="JS"
 Name="mCLUpdateCVCId"
 Sequence="10"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCOTCaptureModemInfo(Inputs,Outputs)_newline{_newline//Sathish : Added for Imagine Consumer  10/10/2024_newlinetry{  _newline _newline  var sACSProvFlag =&quot;&quot;; _newline  var sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline  var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;); _newline  var sModemOUI = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ModemOUIDefault&quot;);_newline  var sProductClass = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ProductClassDefault&quot;); _newline  var sEnableSKUCodeFix = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VF_usCR_usENABLE_usFLAG&quot;,&quot;EnableSKUCodeFix&quot;);_newline  var sFConOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Connect&quot;);_newline  var sFDisconOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Disconnect&quot;);_newline  var sEnableACSUpdate = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VF_usFIB_usCON_usSWITCH&quot;,&quot;EnableACSUpdate&quot;);_newline  var sFCChangeProp = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Change Proposition&quot;);_newline  var sFCChangeTech = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Change Technology&quot;);_newline  var sFCRPC = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Rate Plan Change&quot;);_newline  _newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sServiceOrderId = Inputs.GetProperty(&quot;ServOrderId&quot;);_newline  var sOrderSubType = Inputs.GetProperty(&quot;OrderSubType&quot;);_newline  var sMSISDN = Inputs.GetProperty(&quot;MSISDN&quot;);_newline  var sOrderSubFunction = Inputs.GetProperty(&quot;OrderSubFunction&quot;);_newline  var sOrderSubTypeTBUI = Inputs.GetProperty(&quot;OrderSubTypeTBUI&quot;);_newline  var sBYOCalc = Inputs.GetProperty(&quot;BYOCalc&quot;);_newline  var sSieblProdType = Inputs.GetProperty(&quot;SieblProdType&quot;);_newline  var sCustAssetIntegId = Inputs.GetProperty(&quot;CustAssetIntegId&quot;);_newline  var sCSAId = Inputs.GetProperty(&quot;CSAId&quot;);_newline  var sNewMSISDN = Inputs.GetProperty(&quot;NewMSISDN&quot;);_newline  var sIMEIAllocated = Inputs.GetProperty(&quot;IMEIAllocated&quot;);_newline  var sDeviceAdded = Inputs.GetProperty(&quot;ModemAdded&quot;);_newline  var sNBNOrdModemNum = Inputs.GetProperty(&quot;NBNOrdModemNum&quot;);_newline  var sNetworkIdentifier = Inputs.GetProperty(&quot;NetworkIdentifier&quot;);_newline  var sSQSelectedCVC = Inputs.GetProperty(&quot;SQSelectedCVC&quot;);_newline  var sOrgName = Inputs.GetProperty(&quot;OrgName&quot;);_newline  var sStockIndTBUI = Inputs.GetProperty(&quot;StockIndTBUI&quot;);_newline   _newline  var sNewSpeed = &quot;&quot;;_newline  var sSpeedChangeFlag = &quot;N&quot;;_newline  var sPOIValue = &quot;&quot;;_newline  var sSKUModem = &quot;&quot;;_newlinevar sDeleteModemInfoFlag=&quot;&quot;;_newlinevar sModemInfoFound=&quot;&quot;;_newline_newline    _newline_newline  _newline  var sBOModem = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline  var bcNBNModem = sBOModem.GetBusComp(&quot;VHA NBN Order Modem Details&quot;);_newline_newline  bcNBNModem.SetViewMode(AllView);_newline  bcNBNModem.ClearToQuery();_newline  bcNBNModem.ActivateField(&quot;Order Id&quot;);_newline  bcNBNModem.ActivateField(&quot;Service Order Id&quot;);_newline bcNBNModem.ActivateField(&quot;ACS Provisioning Flag&quot;);_newline  bcNBNModem.SetSearchSpec(&quot;Order Id&quot;,sOrderId);_newline  bcNBNModem.SetSearchSpec(&quot;Service Order Id&quot;,sServiceOrderId); _newline // bcNBNModem.SetSearchSpec(&quot;ACS Provisioning Flag&quot;,&quot;N&quot;);  _newline  bcNBNModem.ExecuteQuery(ForwardOnly);_newline   if (bcNBNModem.FirstRecord() &amp;&amp; bcNBNModem.GetFieldValue(&quot;ACS Provisioning Flag&quot;) == &quot;N&quot; &amp;&amp; sDeleteModemInfoFlag==&quot;&quot;)_newline   {_newline   bcNBNModem.DeleteRecord();_newline   bcNBNModem.WriteRecord();   _newline   sDeleteModemInfoFlag = &quot;Y&quot;;_newline   }_newline         else if (bcNBNModem.FirstRecord() &amp;&amp; bcNBNModem.GetFieldValue(&quot;ACS Provisioning Flag&quot;) == &quot;Y&quot;)_newline   {_newline   //Modem Info Already available ,below section can be skipped._newline           sModemInfoFound= &quot;Y&quot;;_newline   }_newline  _newline     if(!bcNBNModem.FirstRecord() &amp;&amp; sModemInfoFound != &quot;Y&quot;)_newline     {_newline_newline      //To get latest service provider reference below logic added_newline      mGetServiceProviderRef(sOrderId,sServiceOrderId,Outputs);_newline      var sNewServiceProvRef = Outputs.GetProperty(&quot;ServProvRef&quot;);_newline      var sSpecialSiebelType = Outputs.GetProperty(&quot;SpecialSiebelType&quot;); //Ravindra:12/07/2024: Added for SMB Phase2_newline_newline_newline      if (sCSAId != &quot;&quot; &amp;&amp; sCSAId != null)_newline      {_newline      var psInputs3 = TheApplication().NewPropertySet();_newline      var psOutputs3 = TheApplication().NewPropertySet();_newline      psInputs3.SetProperty(&quot;CSAId&quot;,sCSAId)_newline      mGetPOIIdentifier(psInputs3,psOutputs3);_newline      sPOIValue = psOutputs3.GetProperty(&quot;POIValue&quot;); _newline           _newline      }_newline      _newline      _newline      _newline      if (sOrderSubType != &quot;Connect&quot; &amp;&amp; ((sMSISDN != &quot;&quot; &amp;&amp; sMSISDN != null ) || (sNewMSISDN != &quot;&quot; &amp;&amp; sNewMSISDN != null)))_newline      {_newline_newline       var svc = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline       var psInputs2 = TheApplication().NewPropertySet();_newline       var psOutputs2 = TheApplication().NewPropertySet();_newline_newline       if (sMSISDN != &quot;&quot; &amp;&amp; sMSISDN != null)_newline       psInputs2.SetProperty(&quot;MSISDN&quot;, sMSISDN);_newline_newline       if (sNewMSISDN != &quot;&quot; &amp;&amp; sNewMSISDN != null)_newline       psInputs2.SetProperty(&quot;MSISDN&quot;, sNewMSISDN);_newline_newline       psInputs2.SetProperty(&quot;OrderSubType&quot;, sOrderSubType);_newline       psInputs2.SetProperty(&quot;ProcessName&quot;, &quot;VHA Retrieve ACS related fields&quot;);_newline      svc.InvokeMethod(&quot;RunProcess&quot;, psInputs2, psOutputs2);_newline_newline_newline      } _newline     _newline            _newline  if (sNewServiceProvRef == &quot;VHA&quot;)_newline  {_newline  sACSProvFlag = &quot;N&quot;; _newline_newline  }_newline_newline  else if (sOrgName == &quot;Kogan&quot;)_newline  {_newline  sACSProvFlag = &quot;N&quot;; _newline_newline  }_newline  else if (sOrderSubType == &quot;Connect&quot; &amp;&amp; (sDeviceAdded != &quot;&quot; &amp;&amp; sStockIndTBUI ==&quot;Out of Stock - Connect Later&quot;)|| sIMEIAllocated !=&quot;&quot;|| sNBNOrdModemNum != &quot;&quot; &amp;&amp; sOrderSubFunction ==&quot;&quot; &amp;&amp; sOrgName != &quot;Kogan&quot;)_newline  {_newline_newline  sACSProvFlag = &quot;Y&quot;; _newline_newline  }_newline  else if (sOrderSubType == &quot;Connect&quot; &amp;&amp; (sIMEIAllocated == &quot;&quot; &amp;&amp; sDeviceAdded == &quot;&quot; &amp;&amp; sNBNOrdModemNum ==&quot;&quot;) &amp;&amp; sOrderSubFunction ==&quot;&quot;)_newline  {_newline_newline  sACSProvFlag = &quot;N&quot;; _newline_newline  }_newline   else if ((sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; ) &amp;&amp; sOrderSubFunction == &quot;Change Location Connect&quot; &amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;Y&quot;;  _newline      _newline      }_newline      else if ((sOrderSubType == &quot;Disconnect&quot; ) &amp;&amp; sOrderSubFunction == &quot;Change Technology Across NW&quot; &amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;Y&quot;;  _newline      _newline      }_newline else if ((sOrderSubType == &quot;Disconnect&quot; || sOrderSubType == &quot;Reactivate&quot;)&amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline {_newline_newline sACSProvFlag = &quot;Y&quot;;      _newline }_newline      else if ((sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; || sOrderSubType == &quot;Change Ownership Connect&quot;)&amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline      {_newline            _newline      Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      Inputs.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline      Inputs.SetProperty(&quot;OrderSubFunction&quot;,sOrderSubFunction);_newline      Inputs.SetProperty(&quot;CustAssetIntegId&quot;,sCustAssetIntegId);_newline      Inputs.SetProperty(&quot;OrderSubType&quot;,sOrderSubType);_newline      Inputs.SetProperty(&quot;OldNBNSpeed&quot;, psOutputs2.GetProperty(&quot;NBNSpeed&quot;)); _newline      mInvokeSpeedCheckAllOrder(Inputs,Outputs);_newline      //mInvokeSpeedCheck(Inputs,Outputs); _newline      sNewSpeed = Outputs.GetProperty(&quot;NBNSpeed&quot;);_newline      sSpeedChangeFlag = Outputs.GetProperty(&quot;SpeedChangeFlag&quot;);_newline       if (sSpeedChangeFlag  == &quot;Y&quot;)_newline       {_newline        sACSProvFlag = &quot;Y&quot;; _newline       }_newline   _newline      }              _newline      else_newline      {_newline      sACSProvFlag = &quot;N&quot;; _newline      }_newline_newlinevar sEnableTPLINKARC = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usCR_usENABLE_usFLAG&quot;, &quot;ENABLE_usTPLINKARC&quot;);_newlineif(sEnableTPLINKARC==&quot;Y&quot;)_newline{_newlinesACSProvFlag = mInvokeTPLinkACS (Inputs,Outputs,sOrderSubType,sServiceOrderId,psOutputs2,sACSProvFlag)_newline_newline}_newlinevar sEnableARC = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usCR_usENABLE_usFLAG&quot;, &quot;ENABLE_usARCADYAN&quot;);_newlineif(sEnableARC==&quot;Y&quot;)_newline{_newlinesACSProvFlag = mInvokeArcadyanACS (Inputs,Outputs,sOrderSubType,sServiceOrderId,psOutputs2,sACSProvFlag)_newline_newline}_newline_newline_newline     if (sACSProvFlag == &quot;Y&quot;)_newline      {_newline_newline      Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      Inputs.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline       if (sOrderSubFunction == sFDisconOrdSubFunction &amp;&amp; sOrderSubFunction != &quot;&quot;)_newline       {_newline       var psInputs3 = TheApplication().NewPropertySet();_newline       var psOutputs3 = TheApplication().NewPropertySet();_newline       psInputs3.SetProperty(&quot;OrderId&quot;,sOrderId);_newline       psInputs3.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline       psInputs3.SetProperty(&quot;NBNProvisionFlag&quot;,&quot;Y&quot;);_newline       fnUpsertNBNDetails(psInputs3,psOutputs3);        _newline       }_newline      _newline      bcNBNModem.NewRecord(NewAfter);_newline      bcNBNModem.SetFieldValue(&quot;Order Id&quot;,sOrderId);_newline      bcNBNModem.SetFieldValue(&quot;Service Order Id&quot;, sServiceOrderId);_newline      bcNBNModem.SetFieldValue(&quot;ACS Provisioning Flag&quot;,&quot;Y&quot;);_newline      bcNBNModem.SetFieldValue(&quot;POI Value&quot;,sPOIValue);_newline      //bcNBNModem.SetFieldValue(&quot;PPPOE User Name&quot;,&quot;AVC19@vodafone.com.au&quot;);_newline      if (sEnableSKUCodeFix == &quot;N&quot;)_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Product Class&quot;,sProductClass);_newline      bcNBNModem.SetFieldValue(&quot;OUI&quot;,sModemOUI);_newline      }_newline      _newline      if (sOrderSubType == &quot;Connect&quot;)_newline      {_newline      Inputs.SetProperty(&quot;InpSpecialSiebelType&quot;,sSpecialSiebelType); //Ravindra:12/07/2024: Added for SMB Phase2_newline      fnGetModemDetails(Inputs,Outputs);_newline      mQueryOrderdetails(Inputs,Outputs);_newline_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = Outputs.GetProperty(&quot;ModemSKU&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       }_newline_newline      bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,Outputs.GetProperty(&quot;ModemNo&quot;));_newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline      bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,Outputs.GetProperty(&quot;NBNAcessTech1&quot;));_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,Outputs.GetProperty(&quot;StateValue&quot;));_newline      }_newline      else if (sOrderSubType == &quot;Reactivate&quot;)_newline      {_newline      //fnGetModemDetails(Inputs,Outputs);_newline       mQueryOrderdetails(Inputs,Outputs);_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       }_newline       bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,psOutputs2.GetProperty(&quot;IMEI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,psOutputs2.GetProperty(&quot;Access Tech&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));_newline      }_newline      else if ((sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; ) &amp;&amp; sOrderSubFunction == &quot;Change Location Connect&quot;)_newline      {_newline       bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,psOutputs2.GetProperty(&quot;IMEI&quot;));_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       } _newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,psOutputs2.GetProperty(&quot;NBNSpeed&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,psOutputs2.GetProperty(&quot;Access Tech&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));   _newline      _newline      }_newline      else{_newline       bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,psOutputs2.GetProperty(&quot;IMEI&quot;));_newline       if (sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; || sOrderSubType == &quot;Change Ownership Connect&quot;)_newline       {_newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,sNewSpeed);_newline       }_newline       else_newline       {_newline_newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,psOutputs2.GetProperty(&quot;NBNSpeed&quot;));_newline       }_newline       bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,psOutputs2.GetProperty(&quot;Access Tech&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       } _newline       _newline      } _newline      _newline          _newline      bcNBNModem.WriteRecord();_newline      }_newline      else_newline      {_newline_newline       _newline      Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      Inputs.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline      fnGetModemDetails(Inputs,Outputs);_newline      mQueryOrderdetails(Inputs,Outputs);_newline_newline       if (sOrderSubFunction == sFDisconOrdSubFunction &amp;&amp; sOrderSubFunction != &quot;&quot;)_newline       {_newline       var psInputs3 = TheApplication().NewPropertySet();_newline       var psOutputs3 = TheApplication().NewPropertySet();_newline       psInputs3.SetProperty(&quot;OrderId&quot;,sOrderId);_newline       psInputs3.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline       psInputs3.SetProperty(&quot;NBNProvisionFlag&quot;,&quot;Y&quot;);_newline       fnUpsertNBNDetails(psInputs3,psOutputs3);        _newline       }_newline_newline_newline      bcNBNModem.NewRecord(NewAfter);_newline      bcNBNModem.SetFieldValue(&quot;Order Id&quot;,sOrderId);_newline      bcNBNModem.SetFieldValue(&quot;Service Order Id&quot;, sServiceOrderId);_newline      bcNBNModem.SetFieldValue(&quot;ACS Provisioning Flag&quot;,&quot;N&quot;);_newline      if (sOrderSubType == &quot;Connect&quot;)_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,Outputs.GetProperty(&quot;StateValue&quot;));_newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline      }_newline      else if (sOrderSubType == &quot;Reactivate&quot; || sOrderSubType == &quot;Decon/Con Transfer TO&quot;)_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));_newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline      }_newline      else_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;)); _newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,psOutputs2.GetProperty(&quot;NBNSpeed&quot;));_newline      }_newline      bcNBNModem.WriteRecord();_newline      }_newline_newline      _newline      _newline    }_newline }_newlinecatch (e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newlinebcNBNModem = null;_newlinesBOModem = null;_newline_newline} _newline     _newline}_newline"
 Program_spcLanguage="JS"
 Name="mCOTCaptureModemInfo"
 Sequence="11"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCaptureModemInfo(Inputs,Outputs)_newline{_newline//Sathish : Added for NBN Rationalization 17-Sep-2021_newlinetry{  _newline _newline  var sACSProvFlag =&quot;&quot;; _newline  var sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline  var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;); _newline  var sModemOUI = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ModemOUIDefault&quot;);_newline  var sProductClass = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ProductClassDefault&quot;); _newline  var sEnableSKUCodeFix = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VF_usCR_usENABLE_usFLAG&quot;,&quot;EnableSKUCodeFix&quot;);_newline  var sFConOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Connect&quot;);_newline  var sFDisconOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Disconnect&quot;);_newline  var sEnableACSUpdate = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VF_usFIB_usCON_usSWITCH&quot;,&quot;EnableACSUpdate&quot;);_newline  var sFCChangeProp = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Change Proposition&quot;);_newline  var sFCChangeTech = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Change Technology&quot;);_newline  var sFCRPC = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Rate Plan Change&quot;);_newline  _newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sServiceOrderId = Inputs.GetProperty(&quot;ServOrderId&quot;);_newline  var sOrderSubType = Inputs.GetProperty(&quot;OrderSubType&quot;);_newline  var sMSISDN = Inputs.GetProperty(&quot;MSISDN&quot;);_newline  var sOrderSubFunction = Inputs.GetProperty(&quot;OrderSubFunction&quot;);_newline  var sOrderSubTypeTBUI = Inputs.GetProperty(&quot;OrderSubTypeTBUI&quot;);_newline  var sBYOCalc = Inputs.GetProperty(&quot;BYOCalc&quot;);_newline  var sSieblProdType = Inputs.GetProperty(&quot;SieblProdType&quot;);_newline  var sCustAssetIntegId = Inputs.GetProperty(&quot;CustAssetIntegId&quot;);_newline  var sCSAId = Inputs.GetProperty(&quot;CSAId&quot;);_newline  var sNewMSISDN = Inputs.GetProperty(&quot;NewMSISDN&quot;);_newline  var sIMEIAllocated = Inputs.GetProperty(&quot;IMEIAllocated&quot;);_newline  var sDeviceAdded = Inputs.GetProperty(&quot;ModemAdded&quot;);_newline  var sNBNOrdModemNum = Inputs.GetProperty(&quot;NBNOrdModemNum&quot;);_newline  var sNetworkIdentifier = Inputs.GetProperty(&quot;NetworkIdentifier&quot;);_newline  var sSQSelectedCVC = Inputs.GetProperty(&quot;SQSelectedCVC&quot;);_newline  var sOrgName = Inputs.GetProperty(&quot;OrgName&quot;);_newline  var sStockIndTBUI = Inputs.GetProperty(&quot;StockIndTBUI&quot;);_newline   _newline  var sNewSpeed = &quot;&quot;;_newline  var sSpeedChangeFlag = &quot;N&quot;;_newline  var sPOIValue = &quot;&quot;;_newline  var sSKUModem = &quot;&quot;;_newlinevar sProductCode =&quot;&quot;;_newline  _newline  var sBOModem = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline  var bcNBNModem = sBOModem.GetBusComp(&quot;VHA NBN Order Modem Details&quot;); _newline  bcNBNModem.SetViewMode(AllView);_newline  bcNBNModem.ClearToQuery();_newline  bcNBNModem.ActivateField(&quot;Order Id&quot;);_newline  bcNBNModem.ActivateField(&quot;Service Order Id&quot;);_newline  bcNBNModem.SetSearchSpec(&quot;Order Id&quot;,sOrderId);_newline  bcNBNModem.SetSearchSpec(&quot;Service Order Id&quot;,sServiceOrderId);   _newline  bcNBNModem.ExecuteQuery(ForwardOnly);_newline_newline     if(!bcNBNModem.FirstRecord())_newline     {_newline      //To get latest service provider reference below logic added_newline      mGetServiceProviderRef(sOrderId,sServiceOrderId,Outputs);_newline      var sNewServiceProvRef = Outputs.GetProperty(&quot;ServProvRef&quot;);_newline      var sSpecialSiebelType = Outputs.GetProperty(&quot;SpecialSiebelType&quot;); //Ravindra:12/07/2024: Added for SMB Phase2_newline_newline      if (sNewServiceProvRef == &quot;TPG&quot; &amp;&amp; TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VF_usCR_usENABLE_usFLAG&quot;,&quot;RemoveFixedNBNTPG&quot;) == &quot;Y&quot;)_newline      {_newline       mRemoveFixedNBNTPG(sOrderId,sServiceOrderId);_newline      }_newline      if (sCSAId != &quot;&quot; &amp;&amp; sCSAId != null)_newline      {_newline      var psInputs3 = TheApplication().NewPropertySet();_newline      var psOutputs3 = TheApplication().NewPropertySet();_newline      psInputs3.SetProperty(&quot;CSAId&quot;,sCSAId)_newline      mGetPOIIdentifier(psInputs3,psOutputs3);_newline      sPOIValue = psOutputs3.GetProperty(&quot;POIValue&quot;);             _newline      }_newline      if (sNetworkIdentifier != &quot;&quot; &amp;&amp; sOrderSubType != &quot;Change Ownership Connect&quot; &amp;&amp; sSQSelectedCVC != null)_newline      {_newline      var psInputs4 = TheApplication().NewPropertySet();_newline      var psOutputs4 = TheApplication().NewPropertySet();_newline      psInputs4.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      psInputs4.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline      psInputs4.SetProperty(&quot;SQSelectedCVC&quot;,sSQSelectedCVC);_newline      psInputs4.SetProperty(&quot;NetworkIdentifier&quot;,sNetworkIdentifier);      _newline      mUpdateOpticomVisionAttributes(psInputs4,psOutputs4);_newline      _newline      } _newline     _newline      _newline      if (sOrderSubType != &quot;Connect&quot; &amp;&amp; ((sMSISDN != &quot;&quot; &amp;&amp; sMSISDN != null ) || (sNewMSISDN != &quot;&quot; &amp;&amp; sNewMSISDN != null)))_newline      {_newline_newline       var svc = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline       var psInputs2 = TheApplication().NewPropertySet();_newline       var psOutputs2 = TheApplication().NewPropertySet();_newline_newline       if (sMSISDN != &quot;&quot; &amp;&amp; sMSISDN != null)_newline       psInputs2.SetProperty(&quot;MSISDN&quot;, sMSISDN);_newline_newline       if (sNewMSISDN != &quot;&quot; &amp;&amp; sNewMSISDN != null)_newline       psInputs2.SetProperty(&quot;MSISDN&quot;, sNewMSISDN);_newline_newline       psInputs2.SetProperty(&quot;OrderSubType&quot;, sOrderSubType);_newline       psInputs2.SetProperty(&quot;ProcessName&quot;, &quot;VHA Retrieve ACS related fields&quot;);_newline       svc.InvokeMethod(&quot;RunProcess&quot;, psInputs2, psOutputs2);_newline       _newline       _newline      } _newline     _newline      if (sNewServiceProvRef == &quot;VHA&quot;)_newline      {_newline      sACSProvFlag = &quot;N&quot;;      _newline      }_newline      //else if (sNewServiceProvRef == &quot;TPG&quot; &amp;&amp; (sBYOCalc == &quot;Y&quot; || sSieblProdType == sNBNOnly))_newline      /*{_newline        _newline      sACSProvFlag = &quot;N&quot;;     _newline      }*/_newline      else if (sOrgName == &quot;Kogan&quot;)_newline      {_newline      sACSProvFlag = &quot;N&quot;;      _newline      }_newline      else if (sOrderSubType == &quot;Connect&quot; &amp;&amp; (sDeviceAdded != &quot;&quot; &amp;&amp; sStockIndTBUI ==&quot;Out of Stock - Connect Later&quot;)|| sIMEIAllocated !=&quot;&quot;|| sNBNOrdModemNum != &quot;&quot; &amp;&amp; sOrderSubFunction ==&quot;&quot; &amp;&amp; sOrgName != &quot;Kogan&quot;)_newline      {_newline        _newline      sACSProvFlag = &quot;Y&quot;;      _newline      }_newline      else if (sOrderSubType == &quot;Connect&quot; &amp;&amp; (sIMEIAllocated == &quot;&quot; &amp;&amp; sDeviceAdded == &quot;&quot; &amp;&amp; sNBNOrdModemNum ==&quot;&quot;) &amp;&amp; sOrderSubFunction ==&quot;&quot;)_newline      {_newline        _newline      sACSProvFlag = &quot;N&quot;;      _newline      }_newline      else if (sOrderSubFunction == sFConOrdSubFunction &amp;&amp; sEnableACSUpdate==&quot;Y&quot; &amp;&amp; sBYOCalc != &quot;Y&quot; &amp;&amp; sSieblProdType != sNBNOnly &amp;&amp; sOrderSubFunction != &quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;Y&quot;;      _newline      }_newline      else if (sOrderSubFunction == sFConOrdSubFunction &amp;&amp; sEnableACSUpdate==&quot;Y&quot; &amp;&amp; sOrderSubFunction != &quot;&quot; &amp;&amp; sNBNOrdModemNum != &quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;Y&quot;;      _newline      }_newline      else if (sOrderSubFunction == sFConOrdSubFunction &amp;&amp; sEnableACSUpdate==&quot;N&quot; &amp;&amp; sOrderSubFunction !=&quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;N&quot;;      _newline      }_newline      else if (sOrderSubFunction == sFDisconOrdSubFunction &amp;&amp; sOrderSubFunction != &quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;N&quot;;_newline      }_newline      else if (sNewServiceProvRef == &quot;TPG&quot; &amp;&amp; (sOrderSubType == &quot;Connect&quot; || sOrderSubType == &quot;Disconnect&quot; || sOrderSubType == &quot;Reactivate&quot;)_newline      &amp;&amp; sBYOCalc != &quot;Y&quot; &amp;&amp; sSieblProdType != sNBNOnly)_newline      {_newline       _newline      sACSProvFlag = &quot;Y&quot;;      _newline      }_newline      else if ((sNewServiceProvRef == &quot;TPG&quot; || sNewServiceProvRef ==&quot;IINET&quot;) &amp;&amp; (sOrderSubType == &quot;Disconnect&quot; || sOrderSubType == &quot;Reactivate&quot;)&amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline      {_newline       _newline      sACSProvFlag = &quot;Y&quot;;      _newline      }_newline      else if ((sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; ) &amp;&amp; sOrderSubFunction == &quot;Change Location Connect&quot; &amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline      {_newline      sACSProvFlag = &quot;Y&quot;;  _newline      _newline      }_newline      else if ((sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; || sOrderSubType == &quot;Change Ownership Connect&quot;)&amp;&amp; psOutputs2.GetProperty(&quot;IMEI&quot;) != &quot;&quot;)_newline      {_newline            _newline      Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      Inputs.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline      Inputs.SetProperty(&quot;OrderSubFunction&quot;,sOrderSubFunction);_newline      Inputs.SetProperty(&quot;CustAssetIntegId&quot;,sCustAssetIntegId);_newline      Inputs.SetProperty(&quot;OrderSubType&quot;,sOrderSubType);_newline      Inputs.SetProperty(&quot;OldNBNSpeed&quot;, psOutputs2.GetProperty(&quot;NBNSpeed&quot;)); _newline      mInvokeSpeedCheckAllOrder(Inputs,Outputs);_newline      sNewSpeed = Outputs.GetProperty(&quot;NBNSpeed&quot;);_newline      sSpeedChangeFlag = Outputs.GetProperty(&quot;SpeedChangeFlag&quot;);_newline       if (sSpeedChangeFlag  == &quot;Y&quot;)_newline       {_newline        sACSProvFlag = &quot;Y&quot;; _newline       }_newline   _newline      }_newline      else_newline      {_newline      sACSProvFlag = &quot;N&quot;; _newline      }_newlineif (sOrderSubFunction  ==&quot;Change Location Connect&quot;)_newlinesProductCode = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline_newline_newline if(sProductCode != &quot;&quot; || sOrderSubType == &quot;Connect&quot;)_newline{_newlinevar psInputs4 = TheApplication().NewPropertySet();_newlinevar psOutputs4 = TheApplication().NewPropertySet();_newline       psInputs4 .SetProperty(&quot;ProductCode &quot;,sProductCode );_newline       psInputs4 .SetProperty(&quot;ACSProvFlag&quot;,sACSProvFlag);_newline       psInputs4 .SetProperty(&quot;OrderSubType&quot;,sOrderSubType);_newline psInputs4 .SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline_newline   sACSProvFlag = mCheckTPLinkArcadyan(psInputs4,psOutputs4 );_newline}_newline_newline      _newline      if (sACSProvFlag == &quot;Y&quot;)_newline      {_newline_newline      Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      Inputs.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline       if (sOrderSubFunction == sFDisconOrdSubFunction &amp;&amp; sOrderSubFunction != &quot;&quot;)_newline       {_newline       var psInputs3 = TheApplication().NewPropertySet();_newline       var psOutputs3 = TheApplication().NewPropertySet();_newline       psInputs3.SetProperty(&quot;OrderId&quot;,sOrderId);_newline       psInputs3.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline       psInputs3.SetProperty(&quot;NBNProvisionFlag&quot;,&quot;Y&quot;);_newline       fnUpsertNBNDetails(psInputs3,psOutputs3);        _newline       }_newline      _newline      bcNBNModem.NewRecord(NewAfter);_newline      bcNBNModem.SetFieldValue(&quot;Order Id&quot;,sOrderId);_newline      bcNBNModem.SetFieldValue(&quot;Service Order Id&quot;, sServiceOrderId);_newline      bcNBNModem.SetFieldValue(&quot;ACS Provisioning Flag&quot;,&quot;Y&quot;);_newline      bcNBNModem.SetFieldValue(&quot;POI Value&quot;,sPOIValue);_newline      //bcNBNModem.SetFieldValue(&quot;PPPOE User Name&quot;,&quot;AVC19@vodafone.com.au&quot;);_newline      if (sEnableSKUCodeFix == &quot;N&quot;)_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Product Class&quot;,sProductClass);_newline      bcNBNModem.SetFieldValue(&quot;OUI&quot;,sModemOUI);_newline      }_newline      _newline      if (sOrderSubType == &quot;Connect&quot;)_newline      {_newline      Inputs.SetProperty(&quot;InpSpecialSiebelType&quot;,sSpecialSiebelType);_newline      fnGetModemDetails(Inputs,Outputs);_newline      mQueryOrderdetails(Inputs,Outputs);_newline_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = Outputs.GetProperty(&quot;ModemSKU&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       }_newline_newline      bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,Outputs.GetProperty(&quot;ModemNo&quot;));_newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline      bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,Outputs.GetProperty(&quot;NBNAcessTech1&quot;));_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,Outputs.GetProperty(&quot;StateValue&quot;));_newline      }_newline      else if (sOrderSubType == &quot;Reactivate&quot;)_newline      {_newline       mQueryOrderdetails(Inputs,Outputs);_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       }_newline       bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,psOutputs2.GetProperty(&quot;IMEI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,psOutputs2.GetProperty(&quot;Access Tech&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));_newline      }_newline      else if ((sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; ) &amp;&amp; sOrderSubFunction == &quot;Change Location Connect&quot;)_newline      {_newline       bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,psOutputs2.GetProperty(&quot;IMEI&quot;));_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       } _newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,psOutputs2.GetProperty(&quot;NBNSpeed&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,psOutputs2.GetProperty(&quot;Access Tech&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));   _newline      _newline      }_newline      else{_newline       bcNBNModem.SetFieldValue(&quot;Modem Serial Number&quot;,psOutputs2.GetProperty(&quot;IMEI&quot;));_newline       if (sOrderSubType == &quot;Modify&quot; || sOrderSubType == &quot;Change Proposition&quot; || sOrderSubType == &quot;Change Ownership Connect&quot;)_newline       {_newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,sNewSpeed);_newline       }_newline       else_newline       {_newline       bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,psOutputs2.GetProperty(&quot;NBNSpeed&quot;));_newline       }_newline       bcNBNModem.SetFieldValue(&quot;Technology Type&quot;,psOutputs2.GetProperty(&quot;Access Tech&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));_newline       if (sEnableSKUCodeFix == &quot;Y&quot;)_newline       {_newline       sSKUModem = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline       Inputs.SetProperty(&quot;SKUCode&quot;,sSKUModem);_newline       QueryACSLOV(Inputs, Outputs);_newline       bcNBNModem.SetFieldValue(&quot;OUI&quot;,Outputs.GetProperty(&quot;sModemOUI&quot;));_newline       bcNBNModem.SetFieldValue(&quot;Product Class&quot;,Outputs.GetProperty(&quot;sProdClass&quot;));_newline       } _newline       _newline      } _newline      _newline      bcNBNModem.WriteRecord();_newline      }_newline      else_newline      {_newline_newline      Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline      Inputs.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline      fnGetModemDetails(Inputs,Outputs);_newline      mQueryOrderdetails(Inputs,Outputs);_newline_newline       if (sOrderSubFunction == sFDisconOrdSubFunction &amp;&amp; sOrderSubFunction != &quot;&quot;)_newline       {_newline       var psInputs3 = TheApplication().NewPropertySet();_newline       var psOutputs3 = TheApplication().NewPropertySet();_newline       psInputs3.SetProperty(&quot;OrderId&quot;,sOrderId);_newline       psInputs3.SetProperty(&quot;ServiceOrderId&quot;,sServiceOrderId);_newline       psInputs3.SetProperty(&quot;NBNProvisionFlag&quot;,&quot;Y&quot;);_newline       fnUpsertNBNDetails(psInputs3,psOutputs3);        _newline       }_newline_newline_newline      bcNBNModem.NewRecord(NewAfter);_newline      bcNBNModem.SetFieldValue(&quot;Order Id&quot;,sOrderId);_newline      bcNBNModem.SetFieldValue(&quot;Service Order Id&quot;, sServiceOrderId);_newline      bcNBNModem.SetFieldValue(&quot;ACS Provisioning Flag&quot;,&quot;N&quot;);_newline      if (sOrderSubType == &quot;Connect&quot;)_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,Outputs.GetProperty(&quot;StateValue&quot;));_newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline      }_newline      else if (sOrderSubType == &quot;Reactivate&quot; || sOrderSubType == &quot;Decon/Con Transfer TO&quot;)_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;));_newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,Outputs.GetProperty(&quot;NBNSpeed&quot;));_newline      }_newline      else_newline      {_newline      bcNBNModem.SetFieldValue(&quot;Address State&quot;,psOutputs2.GetProperty(&quot;State&quot;)); _newline      bcNBNModem.SetFieldValue(&quot;NBN Speed&quot;,psOutputs2.GetProperty(&quot;NBNSpeed&quot;));_newline      }_newline      bcNBNModem.WriteRecord();_newline      }_newline    }_newline }_newlinecatch (e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newlinebcNBNModem = null;_newlinesBOModem = null;_newline_newline} _newline     _newline}_newline"
 Program_spcLanguage="JS"
 Name="mCaptureModemInfo"
 Sequence="8"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCheckTPLinkArcadyan(psInputs4,psOutputs4)_newline{_newline_newline  _newline      _newlinetry_newline{_newline_newline  var sProductCode = psInputs4.GetProperty(&quot;ProductCode &quot;);_newline   var sACSProvFlag  =    psInputs4.GetProperty(&quot;ACSProvFlag&quot;);_newline    var sOrderSubType  =  psInputs4.GetProperty(&quot;OrderSubType&quot;);_newlinevar sServiceOrderId = psInputs4.GetProperty(&quot;ServiceOrderId&quot;);_newline_newline_newlinevar sEnableARC = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usCR_usENABLE_usFLAG&quot;, &quot;ENABLE_usARCADYAN&quot;);_newline      _newline      var sEnableTPLINKARC = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usCR_usENABLE_usFLAG&quot;, &quot;ENABLE_usTPLINKARC&quot;);_newline      if(sEnableTPLINKARC==&quot;Y&quot;)_newline      {_newline       if(sOrderSubType != &quot;Connect&quot;)_newline       {_newline        var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usTPARC_usPROD_usCODE&quot;, sProductCode);_newline        if(stparcfnd==&quot;Y&quot;)_newline        {_newline         sACSProvFlag = &quot;N&quot;; _newline        }_newline       }_newline       else_newline       {_newline        var boModem = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline        var bcModem = boModem.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline        bcModem.SetViewMode(AllView);_newline        bcModem.ClearToQuery();_newline        bcModem.ActivateField(&quot;Product Code&quot;);_newline        bcModem.SetSearchSpec(&quot;Root Order Line Item&quot;,sServiceOrderId);_newline        bcModem.ExecuteQuery(ForwardOnly);_newline        if(bcModem.FirstRecord())_newline        {_newline         var sProductCode = bcModem.GetFieldValue(&quot;Product Code&quot;);_newline        }_newline        var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usTPARC_usPROD_usCODE&quot;, sProductCode);_newline        if(stparcfnd==&quot;Y&quot;)_newline        {_newline         sACSProvFlag = &quot;N&quot;; _newline        }_newline       }_newline      }_newline      var sEnableARC = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usCR_usENABLE_usFLAG&quot;, &quot;ENABLE_usARCADYAN&quot;);_newline      if(sEnableARC==&quot;Y&quot;)_newline      {_newline       if(sOrderSubType != &quot;Connect&quot;)_newline       {_newline        var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usARC_usPROD_usCODE&quot;, sProductCode);_newline        if(stparcfnd==&quot;Y&quot;)_newline        {_newline         sACSProvFlag = &quot;N&quot;; _newline        }_newline        if(stparcfnd==&quot;N&quot;)_newline        {_newline         sACSProvFlag = &quot;Y&quot;; _newline        }_newline       }_newline       else_newline       {_newline        var boModem = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline        var bcModem = boModem.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline        bcModem.SetViewMode(AllView);_newline        bcModem.ClearToQuery();_newline        bcModem.ActivateField(&quot;Product Code&quot;);_newline        bcModem.SetSearchSpec(&quot;Root Order Line Item&quot;,sServiceOrderId);_newline        bcModem.ExecuteQuery(ForwardOnly);_newline        if(bcModem.FirstRecord())_newline        {_newline         var sProductCode = bcModem.GetFieldValue(&quot;Product Code&quot;);_newline        }_newline        var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usARC_usPROD_usCODE&quot;, sProductCode);_newline        if(stparcfnd==&quot;Y&quot;)_newline        {_newline         sACSProvFlag = &quot;N&quot;; _newline        }_newline        if(stparcfnd==&quot;N&quot;)_newline        {_newline         sACSProvFlag = &quot;Y&quot;; _newline        }_newline       }_newline      }_newline      _newline  return(sACSProvFlag)_newline_newline}_newlinecatch(e)_newline{_newlinethrow (e);_newline_newline}_newlinefinally_newline{_newline_newline}_newline}"
 Program_spcLanguage="JS"
 Name="mCheckTPLinkArcadyan"
 Sequence="9"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCreateACSProvisioningInfo(Inputs, Outputs) {_newline    //SATHISH G - Created for Imagine 12/12/2024_newline    try {_newline        var boOrder = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline        var bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline        var bcOrderItems = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline        var bcAppointment = boOrder.GetBusComp(&quot;VHA NBN Appointment&quot;);_newline        var bcSiteQualification = boOrder.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline        var bcNBNOrderDetails = boOrder.GetBusComp(&quot;VHA NBN Order Details&quot;);_newline        var bcSQList = boOrder.GetBusComp(&quot;VHA Site Qualification Service List&quot;);_newline        var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline_newline        var sModemOUI = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ModemOUI&quot;);_newline        var sProductClass = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VHA_usNBN_usACS_usATTR&quot;, &quot;ProductClass&quot;);_newline        var sOpticommNetwork = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VHA_usNETWORK_usPROVIDER&quot;, &quot;OPTICOMM&quot;);_newline_newline        var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline        var sServiceOrderId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline        var sSearchspec = &quot;&quot;;_newline        var sNBNAppointmentId = &quot;&quot;;_newline        var sSiteQualificationId = &quot;&quot;;_newline        var sTransferType = &quot;&quot;;_newline        var sAccessTech = &quot;&quot;;_newline        var sSQCVCId = &quot;&quot;;_newline        var sCVLANId = &quot;&quot;;_newline        var sCADate = &quot;&quot;;_newline        var sPortId = &quot;&quot;;_newline        var sFNNULL = &quot;&quot;;_newline        var sServiceClass = &quot;&quot;;_newline        var sDemandType = &quot;&quot;;_newline        var sRequestedResource = &quot;&quot;;_newline        var sShipPreference = &quot;&quot;;_newline        var sNBNOrderType, sNBNOrdModemNum = &quot;&quot;;_newline        var NBNLogisticsSC = &quot;N&quot;;_newline        var sACSProvFlag = &quot;&quot;;_newline        var sSQIdCVC = &quot;&quot;;_newline        var sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;, &quot;FBB Only&quot;);_newline        var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;, &quot;FBB with MBB&quot;);_newline_newline        var sCSAId = &quot;&quot;;_newline        if (sOrderId != &quot;&quot;) {_newline            //sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Id] = &apos;&quot; + sServiceOrderId + &quot;&apos; AND ([VF Siebel Product Type] = &apos;&quot; + sNBNOnly + &quot;&apos; OR [VF Siebel Product Type] = &apos;&quot; + sNBNwithMBB + &quot;&apos;)&quot;;_newline            sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL AND ([VF Siebel Product Type] = &apos;&quot; + sNBNOnly + &quot;&apos; OR [VF Siebel Product Type] = &apos;&quot; + sNBNwithMBB + &quot;&apos;)&quot;;_newline_newline            bcSiteQualification.ActivateField(&quot;Access Technology&quot;);_newline            bcSiteQualification.ActivateField(&quot;Transfer Type&quot;);_newline            bcSiteQualification.ActivateField(&quot;NBN Transfer Type&quot;);_newline            bcSiteQualification.ActivateField(&quot;Selected CVC&quot;);_newline            bcSiteQualification.ActivateField(&quot;NNI CVLAN Id&quot;);_newline            bcSiteQualification.ActivateField(&quot;Customer Authority Date&quot;);_newline            bcSiteQualification.ActivateField(&quot;Serviceability Class Calc&quot;);_newline            bcSiteQualification.ActivateField(&quot;FNN/ULL&quot;);_newline            bcSiteQualification.ActivateField(&quot;AppointEligibilityCalc&quot;); //hfc_newline            bcSiteQualification.ActivateField(&quot;CSA Id&quot;);_newline            bcSiteQualification.ActivateField(&quot;Id&quot;);_newline            bcAppointment.ActivateField(&quot;NBN Appointment Id&quot;);_newline            bcAppointment.ActivateField(&quot;DemandType&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Service Order Sub Type&quot;);_newline            bcOrderItems.ActivateField(&quot;Action Code&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Order Sub Function&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Order Sub Type TBUI&quot;);_newline            bcOrderItems.ActivateField(&quot;VF IMEI TBUI&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Device TBUI&quot;);_newline            bcOrderItems.ActivateField(&quot;Asset Id&quot;);_newline            //Added for NBNR: SG16-12-21_newline            bcOrderItems.ActivateField(&quot;VHA Service Provider Ref&quot;);_newline            bcOrderItems.ActivateField(&quot;BYO Calc&quot;);_newline            bcOrderItems.ActivateField(&quot;MSISDN&quot;);_newline            bcOrderItems.ActivateField(&quot;New MSISDN&quot;);_newline            bcOrderItems.ActivateField(&quot;Custom Asset Integration Id&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Siebel Product Type&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Network Identifier&quot;);_newline            bcOrderItems.ActivateField(&quot;Access Technology&quot;);_newline            bcOrderItems.ActivateField(&quot;VF Stock Indicator TBUI&quot;);_newline            bcSQList.ActivateField(&quot;Port Id&quot;);_newline            bcSQList.ActivateField(&quot;Exchange ID&quot;);_newline            bcSQList.ActivateField(&quot;Loss Notification Identifier&quot;);_newline            bcNBNOrderDetails.ActivateField(&quot;DemandType&quot;);_newline            bcNBNOrderDetails.ActivateField(&quot;Shipment Preference To&quot;);_newline            bcNBNOrderDetails.ActivateField(&quot;NBN Order Type&quot;);_newline            bcNBNOrderDetails.ActivateField(&quot;Modem Serial Number&quot;);_newline            bcOrder.ActivateField(&quot;Organization Name&quot;);_newline            //Added for NBNR Drop2_newline            bcOrder.ActivateField(&quot;VHA Override SPF&quot;);_newline            bcOrder.ActivateField(&quot;VF Order Channel&quot;);_newline            bcOrder.ActivateField(&quot;NetworkProviderName&quot;);_newline_newline            bcOrder.SetViewMode(AllView);_newline            bcOrder.ClearToQuery();_newline            bcOrder.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline            bcOrderItems.SetSearchExpr(sSearchspec);_newline            bcSiteQualification.SetSearchSpec(&quot;Status&quot;, &quot;New&quot;);_newline            bcSQList.SetSearchSpec(&quot;Select&quot;, &quot;Y&quot;);_newline            bcOrder.ExecuteQuery(ForwardOnly);_newline            if (bcOrderItems.FirstRecord()) {_newline                var sRootLineId = bcOrderItems.GetFieldValue(&quot;Id&quot;);_newline                var sOrgName = bcOrder.GetFieldValue(&quot;Organization Name&quot;);_newline                var sOverrideSP = bcOrder.GetFieldValue(&quot;VHA Override SPF&quot;);_newline                var sOrderSubType = bcOrderItems.GetFieldValue(&quot;VF Service Order Sub Type&quot;);_newline                var sActionCode = bcOrderItems.GetFieldValue(&quot;Action Code&quot;);_newline                var sOrderSubFunction = bcOrderItems.GetFieldValue(&quot;VF Order Sub Function&quot;);_newline                var sOrderSubTypeTBUI = bcOrderItems.GetFieldValue(&quot;VF Order Sub Type TBUI&quot;);_newline_newline                var sBYOCalc = bcOrderItems.GetFieldValue(&quot;BYO Calc&quot;);_newline                var sMSISDN = bcOrderItems.GetFieldValue(&quot;MSISDN&quot;);_newline                var sNewMSISDN = bcOrderItems.GetFieldValue(&quot;New MSISDN&quot;);_newline                var sOrderChannel = bcOrder.GetFieldValue(&quot;VF Order Channel&quot;);_newline                var sNetworkProvider = bcOrder.GetFieldValue(&quot;NetworkProviderName&quot;);_newline                var sLineItmNetworkIden = bcOrderItems.GetFieldValue(&quot;VF Network Identifier&quot;);_newline                var sAccessTechnology = bcOrderItems.GetFieldValue(&quot;Access Technology&quot;);_newline                var sCustAssetIntegId = bcOrderItems.GetFieldValue(&quot;Custom Asset Integration Id&quot;);_newline                var sSieblProdType = bcOrderItems.GetFieldValue(&quot;VF Siebel Product Type&quot;);_newline                var sIMEI = bcOrderItems.GetFieldValue(&quot;VF IMEI TBUI&quot;);_newline                var sDeviceAdded = bcOrderItems.GetFieldValue(&quot;VF Device TBUI&quot;);_newline                var sStockIndTBUI = bcOrderItems.GetFieldValue(&quot;VF Stock Indicator TBUI&quot;);_newline                var sSPId = bcOrderItems.GetFieldValue(&quot;Asset Id&quot;);_newline                var sServieProvRef = bcOrderItems.GetFieldValue(&quot;VHA Service Provider Ref&quot;);_newline_newline                if (bcNBNOrderDetails.FirstRecord()) {_newline                    sShipPreference = bcNBNOrderDetails.GetFieldValue(&quot;Shipment Preference To&quot;);_newline                    sNBNOrderType = bcNBNOrderDetails.GetFieldValue(&quot;NBN Order Type&quot;);_newline                    sNBNOrdModemNum = bcNBNOrderDetails.GetFieldValue(&quot;Modem Serial Number&quot;);_newline                    Inputs.SetProperty(&quot;NBNOrderDetails&quot;, &quot;Y&quot;);_newline                    if (bcNBNOrderDetails.GetFieldValue(&quot;DemandType&quot;) != &quot;&quot;) {_newline                        sDemandType = bcNBNOrderDetails.GetFieldValue(&quot;DemandType&quot;);_newline                        Inputs.SetProperty(&quot;NBNDemandType&quot;, sDemandType);_newline                    }_newline                } else {_newline                    Inputs.SetProperty(&quot;NBNOrderDetails&quot;, &quot;N&quot;);_newline                }_newline_newline                if (bcSiteQualification.FirstRecord()) {_newline                    sCSAId = bcSiteQualification.GetFieldValue(&quot;CSA Id&quot;);_newline                    sSQIdCVC = bcSiteQualification.GetFieldValue(&quot;Id&quot;);_newline                    sAccessTech = bcSiteQualification.GetFieldValue(&quot;Access Technology&quot;);_newline                    sTransferType = bcSiteQualification.GetFieldValue(&quot;NBN Transfer Type&quot;);_newline                    sSiteQualificationId = bcSiteQualification.GetFieldValue(&quot;Id&quot;);_newline                    sSQCVCId = bcSiteQualification.GetFieldValue(&quot;Selected CVC&quot;);_newline                    sCVLANId = bcSiteQualification.GetFieldValue(&quot;NNI CVLAN Id&quot;);_newline                    sCADate = bcSiteQualification.GetFieldValue(&quot;Customer Authority Date&quot;);_newline                    sServiceClass = bcSiteQualification.GetFieldValue(&quot;Serviceability Class Calc&quot;);_newline                    sFNNULL = bcSiteQualification.GetFieldValue(&quot;FNN/ULL&quot;);_newline                    sRequestedResource = bcSiteQualification.GetFieldValue(&quot;AppointEligibilityCalc&quot;);_newline                }_newline                var sCaptureModemInfo = TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VHA_usFBB_usCAPTURE_usMODEMINFO&quot;, &quot;ModemINfo&quot;);_newline                if (sCaptureModemInfo == &quot;Y&quot;) {_newline                    Inputs.SetProperty(&quot;OrderId&quot;, sOrderId);_newline                    Inputs.SetProperty(&quot;ServOrderId&quot;, sRootLineId);_newline                    Inputs.SetProperty(&quot;OrderSubType&quot;, sOrderSubType);_newline                    Inputs.SetProperty(&quot;MSISDN&quot;, sMSISDN);_newline                    Inputs.SetProperty(&quot;OrderSubFunction&quot;, sOrderSubFunction);_newline                    Inputs.SetProperty(&quot;OrderSubTypeTBUI&quot;, sOrderSubTypeTBUI);_newline                    Inputs.SetProperty(&quot;BYOCalc&quot;, sBYOCalc);_newline                    Inputs.SetProperty(&quot;SieblProdType&quot;, sSieblProdType);_newline                    Inputs.SetProperty(&quot;CustAssetIntegId&quot;, sCustAssetIntegId);_newline                    Inputs.SetProperty(&quot;NewMSISDN&quot;, sNewMSISDN);_newline_newline                    Inputs.SetProperty(&quot;CSAId&quot;, sCSAId);_newline                    Inputs.SetProperty(&quot;IMEIAllocated&quot;, sIMEI);_newline                    Inputs.SetProperty(&quot;ModemAdded&quot;, sDeviceAdded);_newline                    Inputs.SetProperty(&quot;NBNOrdModemNum&quot;, sNBNOrdModemNum);_newline                    Inputs.SetProperty(&quot;NetworkIdentifier&quot;, sLineItmNetworkIden);_newline                    Inputs.SetProperty(&quot;SQSelectedCVC&quot;, sSQCVCId);_newline                    Inputs.SetProperty(&quot;OrgName&quot;, sOrgName);_newline                    Inputs.SetProperty(&quot;StockIndTBUI&quot;, sStockIndTBUI);_newline  _newline                    if ((sOrderSubFunction == &quot;Change Location Connect&quot; &amp;&amp; sActionCode !=&quot;Delete&quot;)|| sOrderSubFunction == &quot;Change Technology Connect&quot; || sOrderSubType == &quot;Connect&quot; ||sOrderSubType == &quot;Reactivate&quot;) //MADHUR::1JUL25::Added Connect for GRAD Failures_newline                    { _newline                        mCaptureModemInfo(Inputs, Outputs);_newline                    } else if (sOrderSubType == &quot;Modify&quot;) {_newline                        mCaptureModemInfo(Inputs, Outputs);_newline                    } else if (sOrderSubFunction == &quot;Change Location Across NW&quot;) {_newline                        mUpdateReUseModemFlag(Inputs, Outputs);_newline                    } else if (sOrderSubFunction == &quot;Change Technology Across NW&quot;) {_newline                        mCOTCaptureModemInfo(Inputs, Outputs);_newline                        mUpdateReUseModemFlag(Inputs, Outputs);_newline                    }_newline                }_newline            } else {_newline_newline                var boOrder1 = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline                var bcOrder1 = boOrder1.GetBusComp(&quot;Order Entry - Orders&quot;);_newline                var bcOrderItems1 = boOrder1.GetBusComp(&quot;VF Order Entry - Line Items Thin&quot;);_newline_newline                sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL&quot;;_newline                bcOrder1.SetViewMode(AllView);_newline                bcOrderItems1.ActivateField(&quot;Special Product Type&quot;);_newline                bcOrderItems1.ActivateField(&quot;VF Service Order Sub Type&quot;);_newline                bcOrderItems1.ActivateField(&quot;VF Order Sub Function&quot;);_newline                bcOrder1.ClearToQuery();_newline                bcOrder1.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline                bcOrderItems1.SetSearchExpr(sSearchspec);_newline                bcOrder1.ExecuteQuery(ForwardOnly);_newline_newline                if (bcOrderItems1.FirstRecord()) {_newline_newline                    var sSpecialSblType = bcOrderItems1.GetFieldValue(&quot;Special Product Type&quot;);_newline                    var sServiceOrdSubType = bcOrderItems1.GetFieldValue(&quot;VF Service Order Sub Type&quot;);_newline                    var sOrderSubFunction = bcOrderItems1.GetFieldValue(&quot;VF Order Sub Function&quot;);_newline_newline                    if ((sSpecialSblType == &quot;VFAUPostPayFWA4G&quot; || sSpecialSblType == &quot;VFAUPostPayFWA5G&quot;) &amp;&amp; sServiceOrdSubType == &quot;Disconnect&quot; &amp;&amp; (sOrderSubFunction == &quot;Change Technology Across NW&quot; || sOrderSubFunction == &quot;Change Location Across NW&quot;)) {_newline_newline                        //Invoke calc charges_newline                        //Delete charges_newline                        var bs = TheApplication().GetService(&quot;VF Calculate Charges Service MSO&quot;);_newline                        var Inps = TheApplication().NewPropertySet();_newline                        var Outps = TheApplication().NewPropertySet();_newline                        Inps.SetProperty(&quot;Order Id&quot;, sOrderId);_newline                        bs.InvokeMethod(&quot;DeleteCharges&quot;, Inps, Outps);_newline_newline                        //Add Charges_newline                        var bs = TheApplication().GetService(&quot;VF Calculate Charges Service C MSO&quot;);_newline                        var Inps = TheApplication().NewPropertySet();_newline                        var Outps = TheApplication().NewPropertySet();_newline                        Inps.SetProperty(&quot;Order Id&quot;, sOrderId);_newline                        Inps.SetProperty(&quot;NBNDisconnect&quot;, &quot;Y&quot;);_newline                        bs.InvokeMethod(&quot;CalculateCharges&quot;, Inps, Outps);_newline                    }_newline                }_newline            }_newline        }_newline    } catch (e) {_newline        throw (e);_newline    } finally {_newline        bcOrder = null;_newline        bcOrderItems = null;_newline        bcAppointment = null;_newline        bcSiteQualification = null;_newline        bcSQList = null;_newline        bcOrderItemXA = null;_newline        boOrder = null;_newline    }_newline}"
 Program_spcLanguage="JS"
 Name="mCreateACSProvisioningInfo"
 Sequence="12"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mCreateInterimOrdDetails(Inputs,Outputs)_newline{_newline//Sathish : Added for Fibre Upgrade Drop2 -17/02/24_newlinetry{  _newline   _newline  _newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sNBNFTTPInterim = Inputs.GetProperty(&quot;FCNBNFTTPInterim&quot;);_newline  var sSelectedFibreplan = Inputs.GetProperty(&quot;FCSelectedPlan&quot;);_newline  var sSelectedFibreprop = Inputs.GetProperty(&quot;FCSelectedPropId&quot;);_newline  _newline  var boInterimOrd = TheApplication().GetBusObject(&quot;Order Entry&quot;);_newline  var bcInterimOrd = boInterimOrd.GetBusComp(&quot;Order Entry - Orders&quot;); _newline  var bcInterimOrdXM = boInterimOrd.GetBusComp(&quot;VHA Fibre Interim Order Details&quot;);_newline  if(sOrderId != &quot;&quot; &amp;&amp; sOrderId != null &amp;&amp; sNBNFTTPInterim!= null &amp;&amp; sSelectedFibreplan != null &amp;&amp; sSelectedFibreprop != null)_newline  {_newline  bcInterimOrdXM.ActivateField(&quot;NBN FTTP Interim Flag&quot;);_newline        bcInterimOrdXM.ActivateField(&quot;Selected Fibre Plan&quot;);_newline        bcInterimOrdXM.ActivateField(&quot;Selected Fibre Prop Id&quot;);_newline  bcInterimOrd.SetViewMode(AllView);_newline  bcInterimOrd.ClearToQuery();_newline  bcInterimOrd.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline  bcInterimOrdXM.SetSearchSpec(&quot;Order Id&quot;,sOrderId);_newline  bcInterimOrd.ExecuteQuery(ForwardOnly);_newline  _newline     if(!bcInterimOrdXM.FirstRecord())_newline     {_newline      _newline      bcInterimOrdXM.NewRecord(NewAfter);_newline      bcInterimOrdXM.SetFieldValue(&quot;Order Id&quot;,sOrderId);_newline      bcInterimOrdXM.SetFieldValue(&quot;NBN FTTP Interim Flag&quot;,sNBNFTTPInterim);_newline      bcInterimOrdXM.SetFieldValue(&quot;Selected Fibre Plan&quot;,sSelectedFibreplan);_newline      bcInterimOrdXM.SetFieldValue(&quot;Selected Fibre Prop Id&quot;,sSelectedFibreprop);_newline      bcInterimOrdXM.WriteRecord();_newline      _newline     }_newline     else_newline     {_newline      bcInterimOrdXM.SetFieldValue(&quot;NBN FTTP Interim Flag&quot;,sNBNFTTPInterim);_newline      bcInterimOrdXM.SetFieldValue(&quot;Selected Fibre Plan&quot;,sSelectedFibreplan);_newline      bcInterimOrdXM.SetFieldValue(&quot;Selected Fibre Prop Id&quot;,sSelectedFibreprop);_newline      bcInterimOrdXM.WriteRecord();_newline     _newline     }_newline  }    _newline }_newlinecatch(e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newlinebcInterimOrdXM = null;_newlinebcInterimOrd = null;_newlineboInterimOrd = null;_newline_newline}_newline_newline}_newline_newline _newline      _newline"
 Program_spcLanguage="JS"
 Name="mCreateInterimOrdDetails"
 Sequence="13"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mFCCreateFibConDetails(Inputs,Outputs)_newline{_newline//Sathish : Added for Fibre Connect 07/11/23_newlinetry{  _newline _newline     var sFibreOrderId = Inputs.GetProperty(&quot;FibreOrderId&quot;);_newline     var sFibreServiceOrderId = &quot;&quot;;_newline     var sFTTCRootAssetId = Inputs.GetProperty(&quot;FTTCRootAssetId&quot;);_newline     var sMSISDN = Inputs.GetProperty(&quot;FTTNC MSISDN&quot;);_newline_newline_newline_newline    var sFibreOrdLineSpec = &quot;[Order Header Id] = &apos;&quot; + sFibreOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL&quot;;_newline_newline    if (sFibreOrderId != &quot;&quot;)_newline    {_newline     var boOrder = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline     var bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline     var bcOrderItems = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;); _newline     var sBOFibCon = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline     var bcFibCon = sBOFibCon.GetBusComp(&quot;VHA NBN Fibre Connect Details&quot;);     _newline       _newline     bcOrder.SetViewMode(AllView);_newline     bcOrder.ClearToQuery();_newline     bcOrder.SetSearchSpec(&quot;Id&quot;,sFibreOrderId);_newline     bcOrderItems.SetSearchExpr(sFibreOrdLineSpec);_newline     bcOrder.ExecuteQuery(ForwardOnly);_newline     _newline     if(bcOrder.FirstRecord() &amp;&amp; bcOrderItems.FirstRecord())_newline     {_newline     sFibreServiceOrderId = bcOrderItems.GetFieldValue(&quot;Id&quot;);_newline      _newline     if(sFibreServiceOrderId != &quot;&quot;)_newline     {_newline      _newline      bcFibCon.SetViewMode(AllView);_newline      bcFibCon.ClearToQuery();_newline      bcFibCon.ActivateField(&quot;Order Id&quot;);_newline      bcFibCon.ActivateField(&quot;Service Order Id&quot;);_newline      bcFibCon.ActivateField(&quot;FTTNC MSISDN&quot;);_newline      bcFibCon.ActivateField(&quot;FTTNC Root Asset Id&quot;);_newline      bcFibCon.SetSearchSpec(&quot;Order Id&quot;,sFibreOrderId);_newline      bcFibCon.SetSearchSpec(&quot;Service Order Id&quot;,sFibreServiceOrderId);   _newline      bcFibCon.ExecuteQuery(ForwardOnly);_newline_newline  _newline     if(!bcFibCon.FirstRecord())_newline     {_newline_newline_newline     bcFibCon.NewRecord(NewAfter);_newline     bcFibCon.SetFieldValue(&quot;Order Id&quot;,sFibreOrderId);_newline     bcFibCon.SetFieldValue(&quot;Service Order Id&quot;, sFibreServiceOrderId);_newline     bcFibCon.SetFieldValue(&quot;FTTNC Root Asset Id&quot;,sFTTCRootAssetId);_newline     bcFibCon.SetFieldValue(&quot;FTTNC MSISDN&quot;,sMSISDN);_newline     bcFibCon.WriteRecord();_newline     _newline     }_newline     else_newline     {_newline     bcFibCon.SetFieldValue(&quot;FTTNC Root Asset Id&quot;,sFTTCRootAssetId);_newline     bcFibCon.SetFieldValue(&quot;FTTNC MSISDN&quot;,sMSISDN);_newline     bcFibCon.WriteRecord();_newline     }_newline     }_newline     }_newline    _newline    }_newlineOutputs.SetProperty(&quot;FibreServiceOrderId&quot;,sFibreServiceOrderId); _newline_newline }_newlinecatch (e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newlinebcFibCon = null;_newlinesBOFibCon = null;_newline_newline} _newline     _newline}_newline"
 Program_spcLanguage="JS"
 Name="mFCCreateFibConDetails"
 Sequence="14"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mFCNBNAttributesUpd(Inputs,Outputs)_newline{_newline try_newline {_newline var boOrder = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);  _newline var bcOrder = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);  _newline var bcOrderItem = boOrder.GetBusComp(&quot;VF Order Entry - Line Items Thin&quot;); _newline_newline var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline var sRootId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline var sOrderSubType=&quot;&quot;;_newline var sOrderChannel=&quot;&quot;;_newline_newline var sSearchspec,sRootItemId,sOrdersubFunction, sOrderSubTypeTBUI, sParentOrd,sTransferType,sLinkConnectOrder ;_newline_newline var sFCInterimOrdSubFn = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Interim&quot;);_newline var sFConOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Connect&quot;);_newline_newline_newline if(sRootId != &quot;&quot;)_newline {_newline sSearchspec = &quot;[Id] = &apos;&quot; + sRootId + &quot;&apos;&quot;;_newline }_newline else_newline {_newline sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL AND ([VF Siebel Product Type] = &apos;&quot; + sNBNOnly + &quot;&apos; OR [VF Siebel Product Type] = &apos;&quot; + sNBNwithMBB + &quot;&apos;)&quot;;_newline }_newline_newline_newline if(sOrderId != &quot;&quot;)_newline {_newline bcOrder.SetViewMode(AllView);_newline bcOrder.ActivateField(&quot;VF Order Channel&quot;);_newline bcOrder.ActivateField(&quot;VHA FC Link Ord Id 1&quot;);_newline bcOrderItem.ActivateField(&quot;VF Order Sub Function&quot;);_newline bcOrderItem.ActivateField(&quot;VF Order Sub Type TBUI&quot;);_newline bcOrderItem.ActivateField(&quot;VF Service Order Sub Type&quot;);_newline bcOrder.ClearToQuery();_newline bcOrder.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline bcOrderItem.SetSearchExpr(sSearchspec);_newline bcOrder.ExecuteQuery(ForwardOnly);_newline if (bcOrder.FirstRecord())_newline {_newline_newline sOrderChannel = bcOrder.GetFieldValue(&quot;VF Order Channel&quot;);_newline sLinkConnectOrder = bcOrder.GetFieldValue(&quot;VHA FC Link Ord Id 1&quot;);_newline_newline if (bcOrderItem.FirstRecord())_newline {_newline sRootItemId = bcOrderItem.GetFieldValue(&quot;Id&quot;);_newline sOrdersubFunction = bcOrderItem.GetFieldValue(&quot;VF Order Sub Function&quot;);_newline sOrderSubTypeTBUI = bcOrderItem.GetFieldValue(&quot;VF Order Sub Type TBUI&quot;);_newline sOrderSubType = bcOrderItem.GetFieldValue(&quot;VF Service Order Sub Type&quot;);_newline_newline_newline_newline if (sOrdersubFunction == sFCInterimOrdSubFn &amp;&amp; sOrderSubType == &quot;Connect&quot;)_newline {_newline_newline if(sOrderChannel  == &quot;VHA Online Store&quot;)_newline {_newline_newline mUpdateSQWorkOrdId(Inputs,Outputs);_newline }_newline_newline mUpdateCVCId(Inputs,Outputs);_newline mGetSQTransferType(Inputs,Outputs);_newline sTransferType = Outputs.GetProperty(&quot;NBNTransferType&quot;);_newline_newline if (sTransferType == &quot;Service Transfer&quot;)_newline {_newline_newline //Update NBN attributes_newline Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline mUpdateNBNAttributes(Inputs,Outputs);_newline }_newline_newline }_newline _newline if ((sOrdersubFunction == &quot;Change Technology Across NW&quot; || sOrdersubFunction == &quot;Change Location Across NW&quot; )&amp;&amp; sOrderSubType == &quot;Disconnect&quot; &amp;&amp; sLinkConnectOrder != null &amp;&amp; sLinkConnectOrder!= &quot;&quot;)_newline {_newline _newline  mUpdateReUseModemFlag(Inputs,Outputs);_newline _newline _newline }_newline_newline_newline if (sOrdersubFunction == sFConOrdSubFunction )_newline {_newline_newline Inputs.SetProperty(&quot;NBNFCChildOrderId&quot;,sOrderId); _newline mGetLinkFCOrderDetails(Inputs,Outputs);_newline sParentOrd = Outputs.GetProperty(&quot;FibreOrderId&quot;);_newline_newline if (sParentOrd != &quot;&quot;)_newline {_newline_newline Inputs.SetProperty(&quot;IntOrderId&quot;,sParentOrd);      _newline fnInterimGetCVCId(Inputs,Outputs);_newline var sCVCid = Outputs.GetProperty(&quot;CVC Id&quot;);_newline_newline_newline Inputs.SetProperty(&quot;FibOrderId&quot;,sOrderId);_newline Inputs.SetProperty(&quot;FibSerOrdId&quot;,sRootId);_newline Inputs.SetProperty(&quot;CVC Id&quot;,sCVCid);_newline mUpdateCVCIdFromIntOrd(Inputs,Outputs);_newlineUpdateBWProfile(Inputs,Outputs);_newline_newline }_newline_newline //Update NBN attributes_newline //Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline //mUpdateNBNAttributes(Inputs,Outputs);_newline }_newline_newline_newline if (sOrdersubFunction == &quot;Change Location Connect&quot; || sOrdersubFunction == &quot;Change Technology Across NW&quot; )_newline {_newline  Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline  Inputs.SetProperty(&quot;ServiceOrderId&quot;,sRootId);   _newline_newline_newline  mCreateACSProvisioningInfo(Inputs,Outputs);_newline_newline_newline  if (sOrdersubFunction == &quot;Change Location Connect&quot;)_newline  {_newline  mGetSQDetails(Inputs,Outputs);_newline  sTransferType = Outputs.GetProperty(&quot;SQTransferType&quot;);_newline_newline_newline  if (sTransferType != &quot;&quot;)_newline  {_newline_newline  //Update NBN attributes_newline  Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline  if(sTransferType == &quot;New&quot;)_newline  {_newline  Inputs.SetProperty(&quot;SQTransferType&quot;,&quot;&quot;);_newline  }_newline  else _newline  {_newline  Inputs.SetProperty(&quot;SQTransferType&quot;,sTransferType);_newline  }_newline  Inputs.SetProperty(&quot;OrdersubFunction &quot;,sOrdersubFunction );_newline_newline  mUpdateCOLNBNAttributes(Inputs,Outputs);_newline  }_newline  }_newline_newline_newline }_newline Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newlineInputs.SetProperty(&quot;ServiceOrdId&quot;,sRootId);_newlinemGetCPNumUpdate(Inputs,Outputs);_newline_newline_newline }_newline_newline }_newline }_newline}_newlinecatch (e)_newline{_newlinethrow (e);_newline}_newlinefinally_newline{_newlinebcOrderItem = null;_newlinebcOrder = null;_newlineboOrder = null;_newline_newline}_newline}  _newline_newline_newline"
 Program_spcLanguage="JS"
 Name="mFCNBNAttributesUpd"
 Sequence="1"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetAssetCVCOrdUpd(Inputs,Outputs)_newline{_newline_newlinetry_newline{_newline _newline _newline var oAssetBo = TheApplication().GetBusObject(&quot;VF Asset&quot;);_newline var bcAssetComp = oAssetBo.GetBusComp(&quot;Asset Mgmt - Asset (Order Mgmt)&quot;);_newline var bcAssetAttr = oAssetBo.GetBusComp(&quot;Asset Mgmt - Asset XA&quot;);_newline _newline var sOrderId = Inputs.GetProperty(&quot;Order Id&quot;);_newline var sServiceOrdId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline var sRootAstId = Inputs.GetProperty(&quot;RootAssetId&quot;);_newline var sCVCId = &quot;&quot;;_newline _newline var sAttribName,sAssetAttribRec, sActionCode= &quot;&quot;;_newline _newline_newline  _newline if (sRootAstId != &quot;&quot; &amp;&amp; sRootAstId != null)_newline {_newline_newline with (bcAssetComp)_newline {_newline  ActivateField(&quot;Integration Id&quot;);_newline  ClearToQuery();_newline  SetViewMode(AllView);_newline  SetSearchSpec(&quot;Root Asset Id&quot;,sRootAstId);_newline  SetSearchSpec(&quot;Product Sub Type Code&quot;,&quot;Service Specification&quot;); _newline  ExecuteQuery(ForwardOnly);_newline  if (FirstRecord())_newline  {_newline  sAssetAttribRec = bcAssetAttr.FirstRecord();  _newline  while(sAssetAttribRec)_newline  {_newline   _newline   sAttribName = bcAssetAttr.GetFieldValue(&quot;Display Name&quot;);_newline   sActionCode = bcAssetAttr.GetFieldValue(&quot;Action Code&quot;);  _newline   if (sAttribName == &quot;CVC Id&quot;)_newline   {_newline   sCVCId = bcAssetAttr.GetFieldValue(&quot;Value&quot;);_newlinethrow(sCVCId);_newline_newline   }_newline  sAssetAttribRec=bcAssetAttr.NextRecord();_newline_newline  }_newline  _newline }_newline_newline }_newline_newline }_newline _newline _newline _newline}_newlinecatch(e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newlinebcAssetAttr = null;_newlinebcAssetComp = null;_newlineoAssetBo= null;_newline_newline_newline}_newline}  _newline"
 Program_spcLanguage="JS"
 Name="mGetAssetCVCOrdUpd"
 Sequence="16"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetCPNumUpdate(Inputs,Outputs)_newline{_newline try_newline {  _newline  //Fetch PortId or Copper Pair Id form the selected Service List of existing SQ record _newline  var boSQ = TheApplication().GetBusObject(&quot;VHA Site Qualification BO&quot;);_newline  var bcSQ = boSQ.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline  var bcSQServiceList = boSQ.GetBusComp(&quot;VHA Site Qualification Service List&quot;);_newline  _newline  var sAccessTechnology = &quot;&quot;,sOrderId = &quot;&quot;,sServiceId = &quot;&quot;,sLocationId = &quot;&quot;, sServOrderId=&quot;&quot;;_newline  _newline  var psInput = TheApplication().NewPropertySet();_newline  var psOutput = TheApplication().NewPropertySet();_newline  var svc = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline  var sSQRowId = &quot;&quot;;_newline  var sStatus = &quot;N&quot;;_newline   _newline  sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  sServOrderId = Inputs.GetProperty(&quot;ServiceOrdId&quot;);_newline_newline_newline  if(sOrderId != &quot;&quot;)_newline  {_newline   bcSQ.SetViewMode(AllView);_newline   bcSQ.ClearToQuery();_newline   _newline   bcSQ.ActivateField(&quot;Order Id&quot;);_newline   bcSQ.ActivateField(&quot;Status&quot;); _newline   bcSQ.ActivateField(&quot;NBN Location Id&quot;);_newline   bcSQ.ActivateField(&quot;Access Technology&quot;);_newline   bcSQServiceList.ActivateField(&quot;Select&quot;);_newline   bcSQServiceList.ActivateField(&quot;PortId&quot;);_newline   bcSQServiceList.ActivateField(&quot;Service Code&quot;);_newline   bcSQServiceList.ActivateField(&quot;Exchange ID&quot;);_newlinebcSQServiceList.ActivateField(&quot;Serviceability Class&quot;);_newline   bcSQ.SetSearchSpec(&quot;Order Id&quot;,sOrderId); _newline   bcSQ.SetSearchSpec(&quot;Status&quot;,&quot;New&quot;);   _newline   bcSQServiceList.SetSearchSpec(&quot;Select&quot;,&quot;Y&quot;);_newline  _newline   bcSQ.ExecuteQuery(ForwardOnly);_newline   if(bcSQ.FirstRecord()) {_newline    var isRecLine = bcSQServiceList.FirstRecord();   _newline    if(isRecLine) {_newline     sLocationId = bcSQ.GetFieldValue(&quot;NBN Location Id&quot;);_newline     sAccessTechnology = bcSQ.GetFieldValue(&quot;Access Technology&quot;); _newline_newline     sServiceId = bcSQServiceList.GetFieldValue(&quot;Exchange ID&quot;);_newline                                       var  sServiceClass = bcSQServiceList.GetFieldValue(&quot;Serviceability Class&quot;);_newline//throw sServiceClass;_newline     _newline    }_newline   }_newline  }_newline  _newline  _newline  if( sServiceId != &quot;&quot; )_newline  {_newline  Inputs.SetProperty(&quot;Service Id&quot;,sServiceId );_newline  mUpdateServiceId(Inputs,Outputs);_newline  }_newline               _newline_newline  _newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcSQServiceList = null;_newline  bcSQ = null;_newline  boSQ = null;_newline  svc = null; _newline  psInput = null;_newline  psOutput = null;_newline } _newline}_newline"
 Program_spcLanguage="JS"
 Name="mGetCPNumUpdate"
 Sequence="1"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetInterimPropId(Inputs,Outputs)_newline{_newline//SATHISH 07/02/2024 - Added for Fibre Upgrade Drop 2_newline try_newline {_newline  var sInterimPropName = &quot;&quot;;_newline  var sPropSiebelPrdType = Inputs.GetProperty(&quot;PropSiebelPrdType&quot;);_newline  var LOVBO,LOVBC,PropBO,PropBC=&quot;&quot;;_newline    _newline  if (sPropSiebelPrdType != &quot;&quot; &amp;&amp; sPropSiebelPrdType != null)_newline  {_newline   LOVBO = TheApplication().GetBusObject(&quot;List Of Values&quot;);_newline   LOVBC = LOVBO.GetBusComp(&quot;List Of Values&quot;);_newline   with(LOVBC)_newline   {_newline    SetViewMode(AllView);_newline    ActivateField(&quot;Description&quot;);_newline    ClearToQuery();_newline    SetSearchSpec(&quot;Name&quot;,sPropSiebelPrdType);_newline    SetSearchSpec(&quot;Type&quot;,&quot;VF_usFIBRE_usCONNECT&quot;);_newline    ExecuteQuery(ForwardOnly);_newline    if(FirstRecord())_newline    {_newline     sInterimPropName = GetFieldValue(&quot;Description&quot;);_newline    }_newline   }_newline   _newline  }_newline_newline  if (sInterimPropName != &quot;&quot; &amp;&amp; sInterimPropName != null)_newline  {_newline   PropBO = TheApplication().GetBusObject(&quot;Admin ISS Product Definition&quot;);_newline   PropBC = PropBO.GetBusComp(&quot;Internal Product - ISS Admin&quot;);_newline   with(PropBC)_newline   {_newline    SetViewMode(AllView);_newline    ClearToQuery();_newline    SetSearchSpec(&quot;Name&quot;,sInterimPropName);_newline    ExecuteQuery(ForwardOnly);_newline    if(FirstRecord())_newline    {_newline     Outputs.SetProperty(&quot;InterimPropId&quot;,GetFieldValue(&quot;Id&quot;));_newline    }_newline   }_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  if(defined(PropBC)) {PropBC = null;}_newline  if(defined(LOVBC)) {LOVBC = null;}_newline  if(defined(LOVBO)) {LOVBO = null;}_newline  if(defined(PropBO)) {PropBO = null;}_newline }_newline}_newline"
 Program_spcLanguage="JS"
 Name="mGetInterimPropId"
 Sequence="17"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetLinkFCOrderDetails(Inputs,Outputs)_newline{_newline//Sathish - Created for Fibre Connect Drop 2._newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;Order Entry&quot;);  _newline  var bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);  _newline_newline  var sNBNFCParentOrderId = Inputs.GetProperty(&quot;NBNFCParentOrderId&quot;); _newline  var sNBNFCChildOrderId = Inputs.GetProperty(&quot;NBNFCChildOrderId&quot;); _newline  _newline  var sFibreOrderId,sInterimOrdId=&quot;&quot;;_newline_newline  if(sNBNFCParentOrderId != &quot;&quot; &amp;&amp; sNBNFCParentOrderId !=null )_newline  {_newline   bcOrder.SetViewMode(AllView);_newline   bcOrder.ClearToQuery();_newline   bcOrder.ActivateField(&quot;VHA FC Link Ord Id 2&quot;);_newline   bcOrder.SetSearchSpec(&quot;Id&quot;, sNBNFCParentOrderId);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if (bcOrder.FirstRecord())_newline   {_newline    sFibreOrderId = bcOrder.GetFieldValue(&quot;VHA FC Link Ord Id 2&quot;);_newline    Outputs.SetProperty(&quot;FibreOrderId&quot;,sFibreOrderId);_newline    _newline   }  _newline   _newline  }_newline  _newline  if(sNBNFCChildOrderId != &quot;&quot; &amp;&amp; sNBNFCChildOrderId != null)_newline  {_newline   bcOrder.SetViewMode(AllView);_newline   bcOrder.ClearToQuery();_newline   bcOrder.ActivateField(&quot;VHA FC Link Ord Id 1&quot;);_newline   bcOrder.SetSearchSpec(&quot;Id&quot;, sNBNFCChildOrderId);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if (bcOrder.FirstRecord())_newline   {_newline    sInterimOrdId = sFibreOrderId = bcOrder.GetFieldValue(&quot;VHA FC Link Ord Id 1&quot;);_newline    Outputs.SetProperty(&quot;FibreOrderId&quot;,sInterimOrdId);_newline    _newline   }  _newline   _newline   _newline  }_newline  _newline  _newline }_newline catch (e)_newline {_newline  throw (e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  boOrder = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mGetLinkFCOrderDetails"
 Sequence="18"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetPOIIdentifier(Inputs,Outputs)_newline{_newline try_newline {_newline  var boPOI = TheApplication().GetBusObject(&quot;VHA POI Matrix&quot;);_newline  var bcPOI = boPOI.GetBusComp(&quot;VHA POI Data&quot;);_newline  var sCSAId =Inputs.GetProperty(&quot;CSAId&quot;);_newline  var sPOIVal = &quot;&quot;;_newline  _newline  if(sCSAId != &quot;&quot; &amp;&amp; sCSAId != null)_newline  {_newline   with(bcPOI)_newline   {_newline    ActivateField(&quot;POI Identifier&quot;);_newline    SetViewMode(AllView);_newline    ClearToQuery();_newline    SetSearchSpec(&quot;CSA Identifier&quot;,sCSAId);_newline    ExecuteQuery(ForwardOnly);_newline    if(FirstRecord())_newline    {_newline     sPOIVal = GetFieldValue(&quot;POI Identifier&quot;);_newline     Outputs.SetProperty(&quot;POIValue&quot;, sPOIVal);_newline     _newline    }_newline   }_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline  //Outputs.SetProperty(&quot;Error Message&quot;, e.errText);_newline }_newline finally_newline {_newline  bcPOI = null;_newline  boPOI = null;_newline } _newline _newline}_newline_newline"
 Program_spcLanguage="JS"
 Name="mGetPOIIdentifier"
 Sequence="19"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetSQDetails(Inputs,Outputs)_newline{_newline try_newline {  _newline  _newline  var boSQ = TheApplication().GetBusObject(&quot;VHA Site Qualification BO&quot;);_newline  var bcSQ = boSQ.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline  var bcSQServiceList = boSQ.GetBusComp(&quot;VHA Site Qualification Service List&quot;);_newline  _newline  var sAccessTechnology = &quot;&quot;,sOrderId = &quot;&quot;,sPortId = &quot;&quot;,sCopperPairId = &quot;&quot;,sLocationId = &quot;&quot;,  sSQPortStatus = &quot;Not Free&quot;;_newline  _newline  var psInput = TheApplication().NewPropertySet();_newline  var psOutput = TheApplication().NewPropertySet();_newline  var svc = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline  var sSQRowId = &quot;&quot;;_newline  var sStatus = &quot;N&quot;;_newline  var sTransfertype=&quot;&quot;;_newline   _newline  sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline_newline  if(sOrderId != &quot;&quot;)_newline  {_newline   bcSQ.SetViewMode(AllView);_newline   bcSQ.ClearToQuery();_newline   _newline   bcSQ.ActivateField(&quot;Order Id&quot;);_newline   bcSQ.ActivateField(&quot;NBN Transfer Type&quot;); _newline    _newline   bcSQ.SetSearchSpec(&quot;Order Id&quot;,sOrderId); _newline   bcSQ.SetSearchSpec(&quot;Status&quot;,&quot;New&quot;);   _newline   bcSQServiceList.SetSearchSpec(&quot;Select&quot;,&quot;Y&quot;);_newline  _newline   bcSQ.ExecuteQuery(ForwardOnly);_newline_newline   if(bcSQ.FirstRecord()) _newline   {_newline_newline   sTransfertype = bcSQ.GetFieldValue(&quot;NBN Transfer Type&quot;); _newline_newline   }_newline  }_newline  _newline  _newline  _newline  Outputs.SetProperty(&quot;SQTransferType&quot;, sTransfertype );_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcSQServiceList = null;_newline  bcSQ = null;_newline  boSQ = null;_newline  svc = null; _newline  psInput = null;_newline  psOutput = null;_newline } _newline}"
 Program_spcLanguage="JS"
 Name="mGetSQDetails"
 Sequence="21"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mGetSQTransferType(Inputs,Outputs)_newline{_newline//SG 08-03-24 Created for Fibre upgrade Drop2 - To Update NBN Attributes for Interim Order_newline try_newline {_newline_newline  _newline var boOrder1 = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline var bcOrder1 = boOrder1.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline var bcOrderItem1 = boOrder1.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline var bcSiteQualification = boOrder1.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline var bcSQList = boOrder1.GetBusComp(&quot;VHA Site Qualification Service List&quot;);_newline_newline var sTransferType=&quot;&quot;;_newline  _newline var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline var sServiceOrderId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline   _newline  if(sOrderId != &quot;&quot; &amp;&amp; sServiceOrderId != &quot;&quot;)_newline  {_newline  bcOrder1.SetViewMode(AllView);_newline   bcSiteQualification.ActivateField(&quot;Transfer Type&quot;);_newline   bcOrder1.ClearToQuery();_newline   bcOrder1.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem1.SetSearchSpec(&quot;Id&quot;,sServiceOrderId);_newline   bcSiteQualification.SetSearchSpec(&quot;Status&quot;,&quot;New&quot;);_newline bcSQList.SetSearchSpec(&quot;Select&quot;,&quot;Y&quot;);_newline   bcOrder1.ExecuteQuery(ForwardOnly);_newline   if(bcOrder1.FirstRecord() &amp;&amp; bcOrderItem1.FirstRecord())_newline   {_newline   _newline if(bcSiteQualification.FirstRecord())_newline { _newline  sTransferType = bcSiteQualification.GetFieldValue(&quot;NBN Transfer Type&quot;);_newline }_newline    _newline  }_newline  _newline  }_newline   _newline  _newline _newline  Outputs.SetProperty(&quot;NBNTransferType&quot;,sTransferType);_newline  _newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcSQList = null;_newline  bcSiteQualification = null;_newline  bcOrderItem1 = null;_newline  bcOrder1 = null;_newline  boOrder1 = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mGetSQTransferType"
 Sequence="22"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//Your public declarations go here...  _newline_newlinefunction mGetServiceProviderRef(sOrderId,sServiceOrderId,Outputs)_newline{_newlinevar sNewServProv, sSiebelProdType, sSpecialSiebelType=&quot;&quot;; //Ravindra:12/07/2024: Added for SMB Phase2_newlinevar boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  if(sOrderId != &quot;&quot; &amp;&amp; sServiceOrderId != &quot;&quot;)_newline  {_newline_newline   bcOrder.SetViewMode(AllView);_newline   bcOrder.ClearToQuery();_newline   bcOrderItem.ActivateField(&quot;Service Provider Reference&quot;);_newline   bcOrderItem.ActivateField(&quot;VHA Special Rate List Type&quot;); //Ravindra:12/07/2024: Added for SMB Phase2_newline   bcOrderItem.ActivateField(&quot;VF Siebel Product Type&quot;);_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Id&quot;,sServiceOrderId);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if(bcOrderItem.FirstRecord())_newline   {_newline   sNewServProv = bcOrderItem.GetFieldValue(&quot;Service Provider Reference&quot;);_newline   sSiebelProdType = bcOrderItem.GetFieldValue(&quot;VF Siebel Product Type&quot;);_newline   sSpecialSiebelType = bcOrderItem.GetFieldValue(&quot;VHA Special Rate List Type&quot;); //Ravindra:12/07/2024: Added for SMB Phase2_newline   }_newline  }_newline Outputs.SetProperty(&quot;ServProvRef&quot;,sNewServProv);_newline Outputs.SetProperty(&quot;SiebelProdType&quot;,sSiebelProdType);_newline Outputs.SetProperty(&quot;SpecialSiebelType&quot;,sSpecialSiebelType); //Ravindra:12/07/2024: Added for SMB Phase2_newline}_newline"
 Program_spcLanguage="JS"
 Name="mGetServiceProviderRef"
 Sequence="20"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mInvokeArcadyanACS(Inputs,Outputs,sOrderSubType,sServiceOrderId,psOutputs2,sACSProvFlag )_newline{_newlinetry_newline{_newline//var sACSProvFlag=&quot;&quot;;_newline if(sOrderSubType != &quot;Connect&quot;)_newline {_newline  var sProductCode = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline  var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usARC_usPROD_usCODE&quot;, sProductCode);_newline  if(stparcfnd==&quot;Y&quot;)_newline  {_newline  sACSProvFlag = &quot;N&quot;; _newline  }_newline  if(stparcfnd==&quot;N&quot;)_newline  {_newline  sACSProvFlag = &quot;Y&quot;; _newline  }_newline }_newline else_newline {_newline  var boModem = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline  var bcModem = boModem.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline  bcModem.SetViewMode(AllView);_newline  bcModem.ClearToQuery();_newline  bcModem.ActivateField(&quot;Product Code&quot;);_newline  bcModem.SetSearchSpec(&quot;Root Order Line Item&quot;,sServiceOrderId);_newline  bcModem.ExecuteQuery(ForwardOnly);_newline  if(bcModem.FirstRecord())_newline  {_newline  var sProductCode = bcModem.GetFieldValue(&quot;Product Code&quot;);_newline  }_newline  var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usARC_usPROD_usCODE&quot;, sProductCode);_newline  if(stparcfnd==&quot;Y&quot;)_newline  {_newline  sACSProvFlag = &quot;N&quot;; _newline  }_newline  if(stparcfnd==&quot;N&quot;)_newline  {_newline  sACSProvFlag = &quot;Y&quot;; _newline  }_newline }_newline return (sACSProvFlag);_newline} _newlinecatch(e)_newline{_newlinethrow e;_newline}_newlinefinally_newline{_newline_newline_newline}_newline}_newline"
 Program_spcLanguage="JS"
 Name="mInvokeArcadyanACS"
 Sequence="23"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mInvokeSpeedCheckAllOrder(Inputs,Outputs)_newline{_newline//Sathish: Created for NBNR: 17-Feb-2022_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;Order Item XA&quot;);_newline  var sOrderId =Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sServiceOrderId =Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline  var strOrderSubFunction =Inputs.GetProperty(&quot;OrderSubFunction&quot;);_newline  var sCustAssetIntegId = Inputs.GetProperty(&quot;CustAssetIntegId&quot;);_newline  var sOrderType = Inputs.GetProperty(&quot;OrderSubType&quot;);_newline  var sOldSpeed = Inputs.GetProperty(&quot;OldNBNSpeed&quot;);_newline  var sDeleteRootLine=&quot;&quot;;_newline  var sNBNSpeed = &quot;&quot;;_newline  var sCount = &quot;&quot;;_newline  var sParentOrderStatus = &quot;&quot;;_newline  var sParentOrderId = &quot;&quot;;_newline  var sIsBoosterSpeedAvailable = &quot;N&quot;;_newline  var sNewSpeed = &quot;&quot;;_newline  var sSpeedChangeFlg = &quot;N&quot;;_newline  var vOldSpeedArray = new Array();_newline  var vNewSpeedArray = new Array();_newline  var sSearchspec =&quot;&quot;;_newline_newline  _newline  if(sOrderId != &quot;&quot; &amp;&amp; sServiceOrderId != &quot;&quot;)_newline  { _newline_newline   bcOrder.ActivateField(&quot;VF Parent Order Status&quot;);_newline   bcOrder.ActivateField(&quot;Parent Order Id&quot;);_newline   bcOrder.SetViewMode(AllView);_newline   bcOrderItem.ActivateField(&quot;VHA FBB Service Count&quot;);_newline   bcOrderItem.ActivateField(&quot;Action Code&quot;);_newline   bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   _newline   bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;,sServiceOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Product Type&quot;,&quot;Billing - Recurring&quot;);_newline   bcOrderItem.SetSearchSpec(&quot;Action Code&quot;,&quot;&lt;&gt; Delete&quot;);_newline   _newline   //var sAttrSearchspec = &quot;([Name] =&apos;NBN Speed&apos; OR [Name] = &apos;Speed&apos;)&quot;;_newline   var sAttrSearchspec = &quot;([Name] =&apos;NBN Speed&apos; OR [Name] = &apos;Speed&apos; OR [Name]=&apos;FBB Speed&apos;)&quot;;_newline   bcOrderItemXA.SetSearchExpr(sAttrSearchspec);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if(bcOrder.FirstRecord())_newline   {_newline    var isRecLine = bcOrderItem.FirstRecord();_newline_newline    _newline    while (isRecLine)_newline    {_newline     var sLineActioncd = bcOrderItem.GetFieldValue(&quot;Action Code&quot;);    _newline     var isRecAttr = bcOrderItemXA.FirstRecord();_newline     while (isRecAttr)_newline     {_newline      if (sLineActioncd == &quot;Add&quot;)_newline      {_newline       if ( bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;Speed&apos;)_newline       {_newline        //Outputs.SetProperty(&quot;NBNSpeed&quot;,bcOrderItemXA.GetFieldValue(&quot;Value&quot;));_newline        sNewSpeed =bcOrderItemXA.GetFieldValue(&quot;Value&quot;)_newline        sIsBoosterSpeedAvailable = &quot;Y&quot;;_newline  _newline       }_newline       else if ((bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;NBN Speed&apos; || bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;FBB Speed&apos;)&amp;&amp; sIsBoosterSpeedAvailable==&apos;N&apos;)_newline       //else if (bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;NBN Speed&apos; &amp;&amp; sIsBoosterSpeedAvailable==&apos;N&apos;)_newline       {_newline        //Outputs.SetProperty(&quot;NBNSpeed&quot;,bcOrderItemXA.GetFieldValue(&quot;Value&quot;));_newline        sNewSpeed =bcOrderItemXA.GetFieldValue(&quot;Value&quot;); _newline      _newline       }_newline       else_newline       {_newline        sNewSpeed = &quot;&quot;; _newline       }_newline      }_newline      else_newline      {_newline      sNewSpeed = bcOrderItemXA.GetFieldValue(&quot;Value&quot;);_newline      //sOldSpeed=&quot;&quot;; _newline      }_newline      isRecAttr=bcOrderItemXA.NextRecord(); _newline     }_newline     isRecLine=bcOrderItem.NextRecord(); _newline    }_newline   }_newline_newline   if (sIsBoosterSpeedAvailable == &quot;Y&quot;)_newline   {_newline    sSpeedChangeFlg = &quot;Y&quot;;_newline   }_newline   else if (sOldSpeed != &quot;&quot; &amp;&amp; sOldSpeed != null)_newline   {  _newline   vOldSpeedArray = sOldSpeed.split(&quot;/&quot;);  _newline   _newline   _newline    if (sNewSpeed != &quot;&quot; &amp;&amp; sNewSpeed != null)   _newline    vNewSpeedArray = sNewSpeed.split(&quot;/&quot;);_newline    _newline    _newline    if (vOldSpeedArray[0] != &quot;&quot; &amp;&amp; vNewSpeedArray[0] != null)_newline    {_newline     if(vOldSpeedArray[0] != vNewSpeedArray[0])_newline     {_newline     sSpeedChangeFlg = &quot;Y&quot;;      _newline     _newline     } _newline    _newline    }_newline   }_newline_newline   _newline   Outputs.SetProperty(&quot;NBNSpeed&quot;,sNewSpeed);_newline   Outputs.SetProperty(&quot;SpeedChangeFlag&quot;,sSpeedChangeFlg);_newline  _newline  }_newline  //throw(&quot;END&quot;); _newline  _newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder= null;_newline  bcOrderItem = null;_newline  bcOrderItemXA = null;_newline  boOrder = null;_newline }_newline_newline_newline}"
 Program_spcLanguage="JS"
 Name="mInvokeSpeedCheckAllOrder"
 Sequence="24"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mInvokeTPLinkACS(Inputs,Outputs,sOrderSubType,sServiceOrderId,psOutputs2,sACSProvFlag )_newline{_newlinetry_newline{_newline//var sACSProvFlag=&quot;&quot;;_newline if(sOrderSubType != &quot;Connect&quot;)_newline {_newline  var sProductCode = psOutputs2.GetProperty(&quot;Device Code&quot;);_newline  var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usTPARC_usPROD_usCODE&quot;, sProductCode);_newline  if(stparcfnd==&quot;Y&quot;)_newline  {_newline  sACSProvFlag = &quot;N&quot;; _newline  }_newline }_newline else_newline {_newline  var boModem = TheApplication().GetBusObject(&quot;Order Entry (Sales)&quot;);_newline  var bcModem = boModem.GetBusComp(&quot;VF Allocate IMEI&quot;);_newline  bcModem.SetViewMode(AllView);_newline  bcModem.ClearToQuery();_newline  bcModem.ActivateField(&quot;Product Code&quot;);_newline  bcModem.SetSearchSpec(&quot;Root Order Line Item&quot;,sServiceOrderId);_newline  bcModem.ExecuteQuery(ForwardOnly);_newline  if(bcModem.FirstRecord())_newline  {_newline  var sProductCode = bcModem.GetFieldValue(&quot;Product Code&quot;);_newline  }_newline  var stparcfnd= TheApplication().InvokeMethod(&quot;LookupValue&quot;, &quot;VF_usMODEM_usTPARC_usPROD_usCODE&quot;, sProductCode);_newline  if(stparcfnd==&quot;Y&quot;)_newline  {_newline  sACSProvFlag = &quot;N&quot;; _newline  }_newline }_newline return (sACSProvFlag);_newline}_newlinecatch(e)_newline{_newlinethrow e;_newline}_newlinefinally_newline{_newline_newline}_newline}"
 Program_spcLanguage="JS"
 Name="mInvokeTPLinkACS"
 Sequence="25"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mQueryIMEIList(Inputs, Outputs)_newline{_newline    /* Created for SMB Phase 2 - 12/07/2024 */_newline  try_newline  {    _newline  var boVFIMEIList = TheApplication().GetBusObject(&quot;VF IMEI List&quot;);_newline  var bcVFIMEIList = boVFIMEIList.GetBusComp(&quot;VF IMEI List&quot;);_newline  var boOrder  = TheApplication().GetBusObject(&quot;Order Entry&quot;);_newline  var bcOrder  = boOrder.GetBusComp(&quot;Order Entry - Orders&quot;);    _newline _newline  var sIMEI = Inputs.GetProperty(&quot;IMEI&quot;);_newline  var sOrderId = Inputs.GetProperty(&quot;Order Id&quot;); _newline  var sProductCode = &quot;&quot;; _newline  _newline  with(bcVFIMEIList)_newline  {_newline   SetViewMode(AllView)_newline   ClearToQuery();   _newline   ActivateField(&quot;Product Code&quot;); _newline   SetSearchSpec(&quot;IMEI&quot;, sIMEI);  _newline   ExecuteQuery(ForwardOnly); _newline   if (FirstRecord())   _newline   {    _newline    sProductCode = GetFieldValue(&quot;Product Code&quot;);      _newline   }   _newline   _newline  } // end of  with bcIMEIList_newline  _newline  Outputs.SetProperty(&quot;Product Code&quot;, sProductCode);_newline  return(ContinueOperation);  _newline  }_newline catch(e)_newline { _newline  if (defined(e.errText))_newline  {_newline   var strError = e.errText + &quot;\r\n&quot; + e.toString(); _newline  }_newline  else_newline  {_newline   var strError = e.toString(); _newline  }_newline   // Trace Statement_newline_newline   if (TheApplication().GetProfileAttr(&quot;TraceOn&quot;) == &quot;Y&quot;)_newline  {_newline   TheApplication().Trace(&quot;START:VF IMEI Toolkit Service.mQueryIMEIList&quot; + strError);_newline  } _newline_newline  throw (strError);_newline }_newline  finally_newline  {_newline  // Destroy Objects_newline  bcVFIMEIList = null;_newline  bcOrder = null;_newline  boVFIMEIList = null;_newline  boOrder = null;_newline  }_newline _newline}"
 Program_spcLanguage="JS"
 Name="mQueryIMEIList"
 Sequence="26"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//Sathish: Created for NBNR: 17-Sep-2021_newline//NROY: Updated 19-Sep-2025 -&gt; Fix for CM-4993_newlinefunction mQueryOrderdetails(Inputs, Outputs) {_newline_newline    try {_newline        var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline        var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline        var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline        var bcOrderItemXA = boOrder.GetBusComp(&quot;Order Item XA&quot;);_newline        var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline        var sServiceOrderId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline        var strOrderSubFunction = Inputs.GetProperty(&quot;OrderSubFunction&quot;);_newline        var sNBNSpeed = &quot;&quot;;_newline        var sCount = &quot;&quot;;_newline        var sParentOrderStatus = &quot;&quot;;_newline        var sParentOrderId = &quot;&quot;;_newline        var sIsBoosterSpeedAvailable = &quot;N&quot;;_newline  _newline  var sBasePlanSpeed = &quot;&quot;, sBasePlanDeleteSpeed = &quot;&quot;;_newline  var sSpeedBoostSpeed = &quot;&quot;, sSpeedBoostDeleteSpeed = &quot;&quot;;_newline  var sFinalSpeed = &quot;&quot;;_newline_newline        Inputs.SetProperty(&quot;CVCId&quot;, &quot;&quot;);_newline        Outputs.SetProperty(&quot;ParentOrderStatus&quot;, &quot;&quot;);_newline        Outputs.SetProperty(&quot;ParentOrderId&quot;, &quot;&quot;);_newline        if (sOrderId != &quot;&quot; &amp;&amp; sServiceOrderId != &quot;&quot;) {_newline            bcOrder.ActivateField(&quot;VF Parent Order Status&quot;);_newline            bcOrder.ActivateField(&quot;Parent Order Id&quot;);_newline            bcOrder.SetViewMode(AllView);_newline            bcOrderItem.ActivateField(&quot;VHA FBB Service Count&quot;);_newline            bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline   bcOrderItemXA.ActivateField(&quot;Action Code&quot;);_newline            bcOrder.ClearToQuery();_newline            bcOrder.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline            bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;, sServiceOrderId);_newline            //bcOrderItem.SetSearchSpec(&quot;Service Type&quot;,&quot;Fixed NBN&quot;);_newline            bcOrderItem.SetSearchSpec(&quot;Product Type&quot;, &quot;Billing - Recurring&quot;);_newline_newline            if (strOrderSubFunction == &quot;Change Location Connect&quot;) {_newline                bcOrderItem.SetSearchSpec(&quot;Action Code&quot;, &quot;&lt;&gt; Delete&quot;);_newline            }_newline            var sAttrSearchspec = &quot;([Name] =&apos;NBN Speed&apos; OR [Name] = &apos;Speed&apos; OR [Name] =&apos;FBB Speed&apos;)&quot;;_newline            bcOrderItemXA.SetSearchExpr(sAttrSearchspec);_newline            bcOrder.ExecuteQuery(ForwardOnly);_newline   _newline            if (bcOrder.FirstRecord()) {_newline                var isRecLine = bcOrderItem.FirstRecord();_newline                while (isRecLine) {_newline                    var isRecAttr = bcOrderItemXA.FirstRecord();_newline                    while (isRecAttr) {_newline                        if (bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;Speed&apos;) {_newline                            if(bcOrderItemXA.GetFieldValue(&quot;Action Code&quot;) == &apos;Delete&apos;)_newline        sSpeedBoostDeleteSpeed = bcOrderItemXA.GetFieldValue(&quot;Value&quot;);_newline       else_newline        sSpeedBoostSpeed = bcOrderItemXA.GetFieldValue(&quot;Value&quot;);_newline                        } else if (bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;NBN Speed&apos; || bcOrderItemXA.GetFieldValue(&quot;Name&quot;) == &apos;FBB Speed&apos;) {_newline       if(bcOrderItemXA.GetFieldValue(&quot;Action Code&quot;) == &apos;Delete&apos;)_newline        sBasePlanDeleteSpeed = bcOrderItemXA.GetFieldValue(&quot;Value&quot;);_newline       else_newline        sBasePlanSpeed = bcOrderItemXA.GetFieldValue(&quot;Value&quot;);_newline      }_newline                        isRecAttr = bcOrderItemXA.NextRecord();_newline                    }_newline                    isRecLine = bcOrderItem.NextRecord();_newline                }_newline    if(sSpeedBoostSpeed !=&quot;&quot; &amp;&amp; sSpeedBoostSpeed !=null)_newline     sFinalSpeed = sSpeedBoostSpeed;_newline    else if (sBasePlanSpeed !=&quot;&quot; &amp;&amp; sBasePlanSpeed !=null)_newline     sFinalSpeed = sBasePlanSpeed;_newline    else if (sBasePlanDeleteSpeed !=&quot;&quot; &amp;&amp; sBasePlanDeleteSpeed !=null)_newline     sFinalSpeed = sBasePlanDeleteSpeed;_newline    _newline    Outputs.SetProperty(&quot;NBNSpeed&quot;, sFinalSpeed);_newline            }_newline        }_newline    } catch (e) {_newline        throw (e);_newline    } finally {_newline        bcOrder = null;_newline        bcOrderItem = null;_newline        bcOrderItemXA = null;_newline        boOrder = null;_newline    }_newline}"
 Program_spcLanguage="JS"
 Name="mQueryOrderdetails"
 Sequence="27"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mSetConfirmationCode(Inputs,Outputs)_newline{_newline try_newline  {_newline      var boOrder = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);_newline   var bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline  var bcOrderLine = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sRootOrderId = Inputs.GetProperty(&quot;SerOrderId&quot;);_newline  var sConfirmationCode = Inputs.GetProperty(&quot;ConfirmationCode&quot;);_newline  var sMSISDN, sNewMSISDN = &quot;&quot;;_newline  _newline  with(bcOrder)_newline  {_newline   ActivateField(&quot;VHA Confirmation Code&quot;);_newline   ClearToQuery();_newline   SetViewMode(AllView);_newline   SetSearchSpec(&quot;Id&quot;, sOrderId);_newline   ExecuteQuery(ForwardOnly);_newline   if(FirstRecord())_newline   {_newline    SetFieldValue(&quot;VHA Confirmation Code&quot;,sConfirmationCode);_newline    WriteRecord();_newline   }_newline  }_newline  with(bcOrderLine)_newline  {_newline   ActivateField(&quot;MSISDN&quot;);_newline   ActivateField(&quot;New MSISDN&quot;);_newline   ClearToQuery();_newline   SetViewMode(AllView);_newline   SetSearchSpec(&quot;Id&quot;, sRootOrderId);_newline   ExecuteQuery(ForwardOnly);_newline   if(FirstRecord())_newline   {_newline    sNewMSISDN = GetFieldValue(&quot;New MSISDN&quot;);_newline    sMSISDN = GetFieldValue(&quot;MSISDN&quot;);    _newline   }_newline_newline_newline_newline  }_newline_newline  Outputs.SetProperty(&quot;NewMSISDN&quot;,sNewMSISDN);_newline  Outputs.SetProperty(&quot;MSISDN&quot;,sMSISDN);_newline _newline  }_newline catch(e)_newline {_newline  if (defined(e.errText))_newline  {_newline   var strError = arguments.callee + e.errText + &quot;\r\n&quot; + ToString(e); _newline  }_newline  else_newline  {_newline   var strError = arguments.callee + ToString(e);_newline  }_newline  TheApplication().RaiseErrorText(strError);_newline }_newline  finally_newline  {_newline  bcOrder = null;_newline  boOrder = null;_newline  }_newline} _newline"
 Program_spcLanguage="JS"
 Name="mSetConfirmationCode"
 Sequence="28"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateCOLNBNAttributes(Inputs,Outputs)_newline{_newline//SG 12-12-24 Created for Imagine_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline  _newline  var sProdSubTypeCode= &quot;&quot;;_newline  var sGetTimeStamp = &quot;&quot;;_newline  var irec = &quot;&quot;;_newline  _newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  //var sServiceOrderId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline  _newlinevar sTransferType= Inputs.GetProperty(&quot;SQTransferType&quot;);_newlinevar sOrderSubFunction = Inputs.GetProperty(&quot;OrdersubFunction &quot;);_newline_newline  var sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Action Code]&lt;&gt; &apos;Delete&apos; AND ([Parent Order Item Id] IS NULL OR [Service Type] = &apos;NBN&apos; OR [Service Type] = &apos;OPTICOM&apos; OR [Service Type] = &apos;VISION&apos;)&quot;;_newline  _newline  if(sOrderId != &quot;&quot;)_newline  {_newline   bcOrder.SetViewMode(AllView);_newline   bcOrder.ClearToQuery();_newline   bcOrderItem.ActivateField(&quot;Action Code&quot;);_newline   bcOrderItem.ActivateField(&quot;Service Id&quot;);_newline   bcOrderItem.ActivateField(&quot;Parent Order Item Id&quot;);_newline   bcOrderItem.ActivateField(&quot;Product Sub Type Code&quot;);_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchExpr(sSearchspec);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline_newline   if(bcOrder.FirstRecord() &amp;&amp; bcOrderItem.FirstRecord())_newline   {_newline    irec =bcOrderItem.FirstRecord(); _newline    while(irec)_newline    {_newline     _newline     _newline     sProdSubTypeCode = bcOrderItem.GetFieldValue(&quot;Product Sub Type Code&quot;);_newline     sGetTimeStamp = bcOrderItem.GetFieldValue(&quot;Get Time Stamp&quot;);    _newline     _newline     var sParOrdItem = bcOrderItem.GetFieldValue(&quot;Parent Order Item Id&quot;);_newline_newline     if ( sParOrdItem != &quot;&quot; &amp;&amp; sParOrdItem != null &amp;&amp; sProdSubTypeCode != &quot;Resource Specification&quot; )_newline     {_newline     var sAttrRec = bcOrderItemXA.FirstRecord();_newline_newline     while(sAttrRec)_newline     {_newline        var sAttribName = bcOrderItemXA.GetFieldValue(&quot;Display Name&quot;);_newline        _newline            _newline      if(sAttribName == &quot;Transfer Type&quot;)_newline      {_newline       bcOrderItemXA.SetFieldValue(&quot;Text Value&quot;,sTransferType);_newline_newline      }_newline_newline_newline      bcOrderItemXA.WriteRecord();_newline_newline      sAttrRec = bcOrderItemXA.NextRecord();_newline     }_newline     _newline    }_newline    irec =bcOrderItem.NextRecord(); _newline    }_newline   }_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrderItem = null;_newline  bcOrder = null;_newline  boOrder = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateCOLNBNAttributes"
 Sequence="29"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateCVCId(Inputs,Outputs)_newline{_newline//Sathish - 26-12-23 Created for Fibre Connect_newline try_newline {_newline var sOrderId,sRootOrderItemId,sCVCId =&quot;&quot;;  _newline sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline sRootOrderItemId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline_newline_newline_newline_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline  var bcSiteQualification = boOrder.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline    _newline   if(sOrderId != &quot;&quot; &amp;&amp; sRootOrderItemId != &quot;&quot;)_newline   {_newline_newline   bcOrder.SetViewMode(AllView);_newline   bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline   bcSiteQualification.ActivateField(&quot;Selected CVC&quot;);_newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;,sRootOrderItemId);_newline   bcSiteQualification.SetSearchSpec(&quot;Order Header Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Service Type&quot;,&quot;NBN&quot;);_newline   bcOrderItem.SetSearchSpec(&quot;Product Sub Type Code&quot;,&quot;Service Specification&quot;);_newline   bcOrderItemXA.SetSearchSpec(&quot;Name&quot;,&quot;CVC Id&quot;);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline//throw(bcSiteQualification.FirstRecord());_newline    if (bcSiteQualification.FirstRecord())_newline    {_newline    sCVCId = bcSiteQualification.GetFieldValue(&quot;Selected CVC&quot;);_newline_newline//throw( sCVCId);_newline    }_newline    _newline    if(bcOrderItem.FirstRecord() &amp;&amp; bcOrderItemXA.FirstRecord() &amp;&amp; sCVCId!= &quot;&quot;)_newline    { _newline    _newline   if (bcOrderItemXA.GetFieldValue(&quot;Value&quot;) == &quot;&quot;)_newline   {_newline   bcOrderItemXA.SetFieldValue(&quot;Value&quot;,sCVCId);_newline   bcOrderItemXA.WriteRecord();_newline   _newline   }_newline    }_newline_newline    //Update NBN attributes_newline    //Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline    //mUpdateNBNAttributes(Inputs,Outputs);_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  bcOrderItem = null;_newline  bcOrderItemXA = null;_newline  boOrder = null;_newline }_newline}_newline"
 Program_spcLanguage="JS"
 Name="mUpdateCVCId"
 Sequence="30"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateCVCIdFromIntOrd(Inputs,Outputs)_newline{_newline//Sathish - 26-12-23 Created for Fibre Connect_newline try_newline {_newline var sOrderId,sRootOrderItemId,sCVCId =&quot;&quot;;  _newline sOrderId = Inputs.GetProperty(&quot;FibOrderId&quot;);_newline sRootOrderItemId = Inputs.GetProperty(&quot;FibSerOrdId&quot;);_newline _newline sCVCId = Inputs.GetProperty(&quot;CVC Id&quot;);_newline_newline_newline_newline_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline  _newline    _newline   if(sOrderId != &quot;&quot; &amp;&amp; sRootOrderItemId != &quot;&quot; &amp;&amp; sCVCId != &quot;&quot;)_newline   {_newline_newline   bcOrder.SetViewMode(AllView);_newline   bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;,sRootOrderItemId);_newline   bcOrderItem.SetSearchSpec(&quot;Service Type&quot;,&quot;NBN&quot;);_newline   bcOrderItem.SetSearchSpec(&quot;Product Sub Type Code&quot;,&quot;Service Specification&quot;);_newline   bcOrderItemXA.SetSearchSpec(&quot;Name&quot;,&quot;CVC Id&quot;);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline_newline      _newline    if(bcOrderItem.FirstRecord() &amp;&amp; bcOrderItemXA.FirstRecord() &amp;&amp; sCVCId!= &quot;&quot;)_newline    { _newline_newline   if (bcOrderItemXA.GetFieldValue(&quot;Value&quot;) == &quot;&quot;)_newline   {_newline// throw(&quot;here&quot;);   _newline   bcOrderItemXA.SetFieldValue(&quot;Value&quot;,sCVCId);_newline   bcOrderItemXA.WriteRecord();_newline   _newline   }_newline    }_newline_newline    //Update NBN attributes_newline    Inputs.SetProperty(&quot;OrderId&quot;,sOrderId);_newline    //mUpdateNBNAttributes(Inputs,Outputs);_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  bcOrderItem = null;_newline  bcOrderItemXA = null;_newline  boOrder = null;_newline }_newline}_newline"
 Program_spcLanguage="JS"
 Name="mUpdateCVCIdFromIntOrd"
 Sequence="31"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateNBNAttributes(Inputs,Outputs)_newline{_newline//SG 08-03-24 Created for Fibre upgrade Drop2 - To Update NBN Attributes for Interim Order_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline  _newline  var sProdSubTypeCode= &quot;&quot;;_newline  var sGetTimeStamp = &quot;&quot;;_newline  var irec = &quot;&quot;;_newline  _newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  //var sServiceOrderId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline  var sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND ([Parent Order Item Id] IS NULL OR [Service Type] = &apos;NBN&apos;)&quot;;_newline  _newline  if(sOrderId != &quot;&quot;)_newline  {_newline   bcOrder.SetViewMode(AllView);_newline   bcOrder.ClearToQuery();_newline   bcOrderItem.ActivateField(&quot;Action Code&quot;);_newline   bcOrderItem.ActivateField(&quot;Service Id&quot;);_newline   bcOrderItem.ActivateField(&quot;Parent Order Item Id&quot;);_newline   bcOrderItem.ActivateField(&quot;Product Sub Type Code&quot;);_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchExpr(sSearchspec);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if(bcOrder.FirstRecord() &amp;&amp; bcOrderItem.FirstRecord())_newline   {_newline    irec =bcOrderItem.FirstRecord(); _newline    while(irec)_newline    {_newline     _newline     _newline     sProdSubTypeCode = bcOrderItem.GetFieldValue(&quot;Product Sub Type Code&quot;);_newline     sGetTimeStamp = bcOrderItem.GetFieldValue(&quot;Get Time Stamp&quot;);    _newline     _newline     var sParOrdItem = bcOrderItem.GetFieldValue(&quot;Parent Order Item Id&quot;);_newline     if ( sParOrdItem != &quot;&quot; &amp;&amp; sParOrdItem != null &amp;&amp; sProdSubTypeCode != &quot;Resource Specification&quot; )_newline     {_newline     var sAttrRec = bcOrderItemXA.FirstRecord();_newline     while(sAttrRec)_newline     {_newline        var sAttribName = bcOrderItemXA.GetFieldValue(&quot;Display Name&quot;);_newline        _newline      if(sAttribName == &quot;Customer Authority Date&quot;)_newline      {_newline       bcOrderItemXA.SetFieldValue(&quot;Text Value&quot;,sGetTimeStamp);_newline_newline      }_newline      if(sAttribName == &quot;Installation Workforce&quot;)_newline      {_newline       bcOrderItemXA.SetFieldValue(&quot;Text Value&quot;,&quot;&quot;);_newline_newline      }_newline      if(sAttribName == &quot;Installation Options - Jumpering&quot;)_newline      {_newline       bcOrderItemXA.SetFieldValue(&quot;Text Value&quot;,&quot;No&quot;);_newline_newline      }_newline      if(sAttribName == &quot;Transfer Type&quot;)_newline      {_newline       bcOrderItemXA.SetFieldValue(&quot;Text Value&quot;,&quot;Service Transfer&quot;);_newline_newline      }_newlineif(sAttribName == &quot;Local Number Porting&quot;)_newline      {_newline       bcOrderItemXA.SetFieldValue(&quot;Text Value&quot;,&quot;&quot;);_newline_newline      }_newline_newline      bcOrderItemXA.WriteRecord();_newline_newline      sAttrRec = bcOrderItemXA.NextRecord();_newline     }_newline     _newline    }_newline    irec =bcOrderItem.NextRecord(); _newline    }_newline   }_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrderItem = null;_newline  bcOrder = null;_newline  boOrder = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateNBNAttributes"
 Sequence="32"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateOVCId(Inputs,Outputs,sOrderId,sOVCId,sRootOrderItemId)_newline{_newline/*_newline * Component Name        :  VHA FBB BS_newline * Method Name           :  mUpdateCVCId_newline * * Modification History  :_newline * Date   Author  Config # Description      Comments_newline * ============ =========== =========== ================================_newline * 02/10/2024   SATHISH G    R1.1 IMAGINE Initial Version  To update the OVC Id Attribute_newline */_newline try_newline {_newline  var boOrder = TheApplication().GetBusObject(&quot;VHA Order Entry Orders Thin BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VHA Order Entry Orders Query Thin&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VHA Order Entry Line Items Query Thin&quot;);_newline  var bcOrderItemXA = boOrder.GetBusComp(&quot;VF Order Item XA&quot;);_newline    _newline  if(sOrderId != &quot;&quot; &amp;&amp; sRootOrderItemId != &quot;&quot;)_newline  {_newline   bcOrder.SetViewMode(AllView);_newline   bcOrderItemXA.ActivateField(&quot;Value&quot;);_newline   bcOrder.ClearToQuery();_newline   bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline   bcOrderItem.SetSearchSpec(&quot;Root Order Item Id&quot;,sRootOrderItemId);_newline   bcOrderItem.SetSearchSpec(&quot;Service Type&quot;,&quot;OPTICOM&quot;);_newline   bcOrderItem.SetSearchSpec(&quot;Product Sub Type Code&quot;,&quot;Service Specification&quot;);_newline   bcOrderItemXA.SetSearchSpec(&quot;Name&quot;,&quot;OVC Id&quot;);_newline   bcOrder.ExecuteQuery(ForwardOnly);_newline   if(bcOrderItem.FirstRecord() &amp;&amp; bcOrderItemXA.FirstRecord())_newline   {    _newline    bcOrderItemXA.SetFieldValue(&quot;Value&quot;,sOVCId);_newline    bcOrderItemXA.WriteRecord();_newline   }_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  bcOrderItem = null;_newline  bcOrderItemXA = null;_newline  boOrder = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateOVCId"
 Sequence="34"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateOpticomVisionAttributes(Inputs,Outputs)_newline{_newline/*_newline * Component Name        :  VHA FBB BS_newline * Method Name           :  mUpdateCVCId_newline * * Modification History  :_newline * Date   Author  Config # Description      Comments_newline * ============ =========== =========== ================================_newline * 02/10/2024   SATHISH G    R1.1 IMAGINE Initial Version  To update the OPTICOM VISION Order Line Item Attributes_newline */_newline try_newline {_newline  var sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sRootOrderItemId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline  var sSQSelectedCVC = Inputs.GetProperty(&quot;SQSelectedCVC&quot;);_newline  var sNetworkIdentifier = Inputs.GetProperty(&quot;NetworkIdentifier&quot;);_newline  var sOpticommNetwork = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNETWORK_usPROVIDER&quot;,&quot;OPTICOMM&quot;);_newline  var sVisionNetwork = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNETWORK_usPROVIDER&quot;,&quot;VISION&quot;);_newline  var sNBNNetwork = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usNETWORK_usPROVIDER&quot;,&quot;NBN&quot;);_newline  if (sNetworkIdentifier == sOpticommNetwork)_newline  {_newline   //Selected CVC From SQ BC will be passed to update OVC Id for Opticomm_newline   mUpdateOVCId(Inputs,Outputs,sOrderId,sSQSelectedCVC,sRootOrderItemId);_newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline }_newline} _newline_newline"
 Program_spcLanguage="JS"
 Name="mUpdateOpticomVisionAttributes"
 Sequence="33"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateReUseModemFlag(Inputs,Outputs)_newline{_newline//16/01/2025 - Sathish - Created for R1.1 Imagine_newlinetry_newline{_newlinevar boOrder = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);  _newlinevar bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);  _newlinevar bcOrderItem = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;); _newlinevar boOrder1 = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);  _newlinevar bcOrder1 = boOrder1.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);  _newlinevar bcOrderItem1 = boOrder1.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline_newlinevar sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline//var sRootId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newlinevar sRootId = Inputs.GetProperty(&quot;ServOrderId&quot;);_newline_newlinevar sLinkConnectOrder,sReUseModemFlag,sOrderSubType,sOrderSubFunction=&quot;&quot;;_newline_newline_newline if(sOrderId != &quot;&quot;)_newline {_newline_newline bcOrder.SetViewMode(AllView);_newline bcOrder.ActivateField(&quot;VHA FC Link Ord Id 1&quot;);_newline    bcOrder.ActivateField(&quot;Order Sub Type&quot;);_newline bcOrderItem.ActivateField(&quot;VF Reuse Modem Flg&quot;);_newline bcOrder.ClearToQuery();_newline bcOrder.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline bcOrderItem.SetSearchSpec(&quot;Id&quot;, sRootId);_newline bcOrder.ExecuteQuery(ForwardOnly);_newline_newline_newline_newline if (bcOrder.FirstRecord())_newline {_newline  sLinkConnectOrder = bcOrder.GetFieldValue(&quot;VHA FC Link Ord Id 1&quot;); _newline  sOrderSubType = bcOrder.GetFieldValue(&quot;Order Sub Type&quot;);_newline   _newline  if (sLinkConnectOrder != &quot;&quot; &amp;&amp;  sLinkConnectOrder  != null &amp;&amp; sOrderSubType== &quot;Disconnect&quot;)_newline  {_newline_newline  bcOrder1.SetViewMode(AllView);_newline  bcOrder1.ActivateField(&quot;VHA FC Link Ord Id 1&quot;);_newline  bcOrderItem1.ActivateField(&quot;VF Reuse Modem Flg&quot;);_newline  bcOrder1.ClearToQuery();_newline  bcOrder1.SetSearchSpec(&quot;Id&quot;, sLinkConnectOrder);_newline  bcOrderItem1.SetSearchSpec(&quot;Order Header Id&quot;, sLinkConnectOrder);  _newline  bcOrder1.ExecuteQuery();_newline_newline  if (bcOrder1.FirstRecord())_newline  {_newline_newline   if (bcOrderItem1.FirstRecord())_newline   {_newline_newline   sReUseModemFlag = bcOrderItem1.GetFieldValue(&quot;VF Reuse Modem Flg&quot;);_newline   if(sReUseModemFlag == &quot;Y&quot;)_newline   {_newline   var boOrder2 = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);  _newline   var bcOrder2 = boOrder2.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);  _newline   var bcOrderItem2 = boOrder2.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline   bcOrder2.SetViewMode(AllView);_newline   bcOrder2.ClearToQuery();_newline   bcOrderItem2.ActivateField(&quot;VF Reuse Modem Flg&quot;);_newline   bcOrder2.SetSearchSpec(&quot;Id&quot;, sOrderId);_newline   bcOrderItem2.SetSearchSpec(&quot;Id&quot;, sRootId);_newline   bcOrder2.ExecuteQuery(ForwardOnly);_newline_newline    if(bcOrderItem2.FirstRecord())_newline    {_newline    bcOrderItem2.SetFieldValue(&quot;VF Reuse Modem Flg&quot;,&quot;Y&quot;);_newline    bcOrderItem2.WriteRecord();_newline_newline_newline    }_newline   _newline   }_newline  else_newline  {_newline  //Call Calculate Charges to apply ETC charge_newline  _newline/*var bs = TheApplication().GetService(&quot;Workflow Process Manager&quot;);   _newlinevar Inps = TheApplication().NewPropertySet();_newline   var Outps = TheApplication().NewPropertySet();_newline   Inps.SetProperty(&quot;ProcessName&quot;,&quot;VF OM Calculate Charges&quot;);_newline   Inps.SetProperty(&quot;Object Id&quot;,sOrderId);_newline   Inps.SetProperty(&quot;SkipNavigation&quot;,&quot;TRUE&quot;);_newline Inps.SetProperty(&quot;NBNDisconnect&quot;,&quot;Y&quot;);_newline   bs.InvokeMethod(&quot;RunProcess&quot;,Inps, Outps);*/_newline//Delete charges_newlinevar bs = TheApplication().GetService(&quot;VF Calculate Charges Service MSO&quot;);   _newlinevar Inps = TheApplication().NewPropertySet();_newline   var Outps = TheApplication().NewPropertySet();_newline   Inps.SetProperty(&quot;Order Id&quot;,sOrderId);_newline   bs.InvokeMethod(&quot;DeleteCharges&quot;,Inps, Outps);_newline_newline//Add Charges_newlinevar bs = TheApplication().GetService(&quot;VF Calculate Charges Service C MSO&quot;);   _newlinevar Inps = TheApplication().NewPropertySet();_newline   var Outps = TheApplication().NewPropertySet();_newline   Inps.SetProperty(&quot;Order Id&quot;,sOrderId);_newline  // Inps.SetProperty(&quot;SkipNavigation&quot;,&quot;TRUE&quot;);_newline Inps.SetProperty(&quot;NBNDisconnect&quot;,&quot;Y&quot;);_newline   bs.InvokeMethod(&quot;CalculateCharges&quot;,Inps, Outps);_newline  _newline  _newline  }_newline  _newline  }_newline_newline  }_newline_newline  }_newline_newline _newline_newline }_newline }_newline}_newlinecatch (e)_newline{_newlinethrow (e);_newline}_newlinefinally_newline{_newlinebcOrderItem = null;_newlinebcOrderItem1 = null;_newlinebcOrderItem2 = null;_newlinebcOrder = null;_newlinebcOrder1 = null;_newlinebcOrder2 = null;_newlineboOrder = null;_newline_newline}_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateReUseModemFlag"
 Sequence="35"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateSQWorkOrdId(Inputs,Outputs)_newline{_newline//Sathish - 10-07-24 Created for Fibre upg ph2_newline try_newline {_newline var sOrderId,sRootOrderItemId,sCVCId =&quot;&quot;;  _newline sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline sRootOrderItemId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline_newline  _newline var boOrder = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);_newline var bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline var bcOrderItem = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline var bcSiteQualification = boOrder.GetBusComp(&quot;VHA Site Qualification BC&quot;);_newline    _newline   if(sOrderId != &quot;&quot; &amp;&amp; sRootOrderItemId != &quot;&quot;)_newline   {_newline_newline  bcOrder.SetViewMode(AllView);_newline  bcSiteQualification.ActivateField(&quot;Order Header Id&quot;);_newline  bcOrder.ClearToQuery();_newline  bcOrder.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline  bcOrderItem.SetSearchSpec(&quot;Id&quot;,sRootOrderItemId);_newline  bcSiteQualification.SetSearchSpec(&quot;Order Line Item Id&quot;,sRootOrderItemId);  _newline  bcOrder.ExecuteQuery(ForwardOnly);_newline_newline    if (bcSiteQualification.FirstRecord())_newline    {_newline    bcSiteQualification.SetFieldValue(&quot;Order Header Id&quot;,sOrderId);_newline bcSiteQualification.WriteRecord();_newline_newline_newline    }_newline    _newline   _newline_newline   _newline  }_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrder = null;_newline  bcOrderItem = null;_newline  boOrder = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateSQWorkOrdId"
 Sequence="36"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateServiceId(Inputs,Outputs)_newline{_newline/*_newline * Component Name        :  VHA FBB BS_newline * Method Name           :  mUpdateServiceId_newline * * Modification History  :_newline * Date   Author  Config # Description      Comments_newline * ============ =========== =========== ================================_newline * 07/04/2017   Vinodhini    Rel17.3    Initial Version  To update the Service Id in the Line Item_newline */_newline try_newline {_newline  var boOrderItem = TheApplication().GetBusObject(&quot;VF Order Entry - Line Items Thin&quot;);_newline  var bcOrderItem = boOrderItem.GetBusComp(&quot;VF Order Entry - Line Items Thin&quot;);_newline _newline  var sUNIDSL = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;NET_usELEM_usTYPE_usCD&quot;,&quot;UNI-DSL&quot;);_newline  var sNTD = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;NET_usELEM_usTYPE_usCD&quot;,&quot;NTD&quot;);_newline  _newline  var sOrderId =Inputs.GetProperty(&quot;OrderId&quot;);_newline  var sServiceId = Inputs.GetProperty(&quot;Service Id&quot;); _newline _newline  if(sOrderId != &quot;&quot;)_newline  {_newline   bcOrderItem.SetViewMode(AllView);_newline   bcOrderItem.ActivateField(&quot;Service Id&quot;);_newline   bcOrderItem.ClearToQuery();_newline   bcOrderItem.SetSearchExpr(&quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Service Type] = &apos;NBN&apos; AND ([Network Element Type] = &apos;&quot; + sUNIDSL + &quot;&apos; OR [Network Element Type] = &apos;&quot; + sNTD + &quot;&apos;)&quot;);_newline   bcOrderItem.ExecuteQuery(ForwardOnly);_newline   var isrec = bcOrderItem.FirstRecord();_newline_newline   while(isrec)_newline   {_newline    bcOrderItem.SetFieldValue(&quot;Service Id&quot;,sServiceId);_newline    bcOrderItem.WriteRecord();_newline    isrec =bcOrderItem.NextRecord();_newline   }_newline   _newline  } _newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline  bcOrderItem =null;_newline  boOrderItem =null;_newline }_newline_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateServiceId"
 Sequence="2"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpdateStartDate(Inputs,Outputs)_newline{_newline try_newline { _newline  var dtToday = Date.fromSystem(Clib.time());_newline  var sOrderId =Inputs.GetProperty(&quot;Order Id&quot;);_newlinevar sRootId = Inputs.GetProperty(&quot;Service Order Id&quot;);_newline  var sFormattedTodayDate = (dtToday.getMonth() + 1) + &quot;/&quot; + dtToday.getDate() + &quot;/&quot; + dtToday.getFullYear();_newline  var sFormattedTodayDateTime = sFormattedTodayDate + &quot; &quot; + dtToday.getHours() + &quot;:&quot; + dtToday.getMinutes() + &quot;:&quot; + dtToday.getSeconds();_newline  _newline  var boOrder = TheApplication().GetBusObject(&quot;VF Order Entry Thin BO&quot;);_newline  var bcOrderItem = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);_newline  _newline  with(bcOrderItem)_newline  {_newline   SetViewMode(AllView);_newline   ActivateField(&quot;Due Date&quot;);_newline   ClearToQuery();_newline   if(sRootId != &quot;&quot;)_newline    SetSearchExpr(&quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Root Order Item Id] = &apos;&quot; + sRootId + &quot;&apos; AND [Parent Order Item Id] IS NULL AND [Action Code] &lt;&gt; &apos;Delete&apos;&quot;);_newline     else_newline    SetSearchExpr(&quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL AND [Action Code] &lt;&gt; &apos;Delete&apos;&quot;);_newline   ExecuteQuery(ForwardOnly);_newline   if (FirstRecord())_newline   {_newline    SetFieldValue(&quot;Due Date&quot;,sFormattedTodayDateTime);_newline    WriteRecord();_newline   }   _newline  }_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  throw(e);_newline }_newline finally_newline {_newline   bcOrderItem = null;_newline   boOrder = null;_newline   sOrderId=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="mUpdateStartDate"
 Sequence="37"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mUpsertNBNAttributes(Inputs,Outputs)_newline{_newlinetry_newline{_newline  var sOrderId,sRootOrderItemId,sAccessTech,Speed, sActiveFlg,sOrgName,psInput2,psOutput2=&quot;&quot;;_newline  var svc1=&quot;&quot;;_newline  _newline  sOrgName= &quot;Vodafone AU&quot;;_newline  Speed = &quot;1000/50&quot;;_newline  sAccessTech=&quot;Fibre&quot;;_newline  sActiveFlg = &quot;Y&quot;;_newline  _newline  sOrderId = Inputs.GetProperty(&quot;OrderId&quot;);_newline  sRootOrderItemId = Inputs.GetProperty(&quot;ServiceOrderId&quot;);_newline  _newline  if (sOrderId  != &quot;&quot; &amp;&amp; sRootOrderItemId != &quot;&quot;)_newline  {_newline   /*psInput2 = TheApplication().NewPropertySet();_newline   psOutput2 = TheApplication().NewPropertySet();_newline   svc1 = TheApplication().GetService(&quot;VHA FBB BS&quot;);_newline   psInput2.SetProperty(&quot;OrderId&quot;,sOrderId);_newline   psInput2.SetProperty(&quot;ServiceOrderId&quot;,sRootOrderItemId);_newline   svc1.InvokeMethod(&quot;GetSpeedOLILevel&quot;, psInput2, psOutput2);_newline   Speed = psOutput2.GetProperty(&quot;NBNSpeed&quot;);*/_newline  _newline  var searchspec = &quot;[Order Entry - Orders.Id] = &apos;&quot; + sOrderId + &quot;&apos;&quot; + &quot; AND &quot; + &quot;([Order Entry - Line Items.Root Order Item Id] = &apos;&quot; + sRootOrderItemId + &quot;&apos;&quot; + &quot; AND&quot; + &quot; [Order Entry - Line Items.Service Type] = &apos;Fixed NBN&apos;&quot; + &quot; OR&quot; + &quot; [Order Entry - Line Items.Product Sub Type Code] = &apos;Service Specification&apos;)&quot; + &quot; AND&quot; + &quot; ([VHA Configuration List.Type] = &apos;VHA_usFBB_usPROD_usATTR_usMAP&apos;&quot; + &quot; AND &quot; + &quot; [VHA Configuration List.Name] = &apos;&quot; + sAccessTech + &quot;&apos; &quot; + &quot; AND &quot; + &quot;[VHA Configuration List.Value] = &apos;&quot; + Speed + &quot;&apos; &quot; + &quot; AND &quot; + &quot;[VHA Configuration List.Active Flg] = &apos;&quot; + sActiveFlg + &quot;&apos; &quot; + &quot; AND &quot; + &quot;[VHA Configuration List.Organization Name] = &apos;&quot; + sOrgName + &quot;&apos;)&quot;;_newline  _newline  _newline  var svc = TheApplication().GetService(&quot;Workflow Process Manager&quot;);_newline  var psInput = TheApplication().NewPropertySet();_newline  var psOutput = TheApplication().NewPropertySet();_newline  psInput.SetProperty(&quot;MapName&quot;,&quot;VHA NBN Order Product Attribute Map&quot;);_newline  psInput.SetProperty(&quot;OutputIntObjectName&quot;,&quot;VHA NBN Order Upsert IO&quot;);_newline  psInput.SetProperty(&quot;OrderId&quot;,sOrderId);_newline  psInput.SetProperty(&quot;searchexpr&quot;,searchspec);_newline  psInput.SetProperty(&quot;RequestIOName&quot;,&quot;VHA NBN Order Upsert IO&quot;);_newline  psInput.SetProperty(&quot;ProcessName&quot;, &quot;VHA Insert Upsert Workflow&quot;);_newline  svc.InvokeMethod(&quot;RunProcess&quot;, psInput, psOutput);_newline  var strErrorMessage = psOutput.GetProperty(&quot;Error Message&quot;);_newline  if(strErrorMessage != &quot;&quot;)_newline  {_newline  TheApplication().RaiseErrorText(strErrorMessage);_newline  } _newline_newline }_newline_newline}_newlinecatch(e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newline_newline}_newline_newline_newline_newline}"
 Program_spcLanguage="JS"
 Name="mUpsertNBNAttributes"
 Sequence="38"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="3-2118285"
 Parent_spcName="VHA Fibre Upgrade Processing Ext Service_usCBS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function mVerifyInterimOrdDetails(Inputs,Outputs)_newline{_newline//Sathish : Added for Fibre Upgrade Drop2 -17/02/24_newlinetry{  _newline   _newline  _newline  var sOrderId = Inputs.GetProperty(&quot;InterimOrderId&quot;);_newline  var sFibreOrdId = &quot;&quot;;_newline  var sPropositionId,sOrderSubFunction,sOrderSubTypeTBUI=&quot;&quot;;_newline  var sSelectedPropId=&quot;&quot;;_newline  var sSelectedPlan=&quot;&quot;;_newline  var sNBNFTTPInterim=&quot;&quot;;_newline  var sDeleteReCreateFibreOrd=&quot;N&quot;;_newline  var sFibreOrdExists=&quot;N&quot;;_newline  var sNBNOnly = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB Only&quot;);_newline  var sNBNwithMBB = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFBB_usPROPOSITION_usTYPE&quot;,&quot;FBB with MBB&quot;);_newline  var sFCOrdSubFunction = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usORDER_usSUB_usFUNCTION&quot;,&quot;Fibre Upgrade Connect&quot;);_newline  var sFCOrdSubType = TheApplication().InvokeMethod(&quot;LookupValue&quot;,&quot;VHA_usFC_usORDER_usSUB_usTYPE_usTBUI&quot;,&quot;Change Proposition&quot;);_newline    _newline  var boOrder = TheApplication().GetBusObject(&quot;VHA NBN Additional Details BO&quot;);_newline  var bcOrder = boOrder.GetBusComp(&quot;VF Order Entry - Orders Thin BC&quot;);_newline  var bcOrderItems = boOrder.GetBusComp(&quot;VF Order Line Items - Thin BC&quot;);  _newline  var boInterimOrd = TheApplication().GetBusObject(&quot;Order Entry&quot;);_newline  var bcInterimOrd = boInterimOrd.GetBusComp(&quot;Order Entry - Orders&quot;);_newline  var bcInterimOrdLine = boInterimOrd.GetBusComp(&quot;VF Order Entry - Line Items Thin&quot;);_newline  var bcInterimOrdXM = boInterimOrd.GetBusComp(&quot;VHA Fibre Interim Order Details&quot;);_newline _newline  var sSearchspec =&quot;&quot;;_newline  var sInterimOrdSearchspec = &quot;[Order Header Id] = &apos;&quot; + sOrderId + &quot;&apos; AND [Parent Order Item Id] IS NULL AND ([VHA Siebel Product Type] = &apos;&quot; + sNBNOnly + &quot;&apos; OR [VHA Siebel Product Type] = &apos;&quot; + sNBNwithMBB + &quot;&apos;)&quot;;_newline_newline  if(sOrderId != &quot;&quot; &amp;&amp; sOrderId != null )_newline  {_newline  bcInterimOrdXM.ActivateField(&quot;NBN FTTP Interim Flag&quot;);_newline        bcInterimOrdXM.ActivateField(&quot;Selected Fibre Plan&quot;);_newline        bcInterimOrdXM.ActivateField(&quot;Selected Fibre Prop Id&quot;);_newline  _newline  bcInterimOrdLine.ActivateField(&quot;VF Order Sub Function&quot;);_newline  bcInterimOrdLine.ActivateField(&quot;VF Order Sub Type TBUI&quot;);_newline  _newline  bcInterimOrd.SetViewMode(AllView);_newline  bcInterimOrd.ActivateField(&quot;VHA FC Link Ord Id 2&quot;);_newline  bcInterimOrd.ClearToQuery();_newline  bcInterimOrd.SetSearchSpec(&quot;Id&quot;,sOrderId);_newline  bcInterimOrdLine.SetSearchExpr(sInterimOrdSearchspec);_newline  bcInterimOrdXM.SetSearchSpec(&quot;Order Id&quot;,sOrderId);_newline  bcInterimOrd.ExecuteQuery(ForwardOnly);_newline_newline _newline   if(bcInterimOrd.FirstRecord() &amp;&amp; bcInterimOrdLine.FirstRecord())_newline   {_newline _newline    sFibreOrdId = bcInterimOrd.GetFieldValue(&quot;VHA FC Link Ord Id 2&quot;);_newline    sOrderSubFunction = bcInterimOrdLine.GetFieldValue(&quot;VF Order Sub Function&quot;);_newline    sOrderSubTypeTBUI = bcInterimOrdLine.GetFieldValue(&quot;VF Order Sub Type TBUI&quot;);_newline    _newline    if(sOrderSubFunction == sFCOrdSubFunction)_newline    {_newline    if (sFibreOrdId != null &amp;&amp; sFibreOrdId != &quot;&quot;)_newline    {_newline_newline     sFibreOrdExists=&quot;Y&quot;;     _newline     bcOrderItems.ActivateField(&quot;Root Product Id&quot;);_newline     _newline     sSearchspec = &quot;[Order Header Id] = &apos;&quot; + sFibreOrdId + &quot;&apos; AND [Parent Order Item Id] IS NULL AND ([VF Siebel Product Type] = &apos;&quot; + sNBNOnly + &quot;&apos; OR [VF Siebel Product Type] = &apos;&quot; + sNBNwithMBB + &quot;&apos;)&quot;;_newline     _newline     bcOrder.SetViewMode(AllView);_newline     bcOrder.ClearToQuery();_newline     bcOrder.SetSearchSpec(&quot;Id&quot;,sFibreOrdId);_newline     bcOrderItems.SetSearchExpr(sSearchspec);_newline     bcOrder.ExecuteQuery(ForwardOnly);_newline_newline      if(bcOrderItems.FirstRecord())_newline      {_newline       sPropositionId = bcOrderItems.GetFieldValue(&quot;Root Product Id&quot;);_newline_newline       _newline      }_newline     _newline    }_newline     _newline    if(bcInterimOrdXM.FirstRecord())_newline    {_newline     _newline     sNBNFTTPInterim = bcInterimOrdXM.GetFieldValue(&quot;NBN FTTP Interim Flag&quot;);_newline     sSelectedPlan = bcInterimOrdXM.GetFieldValue(&quot;Selected Fibre Plan&quot;);_newline     sSelectedPropId = bcInterimOrdXM.GetFieldValue(&quot;Selected Fibre Prop Id&quot;);_newline_newline     if (sSelectedPropId != null &amp;&amp; sPropositionId != null &amp;&amp; sSelectedPropId != sPropositionId)_newline     {_newline     sDeleteReCreateFibreOrd=&quot;Y&quot;;_newline     }     _newline     _newline     if (sDeleteReCreateFibreOrd==&quot;Y&quot; &amp;&amp; sFibreOrdId != null)_newline     {_newline _newline      var psInput2 = &quot;&quot;;_newline      var psOutput2 = &quot;&quot;;_newline      var svc1=&quot;&quot;;_newline      psInput2 = TheApplication().NewPropertySet();_newline      psOutput2 = TheApplication().NewPropertySet();_newline      svc1 = TheApplication().GetService(&quot;VHA Sharing Simplification BS&quot;);_newline      psInput2.SetProperty(&quot;OrderId&quot;,sFibreOrdId);_newline      svc1.InvokeMethod(&quot;DeleteLineItems&quot;, psInput2, psOutput2);      _newline      _newline      Outputs.SetProperty(&quot;CreateNewFibreOrder&quot;,&quot;Y&quot;);_newline_newline     }_newline     else if (sDeleteReCreateFibreOrd==&quot;N&quot; &amp;&amp; sFibreOrdId == null)_newline     {_newline_newline     Outputs.SetProperty(&quot;CreateNewFibreOrder&quot;,&quot;Y&quot;);_newline     }_newline     else_newline     {_newline     Outputs.SetProperty(&quot;CreateNewFibreOrder&quot;,&quot;N&quot;);_newline     }_newline    }_newline    }_newline   _newline   }     _newline  _newline  _newlineOutputs.SetProperty(&quot;NBNFTTPInterim&quot;,sNBNFTTPInterim);_newlineOutputs.SetProperty(&quot;FCSelectedRatePlan&quot;,sSelectedPlan);_newlineOutputs.SetProperty(&quot;FCSelectedPropId&quot;,sSelectedPropId);_newline  _newline}  _newline}_newlinecatch(e)_newline{_newlinethrow(e);_newline}_newlinefinally_newline{_newline_newlinebcOrder = null;_newlinebcOrderItems =null;_newlinebcInterimOrdLine = null;_newlinebcInterimOrd = null;_newlinebcInterimOrdXM = null;_newlineboInterimOrd = null;_newlineboOrder = null;_newline_newline}_newline_newline}"
 Program_spcLanguage="JS"
 Name="mVerifyInterimOrdDetails"
 Sequence="39"
></Business_spcService_spcScript
></Business_spcService
>